/*! For license information please see b0016de6a4fc50aaca2db95d88add32af2620be5-291f04bfd7a12119195a.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"+Aml":function(e,t,r){"use strict";e.exports=function(e){e||(e={}),"string"==typeof e&&(e={cookie:e}),void 0===e.cookie&&(e.cookie="");var t={getItem:function(t){for(var r=e.cookie.split(/;\s*/),n=0;n<r.length;n++){var i=r[n].split("=");if(decodeURIComponent(i[0])===t)return decodeURIComponent(i[1])}},setItem:function(t,r,n){if("string"!=typeof t||"string"!=typeof r)return!1;n||(n={});var i=encodeURIComponent(t)+"="+encodeURIComponent(r);return n.hasOwnProperty("expires")&&(i+="; expires="+n.expires),n.hasOwnProperty("path")&&(i+="; path="+n.path),n.hasOwnProperty("domain")&&(i+="; domain="+n.domain),n.secure&&(i+="; secure"),e.cookie=i,i},removeItem:function(t){e.cookie=t+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;"},clear:function(){for(var r=e.cookie.split(/;\s*/),n=0;n<r.length;n++)t.removeItem(decodeURIComponent(r[n].split("=")[0]))}};return t}},"/Y2a":function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r("gfhf"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.makeGetRequest=function(e,t){return a.makeGetRequest(e,t)},t.prototype.getConfigDefaults=function(){return{autoUpdate:!1}},t}(o(r("pkII")).default);t.default=s},"/jmd":function(e,t,r){"use strict";var n=r("B3dL").setCookie,i=r("2qub").inCloudFlareSupportedTenantCountry,o=r("1C4m").publish,a=r("KpVU").writeDecisions;e.exports.TREATMENTS_SDK_KEY="Y9qbLcxvUERV4Kq5PZhWe",e.exports.setTreatments=function(e){var t=function(e){if(e&&e.ctc&&e.ctc.Y9qbLcxvUERV4Kq5PZhWe)return Object.keys(e.ctc.Y9qbLcxvUERV4Kq5PZhWe)}(e);if(t){var r=function(e){return(e||[]).join(",")}(t);n("puc-ctc",r),i()||a(t,n),o("treatmentsResolved",t),function(e){var t=e.indexOf("site_tagging_new_customer")>-1,r=e.indexOf("site_tagging_repeat_customer")>-1;if(t===r)return void console.warn("new and repeat at the same time");var n=t?"New":"Repeat";window.localStorage.setItem("NewOrRepeat",n)}(t)}}},"1C4m":function(e,t,r){"use strict";var n=r("bBst");e.exports={publish:function(e,t){var r=new n(e,{detail:t});window.dispatchEvent(r)}}},"2CXu":function(e,t){var r={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Ấ":"A","Ắ":"A","Ẳ":"A","Ẵ":"A","Ặ":"A","Æ":"AE","Ầ":"A","Ằ":"A","Ȃ":"A","Ç":"C","Ḉ":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ế":"E","Ḗ":"E","Ề":"E","Ḕ":"E","Ḝ":"E","Ȇ":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ḯ":"I","Ȋ":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ố":"O","Ṍ":"O","Ṓ":"O","Ȏ":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ấ":"a","ắ":"a","ẳ":"a","ẵ":"a","ặ":"a","æ":"ae","ầ":"a","ằ":"a","ȃ":"a","ç":"c","ḉ":"c","è":"e","é":"e","ê":"e","ë":"e","ế":"e","ḗ":"e","ề":"e","ḕ":"e","ḝ":"e","ȇ":"e","ì":"i","í":"i","î":"i","ï":"i","ḯ":"i","ȋ":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ố":"o","ṍ":"o","ṓ":"o","ȏ":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Ĉ":"C","ĉ":"c","Ċ":"C","ċ":"c","Č":"C","č":"c","C̆":"C","c̆":"c","Ď":"D","ď":"d","Đ":"D","đ":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"G","Ǵ":"G","ĝ":"g","ǵ":"g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"H","ĥ":"h","Ħ":"H","ħ":"h","Ḫ":"H","ḫ":"h","Ĩ":"I","ĩ":"i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","ı":"i","Ĳ":"IJ","ĳ":"ij","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","Ḱ":"K","ḱ":"k","K̆":"K","k̆":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L","ŀ":"l","Ł":"l","ł":"l","Ḿ":"M","ḿ":"m","M̆":"M","m̆":"m","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"n","N̆":"N","n̆":"n","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","P̆":"P","p̆":"p","Ŕ":"R","ŕ":"r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","R̆":"R","r̆":"r","Ȓ":"R","ȓ":"r","Ś":"S","ś":"s","Ŝ":"S","ŝ":"s","Ş":"S","Ș":"S","ș":"s","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","ț":"t","Ț":"T","Ť":"T","ť":"t","Ŧ":"T","ŧ":"t","T̆":"T","t̆":"t","Ũ":"U","ũ":"u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ȗ":"U","ȗ":"u","V̆":"V","v̆":"v","Ŵ":"W","ŵ":"w","Ẃ":"W","ẃ":"w","X̆":"X","x̆":"x","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Y̆":"Y","y̆":"y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ſ":"s","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","Ǎ":"A","ǎ":"a","Ǐ":"I","ǐ":"i","Ǒ":"O","ǒ":"o","Ǔ":"U","ǔ":"u","Ǖ":"U","ǖ":"u","Ǘ":"U","ǘ":"u","Ǚ":"U","ǚ":"u","Ǜ":"U","ǜ":"u","Ứ":"U","ứ":"u","Ṹ":"U","ṹ":"u","Ǻ":"A","ǻ":"a","Ǽ":"AE","ǽ":"ae","Ǿ":"O","ǿ":"o","Þ":"TH","þ":"th","Ṕ":"P","ṕ":"p","Ṥ":"S","ṥ":"s","X́":"X","x́":"x","Ѓ":"Г","ѓ":"г","Ќ":"К","ќ":"к","A̋":"A","a̋":"a","E̋":"E","e̋":"e","I̋":"I","i̋":"i","Ǹ":"N","ǹ":"n","Ồ":"O","ồ":"o","Ṑ":"O","ṑ":"o","Ừ":"U","ừ":"u","Ẁ":"W","ẁ":"w","Ỳ":"Y","ỳ":"y","Ȁ":"A","ȁ":"a","Ȅ":"E","ȅ":"e","Ȉ":"I","ȉ":"i","Ȍ":"O","ȍ":"o","Ȑ":"R","ȑ":"r","Ȕ":"U","ȕ":"u","B̌":"B","b̌":"b","Č̣":"C","č̣":"c","Ê̌":"E","ê̌":"e","F̌":"F","f̌":"f","Ǧ":"G","ǧ":"g","Ȟ":"H","ȟ":"h","J̌":"J","ǰ":"j","Ǩ":"K","ǩ":"k","M̌":"M","m̌":"m","P̌":"P","p̌":"p","Q̌":"Q","q̌":"q","Ř̩":"R","ř̩":"r","Ṧ":"S","ṧ":"s","V̌":"V","v̌":"v","W̌":"W","w̌":"w","X̌":"X","x̌":"x","Y̌":"Y","y̌":"y","A̧":"A","a̧":"a","B̧":"B","b̧":"b","Ḑ":"D","ḑ":"d","Ȩ":"E","ȩ":"e","Ɛ̧":"E","ɛ̧":"e","Ḩ":"H","ḩ":"h","I̧":"I","i̧":"i","Ɨ̧":"I","ɨ̧":"i","M̧":"M","m̧":"m","O̧":"O","o̧":"o","Q̧":"Q","q̧":"q","U̧":"U","u̧":"u","X̧":"X","x̧":"x","Z̧":"Z","z̧":"z"},n=Object.keys(r).join("|"),i=new RegExp(n,"g"),o=new RegExp(n,""),a=function(e){return e.replace(i,(function(e){return r[e]}))};e.exports=a,e.exports.has=function(e){return!!e.match(o)},e.exports.remove=a},"2W80":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"2bR2":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("/Y2a");t.HttpPollingDatafileManager=n.default},"2dzi":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.areEventContextsEqual=void 0,t.areEventContextsEqual=function(e,t){var r=e.context,n=t.context;return r.accountId===n.accountId&&r.projectId===n.projectId&&r.clientName===n.clientName&&r.clientVersion===n.clientVersion&&r.revision===n.revision&&r.anonymizeIP===n.anonymizeIP&&r.botFiltering===n.botFiltering}},"2n8Z":function(e,t,r){let{getDomain:n,isReferrerFromVistaprint:i}=r("Cqnm");e.exports={initChannelTracking:function(){if(!1===i()){!function(e){const t=encodeURIComponent(JSON.stringify(e));let r=new Date;r.setTime(r.getTime()+2592e6);const i="; expires="+r.toUTCString(),o="; domain="+n();document.cookie="channel-tracking="+t+i+o+"; path=/"}(function(){const e=new URLSearchParams(window.location.search);return{utm_id:e.get("utm_id"),utm_source:e.get("utm_source"),partner:e.get("partner"),referrer:document.referrer,timestamp:Date.now()}}())}},getTrackingData:function(){let e=function(e){e+="=";const t=decodeURIComponent(document.cookie).split(";");for(let r=0;r<t.length;r++){let n=t[r];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""}("channel-tracking"),t=e?JSON.parse(e):{};return t.userAgent=window.navigator.userAgent,t.currentPage=window.location.href,t}}},"2qub":function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(){}r("E9XD");var a=f((function(e,t,r,n,i,o){var a=b("puc-ctc"),u=e.ctc.v1;return l((function(){return u&&0===u.length?s(t.log({message:"Missing context. - CTC",culture:r,tenant:n,updatedAt:i,visitId:o})):l((function(){if(a&&a!==u.join(","))return s(t.log({message:"Context mismatch. CTC",old:a,new:u.join(","),culture:r,tenant:n,updatedAt:i,visitId:o}))}))}))}));function s(e,t){if(!t)return e&&e.then?e.then(o):Promise.resolve()}var u=f((function(e,t,r,n,i,o){var a=b("puc-ab"),u=e.experiments.v1;return l((function(){if(u&&0===Object.keys(u).length)return s(t.log({message:"Missing context. - AB",culture:r,tenant:n,updatedAt:i,visitId:o}));var e=Object.keys(u).map((function(e){return"".concat(e,":").concat(u[e])})).join(",");return l((function(){if(a&&a!=e)return s(t.log({message:"Context mismatch. AB",old:a,new:e,culture:r,tenant:n,updatedAt:i,visitId:o}))}))}))}));function l(e){var t=e();if(t&&t.then)return t.then(o)}var c=f((function(e,t,r,i){var o=b(),a=[],u=Object.keys(o).filter(O).map((function(e){return o[e].length+e.length})).reduce((function(e,t){return e+t}),0);a.push({message:"Context cookie size",contextCookieSize:u,culture:t,tenant:r,visitId:i});var c=Object.keys(o).map((function(e){return o[e].length+e.length})).reduce((function(e,t){return e+t}),0);a.push({message:"All cookie size",allCookieSize:c,culture:t,tenant:r,visitId:i});var d=Object.keys(o).filter((function(e){return e.startsWith("uc_lat_")})),p=d.map((function(e){return o[e]}))||[];return d.forEach(I),a.push.apply(a,n(p.map((function(e){return{message:"Time consumed in CF.",timeMs:e,culture:t,tenant:r,visitId:i}})))),l((function(){if(a.length)return s(e.logBatch(a))}))}));function d(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var p=f((function(e){var t=!1;return g((function(){if(!_()){var r=m();return g((function(){if("da-DK"===r){var t=E(),n=b("visit");return s(c(e,r,t,n))}}),(function(){t=!0}))}}),(function(r){if(t)return r;var n=m(),i=E(),o=b("visit");return d(c(e,n,i,o),(function(){var t=!1,r=b("userContext");return g((function(){if(!r)return d(e.log({message:"Missing cookie.",culture:n,tenant:i,visitId:o}),(function(){t=!0}))}),(function(l){if(t)return l;var c=JSON.parse(decodeURIComponent(r)),p=b("userContextInfo"),f=JSON.parse(decodeURIComponent(p||"")).updatedAt;return d(a(c,e,n,i,f,o),(function(){return s(u(c,e,n,i,f,o))}))}))}))}))}));function f(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(n){return Promise.reject(n)}}}var h=f((function(e,t,r){return d(fetch(r,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},method:"post"}),(function(e){return l((function(){if(200!==e.status)return s(t.log({message:"Cloudflare invocation failed on: ".concat(e.status,".")}))}))}))}));function g(e,t){var r=e();return r&&r.then?r.then(t):t(r)}var v=f((function(e,t,r,n){var i=!1;return function(e,t){try{var r=e()}catch(n){return t(n)}return r&&r.then?r.then(void 0,t):r}((function(){return g((function(){if(!window||!window.location)return d(t.log({message:"Cloudflare invocation failed on missing location window.location"}),(function(){i=!0}))}),(function(o){return i?o:_()?s(h(e,t,"https://".concat(window.location.hostname,"/context-update?requestor_url=").concat(encodeURIComponent(window.location.href),"&force_update=").concat(r,"&merge_canonical_id=").concat(n))):void 0}))}),(function(e){return s(t.log({message:"Cloudflare invocation failed on: ".concat(e.message,".")}))}))})),m=r("wtQp").getCurrentCulture,E=r("ANje").getCurrentTenant,y=r("B3dL"),b=y.getCookie,I=y.deleteCookie;function _(){var e=m(),t=E();return!("pt-PT"!==e&&"en-IE"!==e||"vistaprint"!==t&&"masks"!==t)}function O(e){return e.startsWith("puc-")||e.startsWith("userContext")||e.startsWith("sci-")}t.invokeCloudflare=v,t.monitorCloudflarePerformance=p,t.inCloudFlareSupportedTenantCountry=_},"314J":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("bn5K");const i=()=>{if("undefined"!=typeof window)return Boolean(window.localStorage.getItem(n.f))},o=()=>{if("undefined"!=typeof window)return Boolean(window.localStorage.getItem(n.e))}},"4USb":function(e,t,r){"use strict";r.r(t),r.d(t,"v1",(function(){return l})),r.d(t,"v3",(function(){return b})),r.d(t,"v4",(function(){return I.a})),r.d(t,"v5",(function(){return w})),r.d(t,"NIL",(function(){return T})),r.d(t,"version",(function(){return N})),r.d(t,"validate",(function(){return c.a})),r.d(t,"stringify",(function(){return a.a})),r.d(t,"parse",(function(){return d}));var n,i,o=r("2Pgj"),a=r("WM9j"),s=0,u=0;var l=function(e,t,r){var l=t&&r||0,c=t||new Array(16),d=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==p){var f=e.random||(e.rng||o.a)();null==d&&(d=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=i=16383&(f[6]<<8|f[7]))}var h=void 0!==e.msecs?e.msecs:Date.now(),g=void 0!==e.nsecs?e.nsecs:u+1,v=h-s+(g-u)/1e4;if(v<0&&void 0===e.clockseq&&(p=p+1&16383),(v<0||h>s)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,u=g,i=p;var m=(1e4*(268435455&(h+=122192928e5))+g)%4294967296;c[l++]=m>>>24&255,c[l++]=m>>>16&255,c[l++]=m>>>8&255,c[l++]=255&m;var E=h/4294967296*1e4&268435455;c[l++]=E>>>8&255,c[l++]=255&E,c[l++]=E>>>24&15|16,c[l++]=E>>>16&255,c[l++]=p>>>8|128,c[l++]=255&p;for(var y=0;y<6;++y)c[l+y]=d[y];return t||Object(a.a)(c)},c=r("BuRe");var d=function(e){if(!Object(c.a)(e))throw TypeError("Invalid UUID");var t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};var p=function(e,t,r){function n(e,n,i,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=d(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+e.length);if(s.set(n),s.set(e,n.length),(s=r(s))[6]=15&s[6]|t,s[8]=63&s[8]|128,i){o=o||0;for(var u=0;u<16;++u)i[o+u]=s[u];return i}return Object(a.a)(s)}try{n.name=e}catch(i){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n};function f(e){return 14+(e+64>>>9<<4)+1}function h(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function g(e,t,r,n,i,o){return h((a=h(h(t,e),h(n,o)))<<(s=i)|a>>>32-s,r);var a,s}function v(e,t,r,n,i,o,a){return g(t&r|~t&n,e,t,i,o,a)}function m(e,t,r,n,i,o,a){return g(t&n|r&~n,e,t,i,o,a)}function E(e,t,r,n,i,o,a){return g(t^r^n,e,t,i,o,a)}function y(e,t,r,n,i,o,a){return g(r^(t|~n),e,t,i,o,a)}var b=p("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){for(var t=[],r=32*e.length,n=0;n<r;n+=8){var i=e[n>>5]>>>n%32&255,o=parseInt("0123456789abcdef".charAt(i>>>4&15)+"0123456789abcdef".charAt(15&i),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[f(t)-1]=t;for(var r=1732584193,n=-271733879,i=-1732584194,o=271733878,a=0;a<e.length;a+=16){var s=r,u=n,l=i,c=o;r=v(r,n,i,o,e[a],7,-680876936),o=v(o,r,n,i,e[a+1],12,-389564586),i=v(i,o,r,n,e[a+2],17,606105819),n=v(n,i,o,r,e[a+3],22,-1044525330),r=v(r,n,i,o,e[a+4],7,-176418897),o=v(o,r,n,i,e[a+5],12,1200080426),i=v(i,o,r,n,e[a+6],17,-1473231341),n=v(n,i,o,r,e[a+7],22,-45705983),r=v(r,n,i,o,e[a+8],7,1770035416),o=v(o,r,n,i,e[a+9],12,-1958414417),i=v(i,o,r,n,e[a+10],17,-42063),n=v(n,i,o,r,e[a+11],22,-1990404162),r=v(r,n,i,o,e[a+12],7,1804603682),o=v(o,r,n,i,e[a+13],12,-40341101),i=v(i,o,r,n,e[a+14],17,-1502002290),n=v(n,i,o,r,e[a+15],22,1236535329),r=m(r,n,i,o,e[a+1],5,-165796510),o=m(o,r,n,i,e[a+6],9,-1069501632),i=m(i,o,r,n,e[a+11],14,643717713),n=m(n,i,o,r,e[a],20,-373897302),r=m(r,n,i,o,e[a+5],5,-701558691),o=m(o,r,n,i,e[a+10],9,38016083),i=m(i,o,r,n,e[a+15],14,-660478335),n=m(n,i,o,r,e[a+4],20,-405537848),r=m(r,n,i,o,e[a+9],5,568446438),o=m(o,r,n,i,e[a+14],9,-1019803690),i=m(i,o,r,n,e[a+3],14,-187363961),n=m(n,i,o,r,e[a+8],20,1163531501),r=m(r,n,i,o,e[a+13],5,-1444681467),o=m(o,r,n,i,e[a+2],9,-51403784),i=m(i,o,r,n,e[a+7],14,1735328473),n=m(n,i,o,r,e[a+12],20,-1926607734),r=E(r,n,i,o,e[a+5],4,-378558),o=E(o,r,n,i,e[a+8],11,-2022574463),i=E(i,o,r,n,e[a+11],16,1839030562),n=E(n,i,o,r,e[a+14],23,-35309556),r=E(r,n,i,o,e[a+1],4,-1530992060),o=E(o,r,n,i,e[a+4],11,1272893353),i=E(i,o,r,n,e[a+7],16,-155497632),n=E(n,i,o,r,e[a+10],23,-1094730640),r=E(r,n,i,o,e[a+13],4,681279174),o=E(o,r,n,i,e[a],11,-358537222),i=E(i,o,r,n,e[a+3],16,-722521979),n=E(n,i,o,r,e[a+6],23,76029189),r=E(r,n,i,o,e[a+9],4,-640364487),o=E(o,r,n,i,e[a+12],11,-421815835),i=E(i,o,r,n,e[a+15],16,530742520),n=E(n,i,o,r,e[a+2],23,-995338651),r=y(r,n,i,o,e[a],6,-198630844),o=y(o,r,n,i,e[a+7],10,1126891415),i=y(i,o,r,n,e[a+14],15,-1416354905),n=y(n,i,o,r,e[a+5],21,-57434055),r=y(r,n,i,o,e[a+12],6,1700485571),o=y(o,r,n,i,e[a+3],10,-1894986606),i=y(i,o,r,n,e[a+10],15,-1051523),n=y(n,i,o,r,e[a+1],21,-2054922799),r=y(r,n,i,o,e[a+8],6,1873313359),o=y(o,r,n,i,e[a+15],10,-30611744),i=y(i,o,r,n,e[a+6],15,-1560198380),n=y(n,i,o,r,e[a+13],21,1309151649),r=y(r,n,i,o,e[a+4],6,-145523070),o=y(o,r,n,i,e[a+11],10,-1120210379),i=y(i,o,r,n,e[a+2],15,718787259),n=y(n,i,o,r,e[a+9],21,-343485551),r=h(r,s),n=h(n,u),i=h(i,l),o=h(o,c)}return[r,n,i,o]}(function(e){if(0===e.length)return[];for(var t=8*e.length,r=new Uint32Array(f(t)),n=0;n<t;n+=8)r[n>>5]|=(255&e[n/8])<<n%32;return r}(e),8*e.length))})),I=r("7Cbv");function _(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function O(e,t){return e<<t|e>>>32-t}var w=p("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var n=unescape(encodeURIComponent(e));e=[];for(var i=0;i<n.length;++i)e.push(n.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var o=e.length/4+2,a=Math.ceil(o/16),s=new Array(a),u=0;u<a;++u){for(var l=new Uint32Array(16),c=0;c<16;++c)l[c]=e[64*u+4*c]<<24|e[64*u+4*c+1]<<16|e[64*u+4*c+2]<<8|e[64*u+4*c+3];s[u]=l}s[a-1][14]=8*(e.length-1)/Math.pow(2,32),s[a-1][14]=Math.floor(s[a-1][14]),s[a-1][15]=8*(e.length-1)&4294967295;for(var d=0;d<a;++d){for(var p=new Uint32Array(80),f=0;f<16;++f)p[f]=s[d][f];for(var h=16;h<80;++h)p[h]=O(p[h-3]^p[h-8]^p[h-14]^p[h-16],1);for(var g=r[0],v=r[1],m=r[2],E=r[3],y=r[4],b=0;b<80;++b){var I=Math.floor(b/20),w=O(g,5)+_(I,v,m,E)+y+t[I]+p[b]>>>0;y=E,E=m,m=O(v,30)>>>0,v=g,g=w}r[0]=r[0]+g>>>0,r[1]=r[1]+v>>>0,r[2]=r[2]+m>>>0,r[3]=r[3]+E>>>0,r[4]=r[4]+y>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]})),T="00000000-0000-0000-0000-000000000000";var N=function(e){if(!Object(c.a)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},"7tGJ":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AssetErrorMessage=t.AssetStatusType=void 0,function(e){e.Unprepared="Unprepared",e.Preparing="Preparing",e.Prepared="Prepared",e.Deleting="Deleting",e.Deleted="Deleted",e.Error="Error"}(t.AssetStatusType||(t.AssetStatusType={})),function(e){e.PresignFailed="Couldn't presign asset",e.PrepareDeletingAsset="Can't prepare asset when it's being deleted",e.PrepareDeletedAsset="Can't prepare an asset that has been deleted",e.EmptySignature="Signature is empty or does not exist",e.InvalidSourceData="Invalid asset source data",e.MissingAssetId="Missing asset ID"}(t.AssetErrorMessage||(t.AssetErrorMessage={}))},"9IYi":function(e,t,r){const n=r("dqcc"),i=r("Wqm3"),o=r("Kug9"),a=r("HpuD");e.exports=class{constructor(e={}){this._customResolvers=e}async getAttributeValues(e){const t=await this._resolveDefaultAttributes(),r={},n=Object.prototype.toString;return Object.keys(t).filter(t=>!e||e.includes(t)).map(e=>({key:e,value:"[object Function]"===n.call(t[e])?t[e]():t[e]})).forEach(e=>{void 0!==e.value&&("[object Object]"===n.call(e.value)&&void 0!==e.value[e.key]?r[e.key]=e.value[e.key]:r[e.key]=e.value)}),r}async _resolveDefaultAttributes(){return Object.assign({utm_id:i.getAttribute(),culture:n.getAttribute(),browserId:a.getAttributes(),device:a.getAttributes(),tenant:o.getAttribute()},this._customResolvers)}}},"9X7T":function(e,t,r){"use strict";r.r(t),r.d(t,"getCurrentTenantOrDefault",(function(){return l})),r.d(t,"getCurrentTenant",(function(){return c})),r.d(t,"getCurrentDomain",(function(){return h})),r.d(t,"getRootCookieDomain",(function(){return g}));var n=function(){var e=window&&window.location&&window.location.hostname;if(!e||0===e.length)throw new Error("Hostname could not be determined for the current document.");return e},i=function(){var e=window&&window.document;if(!e)throw new Error("DOM document could not be determined.");return e},o=function(){return window&&window.location&&window.location.pathname},a=["vistaprint","vista","promotique"],s=["masken","mondkapjes","masks","masker","maskit","masque","mascherine","munnbind","mascaras","mascarillas","munskydd"],u=["touch-free-payments"],l=function(e){var t=o();if(t&&"/"!==t)for(var r=t.split("/"),i=0;i<r.length;i+=1){if(-1!==s.indexOf(r[i].toLowerCase()))return"masks";if(-1!==u.indexOf(r[i].toLowerCase()))return"paypal"}var l=n().split(".").slice(-3);if(l[0]&&"brandstore"===l[0].toLocaleLowerCase()&&"vistaprint"===l[1])return"promotique";if(l[0]&&"novelty"===l[0].toLocaleLowerCase()&&"vistaprint"===l[1])return"promotique";for(var c=l.length-1;c>=0;c-=1)if(-1!==a.indexOf(l[c]))return l[c];return e},c=function(){return l("vistaprint")},d=null,p=function(e,t,r,n){var o=r.toUTCString();i().cookie=e+"="+t+";expires="+o+";path=/;domain="+n},f=function(){var e,t,r,o=n().split("."),a=new Date;a.setTime(a.getTime()+5e3);for(var s=o.length-1;s>=0;s-=1){var u=o.slice(s).join(".");if(p("top_level_domain_resolution","1",a,u),i().cookie.indexOf("top_level_domain_resolution")>-1)return e="top_level_domain_resolution",t=u,r=void 0,r=new Date(1970),p(e,"",r,t),u}return null},h=function(){return d||(d=f())},g=function(){var e=f();if(e&&"localhost"!==e)return new RegExp(/^[0-9.]+$/).test(e)?e:"."+e}},AGgz:function(e){e.exports=JSON.parse('{"en-ca":{"nextButton":"Next","lastStepButton":"Save to account","prevButton":"Back","closeButtonCopy":"Close","dismissErrorCopy":"Dismiss error","errorCopy":"Something went wrong while saving to your account, please try again.","quizBanner":{"title":"Custom recommendations — in just a few clicks.","subTitle":"Tell us what you\'re working on to see designs, products and services to match.","ctaText":"Get started"},"quizCompleted":{"title":"Go back to your unique recommendations.","subTitle":"Explore relevant designs, products and services based on the information you\'ve shared.","ctaText":"Go back","ctaUrl":"/gs","barButton":"Recommendations for you"},"segmentationStep":{"title":"First up, tell us what you\'re working on.","subTitle":"Business, personal, or both? We\'ll recommend designs, products and services just for you.","cards":[{"key":"Business","heading":"Business projects","description":"From in-person promotions to building an audience online.","image":"https://cms.cloudinary.vpsvc.com/image/upload/c_fill,w_400,h_400/v1649693755/legacy_dam/en-us/S001438805.jpg"},{"key":"Consumer","heading":"Personal projects","description":"From celebrating landmark life events to making unique gifts.","image":" https://cms.cloudinary.vpsvc.com/image/upload/c_fill,w_400,h_400/v1642068814/legacy_dam/en-ca/S001396685.jpg"}]},"businessAttributes":{"title":"Now, let\'s bring your brand to life.","subTitle":"Preview your name and logo on products related to your industry.","copies":{"industry":"Industry","industryDefaultSelection":"Select","businessName":"Business name","logo":"Logo (optional)","logoUpload":"Upload logo or image","selectPlaceholder":"Select"},"scenes":[{"name":"Business Cards","sceneUrl":"https://assets.documents.cimpress.io/v3/assets/271d80b5-e276-448e-9ca1-ce05692ed221/content","placeholderImage":"https://cms.cloudinary.vpsvc.com/image/upload/c_scale,w_1000/v1652367788/onboarding_flow/placeholder_business_cards.webp"},{"name":"Stickers","sceneUrl":"https://assets.documents.cimpress.io/v3/assets/3845690f-b582-4a71-b385-bb0e5c7877f5/content","placeholderImage":"https://cms.cloudinary.vpsvc.com/image/upload/c_scale,w_1000/v1656915231/onboarding_flow/placeholder_sticker.webp"},{"name":"Instagram","sceneUrl":"https://assets.documents.cimpress.io/v3/assets/c2655eb1-c946-441c-bb59-d0c862419883/content","placeholderImage":"https://cms.cloudinary.vpsvc.com/image/upload/c_scale,w_1000/v1657696514/onboarding_flow/placeholder_instagram.webp"},{"name":"Website","sceneUrl":"https://assets.documents.cimpress.io/v3/assets/c8684e70-618f-4dc8-a30e-fb78c66ef1d7/content","placeholderImage":"https://cms.cloudinary.vpsvc.com/image/upload/c_scale,w_1000/v1652367790/onboarding_flow/placeholder_website.webp"},{"name":"T-shirts","sceneUrl":"https://assets.documents.cimpress.io/v3/assets/17b7ffab-40ae-4bd6-b478-da3440310d4b/content","placeholderImage":"https://cms.cloudinary.vpsvc.com/image/upload/c_scale,w_1000/v1656915231/onboarding_flow/placeholder_tshirt.webp"}]},"interestsStep":{"title":"Next, see more of what interests you.","subTitle":"Select all that apply. This helps us show you the content you\'re looking for, faster.","nextButton":"Save to account","cards":[{"key":"print_products","heading":"Print products","description":"Business cards, flyers, signage and more.","image":"https://cms.cloudinary.vpsvc.com/image/upload/c_fill,w_400,h_400/v1649693760/legacy_dam/en-us/S001438765.jpg"},{"key":"digital_marketing","heading":"Digital marketing","description":"Websites, social media, content and more.","image":"https://cms.cloudinary.vpsvc.com/image/upload/c_fill,w_400,h_400/c_crop,w_400/v1649693749/legacy_dam/en-us/S001438764.jpg"},{"key":"design_services","heading":"Design services","description":"Professional assistance for any project.","image":"https://cms.cloudinary.vpsvc.com/image/upload/c_fill,w_400,h_400/v1649693753/legacy_dam/en-us/S001438768.jpg"},{"key":"ideas_advice","heading":"Ideas and advice","description":"Videos, articles and inspiration.","image":"https://cms.cloudinary.vpsvc.com/image/upload/c_fill,w_400,h_400/v1647008228/legacy_dam/de-de/S001425293.jpg"}]},"loadingStep":{"title":"Saving to your account..."}}}')},ANje:function(e,t,r){"use strict";r.r(t),r.d(t,"getCurrentTenant",(function(){return c})),r.d(t,"getCurrentDomain",(function(){return h})),r.d(t,"getRootCookieDomain",(function(){return g}));var n=function(){var e=window&&window.location&&window.location.hostname;if(!e||0===e.length)throw new Error("Hostname could not be determined for the current document.");return e},i=function(){var e=window&&window.document;if(!e)throw new Error("DOM document could not be determined.");return e},o=function(){return window&&window.location&&window.location.pathname},a={vistaprint:"vistaprint",vpsvc:"vistaprint",localhost:"vistaprint",vista:"vista",promotique:"promotique"},s=["brandstore.vistaprint.in","novelty.vistaprint.jp"],u=["masken","mondkapjes","masks","masker","maskit","masque","mascherine","munnbind","mascaras","mascarillas","munskydd"],l=["touch-free-payments"],c=function(){return function(e,t){if(t&&"/"!==t)for(var r=t.split("/"),n=0;n<r.length;n+=1){if(-1!==u.indexOf(r[n].toLowerCase()))return"masks";if(-1!==l.indexOf(r[n].toLowerCase()))return"paypal"}for(var i=e.split(".").slice(-3),o=0,c=s;o<c.length;o++){var d=c[o];if(e.endsWith(d))return"promotique"}for(var p=i.length-1;p>=0;p-=1)if(null!=a[i[p]])return a[i[p]];throw new Error("Could not resolve tenant for host "+e+" and path "+t)}(n(),o())},d=null,p=function(e,t,r,n){var o=r.toUTCString();i().cookie=e+"="+t+";expires="+o+";path=/;domain="+n},f=function(){var e,t,r,o=n().split("."),a=new Date;a.setTime(a.getTime()+5e3);for(var s=o.length-1;s>=0;s-=1){var u=o.slice(s).join(".");if(p("top_level_domain_resolution","1",a,u),i().cookie.indexOf("top_level_domain_resolution")>-1)return e="top_level_domain_resolution",t=u,r=void 0,r=new Date(1970),p(e,"",r,t),u}return null},h=function(){return d||(d=f())},g=function(){var e=f();if(e&&"localhost"!==e)return new RegExp(/^[0-9.]+$/).test(e)?e:"."+e}},B3dL:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r("ANje"),s=r("p46w").withConverter({read:function(e,t){return"sci-scx"===t.toLocaleLowerCase()||"sci-de"===t.toLocaleLowerCase()||"sci-ft"===t.toLocaleLowerCase()?e:decodeURIComponent(e)},write:function(e,t){return"sci-scx"===t.toLocaleLowerCase()||"sci-de"===t.toLocaleLowerCase()||"sci-ft"===t.toLocaleLowerCase()?e:encodeURIComponent(e)}});e.exports={setCookie:function(e,t){var r=a.getRootCookieDomain();s.set(e,t,{domain:r})},getCookie:function(e){return s.get(e)},deleteCookie:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s.remove(e,i({path:"/"},t))}}},ByUR:function(e,t){e.exports={featuresCookieName:"sci-ft",writeFeatures:(e,t)=>{t("sci-ft",(e=>e&&Array.isArray(e)?e.join(",").toLowerCase():"")(e))}}},C1BX:function(e,t,r){var n;!function(i,o){"use strict";var a="model",s="name",u="type",l="vendor",c="version",d="mobile",p="tablet",f="smarttv",h=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},g=function(e,t){return"string"==typeof e&&-1!==v(t).indexOf(v(e))},v=function(e){return e.toLowerCase()},m=function(e,t){if("string"==typeof e)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),void 0===t?e:e.substring(0,255)},E=function(e,t){for(var r,n,i,o,a,s,u=0;u<t.length&&!a;){var l=t[u],c=t[u+1];for(r=n=0;r<l.length&&!a;)if(a=l[r++].exec(e))for(i=0;i<c.length;i++)s=a[++n],"object"==typeof(o=c[i])&&o.length>0?2===o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,s):this[o[0]]=o[1]:3===o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=s?s.replace(o[1],o[2]):void 0:this[o[0]]=s?o[1].call(this,s,o[2]):void 0:4===o.length&&(this[o[0]]=s?o[3].call(this,s.replace(o[1],o[2])):void 0):this[o]=s||void 0;u+=2}},y=function(e,t){for(var r in t)if("object"==typeof t[r]&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(g(t[r][n],e))return"?"===r?void 0:r}else if(g(t[r],e))return"?"===r?void 0:r;return e},b={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},I={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[c,[s,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[c,[s,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[s,c],[/opios[\/ ]+([\w\.]+)/i],[c,[s,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[c,[s,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[s,c],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[c,[s,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[c,[s,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[c,[s,"WeChat"]],[/konqueror\/([\w\.]+)/i],[c,[s,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[c,[s,"IE"]],[/yabrowser\/([\w\.]+)/i],[c,[s,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[s,/(.+)/,"$1 Secure Browser"],c],[/\bfocus\/([\w\.]+)/i],[c,[s,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[c,[s,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[c,[s,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[c,[s,"Dolphin"]],[/coast\/([\w\.]+)/i],[c,[s,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[c,[s,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[c,[s,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[s,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[s,/(.+)/,"$1 Browser"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[s,/_/g," "],c],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[s,c],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[s],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[s,"Facebook"],c],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[s,c],[/\bgsa\/([\w\.]+) .*safari\//i],[c,[s,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[c,[s,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[s,"Chrome WebView"],c],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[c,[s,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[s,c],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[c,[s,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[c,s],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[s,[c,y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[s,c],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[s,"Netscape"],c],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[c,[s,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[s,c]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",v]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",v]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",v]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[a,[l,"Samsung"],[u,p]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[a,[l,"Samsung"],[u,d]],[/\((ip(?:hone|od)[\w ]*);/i],[a,[l,"Apple"],[u,d]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[a,[l,"Apple"],[u,p]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[a,[l,"Huawei"],[u,p]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[a,[l,"Huawei"],[u,d]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[a,/_/g," "],[l,"Xiaomi"],[u,d]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[a,/_/g," "],[l,"Xiaomi"],[u,p]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[a,[l,"OPPO"],[u,d]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[a,[l,"Vivo"],[u,d]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[a,[l,"Realme"],[u,d]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[a,[l,"Motorola"],[u,d]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[a,[l,"Motorola"],[u,p]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[a,[l,"LG"],[u,p]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[a,[l,"LG"],[u,d]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[a,[l,"Lenovo"],[u,p]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[a,/_/g," "],[l,"Nokia"],[u,d]],[/(pixel c)\b/i],[a,[l,"Google"],[u,p]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[a,[l,"Google"],[u,d]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[a,[l,"Sony"],[u,d]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[a,"Xperia Tablet"],[l,"Sony"],[u,p]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[a,[l,"OnePlus"],[u,d]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[a,[l,"Amazon"],[u,p]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[a,/(.+)/g,"Fire Phone $1"],[l,"Amazon"],[u,d]],[/(playbook);[-\w\),; ]+(rim)/i],[a,l,[u,p]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[a,[l,"BlackBerry"],[u,d]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[a,[l,"ASUS"],[u,p]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[a,[l,"ASUS"],[u,d]],[/(nexus 9)/i],[a,[l,"HTC"],[u,p]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[l,[a,/_/g," "],[u,d]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[a,[l,"Acer"],[u,p]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[a,[l,"Meizu"],[u,d]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[a,[l,"Sharp"],[u,d]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[l,a,[u,d]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[l,a,[u,p]],[/(surface duo)/i],[a,[l,"Microsoft"],[u,p]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[a,[l,"Fairphone"],[u,d]],[/(u304aa)/i],[a,[l,"AT&T"],[u,d]],[/\bsie-(\w*)/i],[a,[l,"Siemens"],[u,d]],[/\b(rct\w+) b/i],[a,[l,"RCA"],[u,p]],[/\b(venue[\d ]{2,7}) b/i],[a,[l,"Dell"],[u,p]],[/\b(q(?:mv|ta)\w+) b/i],[a,[l,"Verizon"],[u,p]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[a,[l,"Barnes & Noble"],[u,p]],[/\b(tm\d{3}\w+) b/i],[a,[l,"NuVision"],[u,p]],[/\b(k88) b/i],[a,[l,"ZTE"],[u,p]],[/\b(nx\d{3}j) b/i],[a,[l,"ZTE"],[u,d]],[/\b(gen\d{3}) b.+49h/i],[a,[l,"Swiss"],[u,d]],[/\b(zur\d{3}) b/i],[a,[l,"Swiss"],[u,p]],[/\b((zeki)?tb.*\b) b/i],[a,[l,"Zeki"],[u,p]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[l,"Dragon Touch"],a,[u,p]],[/\b(ns-?\w{0,9}) b/i],[a,[l,"Insignia"],[u,p]],[/\b((nxa|next)-?\w{0,9}) b/i],[a,[l,"NextBook"],[u,p]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[l,"Voice"],a,[u,d]],[/\b(lvtel\-)?(v1[12]) b/i],[[l,"LvTel"],a,[u,d]],[/\b(ph-1) /i],[a,[l,"Essential"],[u,d]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[a,[l,"Envizen"],[u,p]],[/\b(trio[-\w\. ]+) b/i],[a,[l,"MachSpeed"],[u,p]],[/\btu_(1491) b/i],[a,[l,"Rotor"],[u,p]],[/(shield[\w ]+) b/i],[a,[l,"Nvidia"],[u,p]],[/(sprint) (\w+)/i],[l,a,[u,d]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[l,"Microsoft"],[u,d]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[a,[l,"Zebra"],[u,p]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[a,[l,"Zebra"],[u,d]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[l,a,[u,"console"]],[/droid.+; (shield) bui/i],[a,[l,"Nvidia"],[u,"console"]],[/(playstation [345portablevi]+)/i],[a,[l,"Sony"],[u,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[a,[l,"Microsoft"],[u,"console"]],[/smart-tv.+(samsung)/i],[l,[u,f]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[l,"Samsung"],[u,f]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[l,"LG"],[u,f]],[/(apple) ?tv/i],[l,[a,"Apple TV"],[u,f]],[/crkey/i],[[a,"Chromecast"],[l,"Google"],[u,f]],[/droid.+aft(\w)( bui|\))/i],[a,[l,"Amazon"],[u,f]],[/\(dtv[\);].+(aquos)/i],[a,[l,"Sharp"],[u,f]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[l,m],[a,m],[u,f]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[u,f]],[/((pebble))app/i],[l,a,[u,"wearable"]],[/droid.+; (glass) \d/i],[a,[l,"Google"],[u,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[a,[l,"Zebra"],[u,"wearable"]],[/(quest( 2)?)/i],[a,[l,"Facebook"],[u,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[l,[u,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[a,[u,d]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[a,[u,p]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[u,p]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[u,d]],[/(android[-\w\. ]{0,9});.+buil/i],[a,[l,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[c,[s,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[c,[s,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[s,c],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[c,s]],os:[[/microsoft (windows) (vista|xp)/i],[s,c],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[s,[c,y,b]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[s,"Windows"],[c,y,b]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[c,/_/g,"."],[s,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[s,"Mac OS"],[c,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[c,s],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[s,c],[/\(bb(10);/i],[c,[s,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[c,[s,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[c,[s,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[c,[s,"webOS"]],[/crkey\/([\d\.]+)/i],[c,[s,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[s,"Chromium OS"],c],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[s,c],[/(sunos) ?([\w\.\d]*)/i],[[s,"Solaris"],c],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[s,c]]},_=function e(t,r){if("object"==typeof t&&(r=t,t=void 0),!(this instanceof e))return new e(t,r).getResult();var n=t||(void 0!==i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),o=r?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(I,r):I;return this.getBrowser=function(){var e,t={};return t[s]=void 0,t[c]=void 0,E.call(t,n,o.browser),t.major="string"==typeof(e=t.version)?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0,t},this.getCPU=function(){var e={architecture:void 0};return E.call(e,n,o.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return E.call(e,n,o.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return E.call(e,n,o.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return E.call(e,n,o.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n="string"==typeof e&&e.length>255?m(e,255):e,this},this.setUA(n),this};_.VERSION="1.0.2",_.BROWSER=h([s,c,"major"]),_.CPU=h(["architecture"]),_.DEVICE=h([a,l,u,"console",d,f,p,"wearable","embedded"]),_.ENGINE=_.OS=h([s,c]),void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=_),t.UAParser=_):r("PDX0")?void 0===(n=function(){return _}.call(t,r,t,e))||(e.exports=n):void 0!==i&&(i.UAParser=_);var O=void 0!==i&&(i.jQuery||i.Zepto);if(O&&!O.ua){var w=new _;O.ua=w.getResult(),O.ua.get=function(){return w.getUA()},O.ua.set=function(e){w.setUA(e);var t=w.getResult();for(var r in t)O.ua[r]=t[r]}}}("object"==typeof window?window:this)},Cqnm:function(e,t){const r=["uk","au","nz"];e.exports.getDomain=function(){if("localhost"===window.location.hostname)return"";const e=window.location.hostname.split("."),t=r.indexOf(e.slice(e.length-1).toString())>=0?3:2;return"."+e.slice(e.length-t).join(".")},e.exports.isReferrerFromVistaprint=function(){if(!document.referrer||-1!==document.referrer.indexOf("localhost"))return!1;if(-1!==document.referrer.indexOf("cimpress.auth0.com"))return!0;let e,t=new URL(document.referrer).hostname.split(".");return e=-1===r.indexOf(t[t.length-1])?2:3,"vistaprint"===t[t.length-e].toLowerCase()}},Da7C:function(e,t){const r=e=>e.map(e=>e.variationKey?"".concat(e.experimentKey.toLowerCase(),":").concat(e.variationKey.toLowerCase()):"").join(",");e.exports={experimentsCookieName:"sci-scx",convertExperiments:r,writeExperiments:(e,t)=>{t("sci-scx",r(e))}}},DgEJ:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("f650");var i=function(){function e(){this.errorCount=0}return e.prototype.getDelay=function(){return 0===this.errorCount?0:1e3*n.BACKOFF_BASE_WAIT_SECONDS_BY_ERROR_COUNT[Math.min(n.BACKOFF_BASE_WAIT_SECONDS_BY_ERROR_COUNT.length-1,this.errorCount)]+Math.round(1e3*Math.random())},e.prototype.countError=function(){this.errorCount<n.BACKOFF_BASE_WAIT_SECONDS_BY_ERROR_COUNT.length-1&&this.errorCount++},e.prototype.reset=function(){this.errorCount=0},e}();t.default=i},DkeP:function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,i=r;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}},EG25:function(e,t,r){var n=r("Z1Qi"),i=r("DkeP");e.exports=function(e,t,r){var o=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[o+s]=a[s];return t||i(a)}},EM67:function(e,t,r){},F0u8:function(e,t,r){var n=r("GZg5"),i=r("EG25"),o=i;o.v1=n,o.v4=i,e.exports=o},FPpc:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return l}));var n=r("X7RD"),i=r("bVzu"),o=r.n(i);function a(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(l){return void r(l)}s.done?t(u):Promise.resolve(u).then(n,i)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,u,"next",e)}function u(e){a(o,n,i,s,u,"throw",e)}s(void 0)}))}}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}class l{constructor(e,t,r){if(!e||!t||!r)throw new Error("Parameters version, libraryName and appName are required, given: "+e+"/"+t+"/"+r);this.libraryName=t,this.sumoLogger=new o.a("https://endpoint1.collection.us2.sumologic.com/receiver/v1/http/ZaVnC4dhaV1xIgc-SeJ99Es8Q-JdwHIjyPRHWa-sgqe4MtDs3MwJ_t3atmErfcFKguBc50QH7W8jcJy-AJrDSEo0LmYATdc4e1S0sPWf6y5E1TuRi028Dw==",1e4,e),this.appName=r}static getLogger(e,t,r){return new l(e,t,r)}error(e,t){var r=t?{error:JSON.stringify(t,Object.getOwnPropertyNames(t))}:{};this.localLog(e,r),this.sumoLogger.error(e,this.prepareContextData(r))}info(e){this.localLog(e),this.sumoLogger.info(e,this.prepareContextData())}warn(e){this.localLog(e),this.sumoLogger.warn(e,this.prepareContextData())}flushLogs(){return this.sumoLogger.flushLogs()}localLog(e,t){0}prepareContextData(e){return{contextData:u({},e,{libraryName:this.libraryName,appName:this.appName})}}}var c=e=>(t,r)=>{if(!(e=>"DatafileManager: Error fetching datafile: Request error"===e)(r)){var i=n.enums.LOG_LEVEL;switch(t){case i.INFO:case i.DEBUG:e.info(r);break;case i.WARNING:e.warn(r);break;case i.ERROR:e.error(r)}}},d={},p=function(){var e=s((function*(e){var t=yield e.onReady({timeout:600});if(!t.success)throw new Error("Initialization error: "+t.reason)}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=s((function*(e,t,r){try{return d[t]?(yield p(d[t]),{optimizelyClient:d[t],error:null}):(d[t]=Object(n.createInstance)({sdkKey:t||"9FP7UbgVrDnMwRHbjK2A3",datafile:r,datafileOptions:{autoUpdate:!0,urlTemplate:"https://exp-config.personalization.vpsvc.com/datafiles/%s.json",updateInterval:9e4},eventBatchSize:10,eventFlushInterval:3e3,logger:{log:c(e)},logLevel:"error"}),yield p(d[t]),{optimizelyClient:d[t],error:null})}catch(i){return{optimizelyClient:d[t],error:i}}}));return function(t,r,n){return e.apply(this,arguments)}}();class h{constructor(e,t,r){var{optimizelyClient:n,error:i}=e;this.logger=t,this.error=i,this.optimizelyClient=n,this.sdkKey=r}static getFeaturesClient(e,t,r){return s((function*(){t=t||"9FP7UbgVrDnMwRHbjK2A3";var n=yield f(e,t,r);return new h(n,e,t)}))()}isFeatureEnabled(e,t){if(!this.isInitialized())return this.logger.error("Inconsistent state after initialization",this.error),!1;var r=this.getContextOrDefault(t),n=this.optimizelyClient.isFeatureEnabled(e,r.userId,r.attributes);return r.overrides&&r.overrides[this.sdkKey]&&e in r.overrides[this.sdkKey]&&(n=r.overrides[this.sdkKey][e]),!!n}getEnabledFeatures(e){if(!this.isInitialized())return this.logger.error("Inconsistent state after initialization",this.error),[];var t=this.getContextOrDefault(e),r=this.optimizelyClient.getEnabledFeatures(t.userId,t.attributes);if(t.overrides&&t.overrides[this.sdkKey])for(var[n,i]of Object.entries(t.overrides[this.sdkKey])){var o=r.indexOf(n);!i&&o>=0?r.splice(o,1):i&&o<0&&r.push(n)}return r}isInitialized(){return!!this.optimizelyClient&&this.optimizelyClient.isValidInstance()}getContextOrDefault(e){return e&&e.userId?e:(this.logger.error("Decision method called without proper context"),u({},e,{userId:"USER_ID_IS_MISSING"}))}}}).call(this,r("KCCg"))},GJY6:function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(u){s=!0,i=u}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o(e,t,r){return r?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var a,s=(a=function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return v(h((function(){return t||(t=w()),u(d,(function(a){return o(Promise.all([g(e,a,[O],[b],l(),r,i),f(e,t,r,i)]),(function(e){var t=n(e,1)[0];y(t),_(t),m(t)}))}))}),(function(e){return p(t.log({message:"update context failed on: ".concat(e,".")}))})))},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(a.apply(this,e))}catch(r){return Promise.reject(r)}});function u(e,t,r){if(r)return t?t(e()):e();try{var n=Promise.resolve(e());return t?n.then(t):n}catch(i){return Promise.reject(i)}}var l=r("jh0Y").ensureUserTestId;function c(){}var d=r("wXqe").resolveTraits;function p(e,t){if(!t)return e&&e.then?e.then(c):Promise.resolve()}var f=r("2qub").invokeCloudflare;function h(e,t){try{var r=e()}catch(n){return t(n)}return r&&r.then?r.then(void 0,t):r}var g=r("pPUP").getPucContext;function v(e){if(e&&e.then)return e.then(c)}var m=r("rb8V").setUserProfile;var E=r("uZ6B"),y=E.setExperiments,b=E.EXPERIMENTS_SDK_KEY,I=r("/jmd"),_=I.setTreatments,O=I.TREATMENTS_SDK_KEY,w=r("LdgE").initLogging;e.exports.updateUserContext=s},GZg5:function(e,t,r){var n,i,o=r("Z1Qi"),a=r("DkeP"),s=0,u=0;e.exports=function(e,t,r){var l=t&&r||0,c=t||[],d=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==p){var f=o();null==d&&(d=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=i=16383&(f[6]<<8|f[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:u+1,v=h-s+(g-u)/1e4;if(v<0&&void 0===e.clockseq&&(p=p+1&16383),(v<0||h>s)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,u=g,i=p;var m=(1e4*(268435455&(h+=122192928e5))+g)%4294967296;c[l++]=m>>>24&255,c[l++]=m>>>16&255,c[l++]=m>>>8&255,c[l++]=255&m;var E=h/4294967296*1e4&268435455;c[l++]=E>>>8&255,c[l++]=255&E,c[l++]=E>>>24&15|16,c[l++]=E>>>16&255,c[l++]=p>>>8|128,c[l++]=255&p;for(var y=0;y<6;++y)c[l+y]=d[y];return t||a(c)}},HpuD:function(e,t,r){const n=r("C1BX");e.exports={getAttributes:function(){const e=window&&window.navigator?window.navigator.userAgent:"",t=new n.UAParser(e).getResult();if(!t)return{};const r=function(e,t){if(t){if("iOS"!==e)return t;switch(t){case"tablet":return"ipad";case"mobile":return"iphone";default:return t}}else switch(e){case"Windows":case"Mac Os":case"Mac OS":case"Ubuntu":return"desktop";default:return"unknown"}}(t.os.name,t.device.type);return{browserId:function(e){switch(e){case"Chrome":return"gc";case"Firefox":return"ff";case"Mobile Safari":case"Safari":return"safari";case"Edge":return"edge";case"IE":return"ie";default:return"unknown"}}(t.browser.name),device:r}}}},JJkS:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return l}));var n=r("Nz9T");let i;!function(e){e.SetError="setError",e.SetLoading="setLoading"}(i||(i={}));const o={error:!1,loading:!1},a=n.createContext(void 0);function s(e,t){switch(t.type){case i.SetError:return Object.assign({},e,{error:!0,loading:!1});case i.SetLoading:return Object.assign({},e,{loading:t.payload,error:!1});default:return console.warn("Unknown action: ",t),e}}const u=({children:e})=>{const[t,r]=n.useReducer(s,o),i={onboardingUploadState:t,onboardingUploadDispatch:r};return n.createElement(a.Provider,{value:i},e)};function l(){const e=n.useContext(a);if(void 0===e)throw new Error("useOnboardingUpload must be used within a OnboardingUploadProvider");return e}},Knbq:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.handleError=function(e){},e}();t.NoopErrorHandler=n;var i=new n;t.setErrorHandler=function(e){i=e},t.getErrorHandler=function(){return i},t.resetErrorHandler=function(){i=new n}},KpVU:function(e,t,r){const{decisionsCookieName:n,writeDecisions:i,convertDecisions:o}=r("kAe7"),{experimentsCookieName:a,writeExperiments:s,convertExperiments:u}=r("Da7C"),{featuresCookieName:l,writeFeatures:c}=r("ByUR");e.exports={decisionsCookieName:n,writeDecisions:i,convertDecisions:o,experimentsCookieName:a,writeExperiments:s,convertExperiments:u,featuresCookieName:l,writeFeatures:c}},Kug9:function(e,t,r){const{getCurrentTenant:n}=r("ANje");e.exports={getAttribute:function(){return n()}}},KwH3:function(e,t,r){},Ld4u:function(e,t,r){},LdbH:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.reqsInFlightCount=0,this.reqsCompleteResolvers=[]}return e.prototype.trackRequest=function(e){var t=this;this.reqsInFlightCount++;var r=function(){t.reqsInFlightCount--,0===t.reqsInFlightCount&&(t.reqsCompleteResolvers.forEach((function(e){return e()})),t.reqsCompleteResolvers=[])};e.then(r,r)},e.prototype.onRequestsComplete=function(){var e=this;return new Promise((function(t){0===e.reqsInFlightCount?t():e.reqsCompleteResolvers.push(t)}))},e}();t.default=n},LdgE:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r("VFdl").version;function s(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return Promise.resolve(e.apply(this,t))}catch(n){return Promise.reject(n)}}}function u(){}function l(e,t){if(!t)return e&&e.then?e.then(u):Promise.resolve()}function c(e,t){try{var r=e()}catch(n){return t(n)}return r&&r.then?r.then(void 0,t):r}function d(e){if(e&&e.then)return e.then(u)}e.exports.initLogging=function(){var e=s((function(e){return fetch("prod"==={}.ENVIRONMENT?"https://endpoint1.collection.us2.sumologic.com/receiver/v1/http/ZaVnC4dhaV3EQ4nQYHTRNXvwIh7wG1qtDo1Cs-Od8UN-1Hh1VZY2ff5bs15kdkmq2i2SLnGbMI9iqBkIucyOxQP39Myz0rWW0WYb7LGdZaihjvO6IV9rCQ==":"https://endpoint1.collection.us2.sumologic.com/receiver/v1/http/ZaVnC4dhaV0EAAT71XYn3rzyw9ASsi67NM15eWHxPd99ISo6ivXeXkf1iK7aZ4gCRbXRn5Nx6T5fQU53Ox0GepD1dz2iO3_CMqcznHFDVB1JR_xOfvfPIA==",{method:"POST",body:e,headers:{"Content-Type":"text/plain"}})}));return{log:s((function(t){return d(c((function(){return l(e("string"==typeof t?t:JSON.stringify(i(i({},t),{},{host:window.location.hostname,agentInfo:window.navigator.userAgentData,agent:window.navigator.userAgent,component:"UCI",version:a}))))}),(function(e){console.error("UCI failed",e?e.message:"")})))})),logBatch:s((function(t){var r=t.map((function(e){return JSON.stringify(i(i({},e),{},{host:window.location.hostname,agentInfo:window.navigator.userAgentData,agent:window.navigator.userAgent,component:"UCI",version:a}))}));return d(c((function(){return l(e(r.join("\n")))}),(function(e){console.error("UCI batch-log failed",e?e.message:"")})))}))}}},NR54:function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r("Knbq")),n(r("mcjk")),n(r("bXNa"))},PDX0:function(e,t){(function(t){e.exports=t}).call(this,{})},PrxY:function(e,t,r){},RzLp:function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty;t.stringify=function(e,t){t=t||"";var r=[];for(var i in"string"!=typeof t&&(t="?"),e)n.call(e,i)&&r.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return r.length?t+r.join("&"):""},t.parse=function(e){for(var t,r=/([^=?&]+)=?([^&]*)/g,n={};t=r.exec(e);n[decodeURIComponent(t[1])]=decodeURIComponent(t[2]));return n}},S6I8:function(e,t,r){(function(e){const t="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==e&&e;function r(e){try{new e}catch(t){return!1}return!0}t.window||"function"==typeof t.Event&&r(t.Event)||(t.Event=function(e,t){this.bubbles=!!t&&!!t.bubbles,this.cancelable=!!t&&!!t.cancelable,this.composed=!!t&&!!t.composed,this.type=e}),t.window||void 0!==t.EventTarget&&r(t.Event)||(t.EventTarget=function(){function e(){this.__listeners=new Map}return e.prototype=Object.create(Object.prototype),e.prototype.addEventListener=function(e,t,r){if(arguments.length<2)throw new TypeError("TypeError: Failed to execute 'addEventListener' on 'EventTarget': 2 arguments required, but only "+arguments.length+" present.");const n=this.__listeners,i=e.toString();n.has(i)||n.set(i,new Map);const o=n.get(i);o.has(t)||o.set(t,r)},e.prototype.removeEventListener=function(e,t,r){if(arguments.length<2)throw new TypeError("TypeError: Failed to execute 'addEventListener' on 'EventTarget': 2 arguments required, but only "+arguments.length+" present.");const n=this.__listeners,i=e.toString();if(n.has(i)){const e=n.get(i);e.has(t)&&e.delete(t)}},e.prototype.dispatchEvent=function(e){if(!(e instanceof Event))throw new TypeError("Failed to execute 'dispatchEvent' on 'EventTarget': parameter 1 is not of type 'Event'.");const t=e.type,r=this.__listeners.get(t);if(r)for(const[i,o]of r.entries()){try{"function"==typeof i?i.call(this,e):i&&"function"==typeof i.handleEvent&&i.handleEvent(e)}catch(n){setTimeout(()=>{throw n})}o&&o.once&&r.delete(i)}return!0},e}())}).call(this,r("yLpj"))},SAlA:function(e,t,r){},UIIZ:function(e,t){var r=Object.prototype.hasOwnProperty,n={},i={};function o(){var e=0;for(var t in n)e++;return e}var a=e.exports={length:o(),getItem:function(e){return r.call(n,e)?n[e]:null},setItem:function(e,t){e in i||(n[e]=t),a.length=o()},removeItem:function(e){delete n[e],a.length=o()},clear:function(){n={},a.length=0},supported:!0}},VFdl:function(e){e.exports=JSON.parse('{"_args":[["@vp/user-context-initializer@2.5.347","/builds/vistaprint-org/merchandising-technology/discovery-pages/home-page"]],"_from":"@vp/user-context-initializer@2.5.347","_id":"@vp/user-context-initializer@2.5.347","_inBundle":false,"_integrity":"sha512-0yOv2e7tJER4C5gpGsjt4nSKmlzL67piS6PNacx3t/LdYVphEorX9Y5mDPiwxdjwn+kfoXguA0nhg0S+vSvBDA==","_location":"/@vp/user-context-initializer","_phantomChildren":{"@optimizely/optimizely-sdk":"4.9.1","@vp/culture-resolution-core":"2.0.13","@vp/sumo-logger":"3.7.0","@vp/tenant-resolution-core":"2.1.14","es-cookie":"1.3.2","uuid":"8.3.2"},"_requested":{"type":"version","registry":true,"raw":"@vp/user-context-initializer@2.5.347","name":"@vp/user-context-initializer","escapedName":"@vp%2fuser-context-initializer","scope":"@vp","rawSpec":"2.5.347","saveSpec":null,"fetchSpec":"2.5.347"},"_requiredBy":["/@vp/customer-profile"],"_resolved":"https://vistaprint.jfrog.io/vistaprint/api/npm/npm/@vp/user-context-initializer/-/@vp/user-context-initializer-2.5.347.tgz","_spec":"2.5.347","_where":"/builds/vistaprint-org/merchandising-technology/discovery-pages/home-page","author":"","bugs":{"url":"https://gitlab.com/vistaprint-org/personalization/starbug/common-infrastructure/user-context-initialiser/issues"},"dependencies":{"@vp/aa-experiment":"^1.0.5","@vp/ab-reader":"^2.1.1","@vp/ab-test-cookie":"^1.1.26","@vp/audience-for-frontend":"^3.1.80","@vp/ctc-reader":"^1.2.28","@vp/culture-resolution":"^2.0.81","@vp/ft-reader":"^0.9.21","@vp/routing-cookie-interface":"^3.0.0","@vp/tenant-resolution":"^2.0.36","@vp/up-reader":"^1.0.2","axios":"^0.24.0","custom-event":"^1.0.1","js-cookie":"^2.2.1"},"description":"The User context initializer is injected by a [Tag Injector](https://app.segment.com/vistaprint/destinations/catalog/tag-injector).","devDependencies":{"@babel/cli":"^7.12.10","@babel/core":"^7.12.10","@babel/plugin-transform-classes":"^7.12.1","@babel/preset-env":"^7.12.11","@babel/runtime":"^7.12.5","@vp/browserslist-config-vp":"^2020.10.2","babel-jest":"^26.6.3","babel-loader":"^8.2.2","babel-plugin-transform-async-to-promises":"^0.8.15","babel-preset-minify":"^0.5.1","chai":"^4.3.4","clean-webpack-plugin":"^3.0.0","core-js":"^3.8.3","isomorphic-fetch":"^3.0.0","jest":"^26.6.3","nock":"^13.2.1","replace-in-file":"^6.2.0","serve":"^13.0.2","webpack":"^5.47.0","webpack-cli":"^4.9.2"},"files":["/lib"],"homepage":"https://gitlab.com/vistaprint-org/personalization/starbug/common-infrastructure/user-context-initialiser#readme","jest":{"clearMocks":true,"testMatch":["**/test/**/*.js"]},"license":"ISC","main":"./lib/main.js","name":"@vp/user-context-initializer","repository":{"type":"git","url":"git+https://gitlab.com/vistaprint-org/personalization/starbug/common-infrastructure/user-context-initialiser.git"},"scripts":{"build":"webpack --mode production","build-npm":"babel src --out-dir lib --copy-files","serve":"serve -l 3001 dist","test":"jest --forceExit ./test/**.spec.js"},"version":"2.5.347"}')},VGhT:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.formatEvents=t.buildConversionEventV1=t.buildImpressionEventV1=t.makeBatchedEventV1=void 0;function i(e){var t=[],r=e[0];return e.forEach((function(e){if("conversion"===e.type||"impression"===e.type){var r=s(e);"impression"===e.type?r.snapshots.push(a(e)):"conversion"===e.type&&r.snapshots.push(o(e)),t.push(r)}})),{client_name:r.context.clientName,client_version:r.context.clientVersion,account_id:r.context.accountId,project_id:r.context.projectId,revision:r.context.revision,anonymize_ip:r.context.anonymizeIP,enrich_decisions:!0,visitors:t}}function o(e){var t=n({},e.tags);delete t.revenue,delete t.value;var r={entity_id:e.event.id,key:e.event.key,timestamp:e.timestamp,uuid:e.uuid};return e.tags&&(r.tags=e.tags),null!=e.value&&(r.value=e.value),null!=e.revenue&&(r.revenue=e.revenue),{events:[r]}}function a(e){var t,r,n=e.layer,i=e.experiment,o=e.variation,a=e.ruleKey,s=e.flagKey,u=e.ruleType,l=e.enabled,c=n?n.id:null;return{decisions:[{campaign_id:c,experiment_id:null!==(t=null==i?void 0:i.id)&&void 0!==t?t:"",variation_id:null!==(r=null==o?void 0:o.id)&&void 0!==r?r:"",metadata:{flag_key:s,rule_key:a,rule_type:u,variation_key:o?o.key:"",enabled:l}}],events:[{entity_id:c,timestamp:e.timestamp,key:"campaign_activated",uuid:e.uuid}]}}function s(e){var t={snapshots:[],visitor_id:e.user.id,attributes:[]};return e.user.attributes.forEach((function(e){t.attributes.push({entity_id:e.entityId,key:e.key,type:"custom",value:e.value})})),"boolean"==typeof e.context.botFiltering&&t.attributes.push({entity_id:"$opt_bot_filtering",key:"$opt_bot_filtering",type:"custom",value:e.context.botFiltering}),t}t.makeBatchedEventV1=i,t.buildImpressionEventV1=function(e){var t=s(e);return t.snapshots.push(a(e)),{client_name:e.context.clientName,client_version:e.context.clientVersion,account_id:e.context.accountId,project_id:e.context.projectId,revision:e.context.revision,anonymize_ip:e.context.anonymizeIP,enrich_decisions:!0,visitors:[t]}},t.buildConversionEventV1=function(e){var t=s(e);return t.snapshots.push(o(e)),{client_name:e.context.clientName,client_version:e.context.clientVersion,account_id:e.context.accountId,project_id:e.context.projectId,revision:e.context.revision,anonymize_ip:e.context.anonymizeIP,enrich_decisions:!0,visitors:[t]}},t.formatEvents=function(e){return{url:"https://logx.optimizely.com/v1/events",httpVerb:"POST",params:i(e)}}},VPC1:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("F0u8");function i(e){return Object.keys(e).map((function(t){return e[t]}))}t.generateUUID=function(){return n.v4()},t.getTimestamp=function(){return(new Date).getTime()},t.isValidEnum=function(e,t){for(var r=!1,n=Object.keys(e),i=0;i<n.length;i++)if(t===e[n[i]]){r=!0;break}return r},t.groupBy=function(e,t){var r={};return e.forEach((function(e){var n=t(e);r[n]=r[n]||[],r[n].push(e)})),i(r)},t.objectValues=i,t.objectEntries=function(e){return Object.keys(e).map((function(t){return[t,e[t]]}))},t.find=function(e,t){for(var r,n=0,i=e;n<i.length;n++){var o=i[n];if(t(o)){r=o;break}}return r},t.keyBy=function(e,t){var r={};return e.forEach((function(e){var n=t(e);r[n]=e})),r},t.sprintf=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=0;return e.replace(/%s/g,(function(){var e=t[n++],r=typeof e;return"function"===r?e():"string"===r?e:String(e)}))},function(e){e.ACTIVATE="ACTIVATE:experiment, user_id,attributes, variation, event",e.DECISION="DECISION:type, userId, attributes, decisionInfo",e.LOG_EVENT="LOG_EVENT:logEvent",e.OPTIMIZELY_CONFIG_UPDATE="OPTIMIZELY_CONFIG_UPDATE",e.TRACK="TRACK:event_key, user_id, attributes, event_tags, event"}(t.NOTIFICATION_TYPES||(t.NOTIFICATION_TYPES={}))},Vw5I:function(e,t,r){"use strict";r.d(t,"a",(function(){return Yt}));var n={};r.r(n),r.d(n,"default",(function(){return b}));var i=r("Nz9T"),o=r.n(i),a=r("vJXh"),s=r.n(a),u=r("vDqi"),l=r.n(u),c="https://rich.customer-profile.vpsvc.com";function d(e,t){return e?l.a.delete(c+"/api/v2/customer/me/brand/"+t,{responseType:"json",headers:{Authorization:"Bearer "+e,"X-Requestor":"react-brand"}}).catch((function(e){var t;return Promise.reject(new Error(null!==(t=e.response.data.message)&&void 0!==t?t:"Unknown error ocurred."))})):Promise.reject(new Error("Access token was undefined."))}function p(e,t,r){return e?l.a.put(c+"/api/v2/customer/me/brand/"+t,r,{responseType:"json",headers:{Authorization:"Bearer "+e,"Content-Type":"application/json","X-Requestor":"react-brand"}}).then((function(e){return e.data.brandProfile})).catch((function(e){var t;return Promise.reject(new Error(null!==(t=e.response.data.message)&&void 0!==t?t:"Unknown error ocurred."))})):Promise.reject(new Error("Access token was undefined."))}var f=function(e){if("undefined"!=typeof window){var t=new CustomEvent("activeBrandChanged",{detail:e});window.dispatchEvent(t)}return Promise.resolve()},h=function(e){if("undefined"!=typeof window){var t=new CustomEvent("brandCreated",{detail:e});window.dispatchEvent(t)}return Promise.resolve()},g=function(e){if("undefined"!=typeof window){var t=new CustomEvent("brandUpdated",{detail:e});window.dispatchEvent(t)}return Promise.resolve()},v=function(e){if("undefined"!=typeof window){var t=new CustomEvent("brandDeleted",{detail:e});window.dispatchEvent(t)}return Promise.resolve()},m=function(e){var t=function t(){window.tracking&&(window.tracking.track("Active Brand Changed",e),window.removeEventListener("trackingReady",t))};return"undefined"!=typeof window&&(window.tracking&&window.tracking.track?t():window.addEventListener("trackingReady",t)),Promise.resolve()},E=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},y=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},b=function(){function e(e){this.accessToken=e}return e.prototype.getActiveBrandId=function(){var e=s.a.getItem("active-brand-id");return Promise.resolve(e)},e.prototype.setActiveBrandId=function(e){return E(this,void 0,void 0,(function(){var t,r;return y(this,(function(n){switch(n.label){case 0:return[4,this.getActiveBrandId()];case 1:return t=n.sent(),s.a.setItem("active-brand-id",e),r={newBrandId:e},t&&(r.oldBrandId=t),[4,f(r)];case 2:return n.sent(),[4,m(r)];case 3:return n.sent(),[2]}}))}))},e.prototype.clearActiveBrandId=function(){return E(this,void 0,void 0,(function(){var e,t;return y(this,(function(r){switch(r.label){case 0:return[4,this.getActiveBrandId()];case 1:return e=r.sent(),sessionStorage.removeItem("active-brand-id"),[4,f(t={oldBrandId:e})];case 2:return r.sent(),[4,m(t)];case 3:return r.sent(),[2]}}))}))},e.prototype.getBrands=function(){return(e=this.accessToken,e?l.a.get(c+"/api/v2/customer/me/brand",{responseType:"json",headers:{Authorization:"Bearer "+e,"X-Requestor":"react-brand"}}).then((function(e){return e.data.brandProfiles})).catch((function(e){var t;return Promise.reject(new Error(null!==(t=e.response.data.message)&&void 0!==t?t:"Unknown error ocurred."))})):Promise.reject(new Error("Access token was undefined."))).catch((function(e){return Promise.reject(new Error("Failed to get brands. "+e.message))}));var e},e.prototype.createBrand=function(e){return E(this,void 0,void 0,(function(){var t;return y(this,(function(r){switch(r.label){case 0:return[4,(n=this.accessToken,i=null!=e?e:{},n?l.a.post(c+"/api/v2/customer/me/brand",i,{responseType:"json",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json","X-Requestor":"react-brand"}}).then((function(e){return e.data.brandProfile})).catch((function(e){var t;return Promise.reject(new Error(null!==(t=e.response.data.message)&&void 0!==t?t:"Unknown error ocurred."))})):Promise.reject(new Error("Access token was undefined."))).catch((function(e){return Promise.reject(new Error("Failed to create a brand. "+e.message))}))];case 1:return t=r.sent(),[4,h({brand:t})];case 2:return r.sent(),[2,t]}var n,i}))}))},e.prototype.updateBrand=function(e,t){return E(this,void 0,void 0,(function(){var r;return y(this,(function(n){switch(n.label){case 0:return[4,p(this.accessToken,e,t).catch((function(e){return Promise.reject(new Error("Failed to update a brand. "+e.message))}))];case 1:return r=n.sent(),[4,g({brand:r})];case 2:return n.sent(),[2,r]}}))}))},e.prototype.deleteBrand=function(e){return E(this,void 0,void 0,(function(){return y(this,(function(t){switch(t.label){case 0:return[4,d(this.accessToken,e).catch((function(e){return Promise.reject(new Error("Failed to delete a brand. "+e.message))}))];case 1:return t.sent(),[4,v({brandId:e})];case 2:return t.sent(),[2]}}))}))},e}(),I=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},_=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},O=(o.a.createContext({activeBrand:void 0,brands:[],isInitialized:!1,ensureActiveBrand:function(){return I(void 0,void 0,void 0,(function(){return _(this,(function(e){return[2,Promise.resolve({})]}))}))},api:{setActiveBrand:function(e){return I(void 0,void 0,void 0,(function(){return _(this,(function(e){return[2]}))}))},createBrand:function(e,t){return I(void 0,void 0,void 0,(function(){return _(this,(function(e){return[2,Promise.resolve({})]}))}))},updateBrand:function(e){return I(void 0,void 0,void 0,(function(){return _(this,(function(e){return[2]}))}))},deleteBrand:function(e){return I(void 0,void 0,void 0,(function(){return _(this,(function(e){return[2]}))}))}}}),r("GJY6"));async function w(e){await async function(e){if(!e.accessToken)throw new Error("Missing access token.");await l.a.patch("https://rich.customer-profile.vpsvc.com/api/v1/profile/me",{traits:e.traits},{responseType:"json",headers:{Authorization:"Bearer "+e.accessToken,"Content-Type":"application/json","X-Requestor":e.requestor}})}(e),await async function(e){try{await Object(O.updateUserContext)(e,null,!0,!1)}catch(t){console.log("Update of user context failed")}}(e.accessToken)}var T=r("GRpk"),N=r("wyvy"),R=r("AU/X"),A=r("DGVI"),S=r("J8aS"),C=r("C1X4");const D=({onClick:e,quizCompleted:t,content:r})=>{const{sourcePagePath:n}=Object(A.b)(),o=t?C.a.GoBack:C.a.GetStarted,a=t?r.ctaUrl:n,s=Object(R.q)({sourcePagePath:n,destinationPagePath:a,ctaValue:o}),u=s?s.linkAttributes:{};return t?i.createElement(N.TextButton,Object.assign({skin:"primary",component:N.Link,href:r.ctaUrl,className:"homepage-quiz-section-button",onClick:Object(S.a)(s,r.ctaUrl)},u),r.ctaText):i.createElement(N.TextButton,Object.assign({skin:"primary",className:"homepage-quiz-section-button"},u,{onClick:()=>{Object(S.b)(s),e()}}),r.ctaText)};var L=r("w7uu");r("KwH3");const U=({locale:e,onClick:t,quizCompleted:r})=>{if(void 0===e)return null;if("undefined"==typeof window)return i.createElement(P,null);const n=r?"quizCompleted":"quizBanner",o=Object(L.a)({locale:e,contentId:n});return o?i.createElement(N.BoundedContent,{as:"article",className:"homepage-quiz-section-container",mb:{lg:6,sm:6,md:0,xs:0},mx:{lg:"auto",xs:4}},i.createElement(N.GridContainer,{p:4},i.createElement(N.Row,{className:"homepage-quiz-section-container--row"},i.createElement(N.Column,{span:8,spanLg:10},i.createElement(N.FlexBox,{flexDirection:"column",justifyContent:"center",className:"homepage-quiz-section-text-wrapper"},i.createElement(N.Typography,{component:"p",weight:"bold",align:"left",textSize:3,mb:2},o.title),i.createElement(N.Typography,{component:"p",textSize:4,align:"left",mt:0},o.subTitle))),i.createElement(N.Column,{span:4,spanLg:2},i.createElement(N.FlexBox,{className:"homepage-quiz-section-button-container",pb:{lg:5,xs:0},pt:{lg:5,xs:4},pl:{lg:5,xs:0},pr:{lg:5,xs:0}},i.createElement(D,{onClick:t,quizCompleted:r,content:o})))))):null},P=()=>{const e=i.useRef(null),[t,r]=i.useState(1368),n=t<800;i.useLayoutEffect(()=>{null!=e&&e.current&&r(e.current.offsetWidth)},[]);const o={height:n?260:116,width:t,cardWidth:n?t-64:t-110,cardHeight:n?260:116},a="#e0dede",s="#f5f5f5";return i.createElement(N.BoundedContent,{as:"article",className:"homepage-quiz-section-container",mb:{lg:6,sm:6,md:0,xs:0},mx:{lg:"auto",xs:4},ref:e},i.createElement(N.GridContainer,{p:4},i.createElement(N.Row,{className:"homepage-quiz-section-container--row"},i.createElement(T.a,{title:"A loading text TBD",backgroundColor:a,foregroundColor:s,height:o.height,width:o.width},i.createElement("rect",{rx:"10",ry:"10",width:o.cardWidth,height:o.cardHeight})))))};var x=r("wMS7"),k=r.n(x),F=r("ZM+o"),M=r("yUlY"),j=r("zFH3"),V=r("bn5K");const B=({activeStep:e})=>{const{dispatch:t,state:r}=Object(F.c)(),n=e>0,o=Object(L.b)({locale:r.locale})||{};return n?i.createElement(N.TextButton,{onClick:()=>{t({type:F.a.Decrement}),t({type:F.a.SetStepCompleted,payload:{step:e,completed:!1}}),t({type:F.a.SetStepCompleted,payload:{step:e-1,completed:!1}})},skin:"secondary"},o.prevButton):null},G=({activeStep:e,disabled:t,onClick:r})=>{const{state:n,dispatch:o}=Object(F.c)(),{isIdentityInitialized:a,identity:s,auth:u}=Object(j.a)(),l=e===n.maxNumberOfSteps-1,c=l?()=>{r(),a&&(s&&s.isSignedIn?o({type:F.a.Completed}):(K(),u.signIn(),o({type:F.a.CompletedAnonymous})))}:()=>{r(),o({type:F.a.Increment})},d=Object(L.b)({locale:n.locale})||{};return i.createElement(N.TextButton,{disabled:t,onClick:c,skin:"primary"},l?d.lastStepButton:d.nextButton)},K=()=>{window.localStorage.setItem(V.e,"true")};r("Ld4u");const z=({completedSteps:e,activeStep:t,tracking:r})=>i.createElement(N.ModalDialogFooter,{pinned:!0,className:"onboarding-modal-footer","data-step":t},i.createElement(N.Divider,null),i.createElement(N.ModalDialogButtons,null,i.createElement(N.GridContainer,null,i.createElement(N.Row,null,i.createElement(N.Column,{span:6,spanXs:6,align:"left"},i.createElement(B,{activeStep:t})),i.createElement(N.Column,{span:6,spanXs:6,align:"right"},i.createElement(G,{disabled:!e[t],activeStep:t,onClick:()=>{const e=Object(R.m)({step:r.step,eventDetail:r.eventDetail});Object(S.b)(e)}}))))));r("lN1A");function H({logo:e,className:t,scenes:r}){return i.createElement(N.Box,{className:t+" product-preview"},r.map((t,r)=>i.createElement("img",{key:r,className:"product-preview-image",src:""+q({scene:t,logo:e}),loading:"lazy"})))}const q=({scene:e,logo:t})=>t?Y({scene:e,logo:t}):e.placeholderImage,Y=({logo:e,scene:t})=>{const r=Math.max(e.width,e.height),n=(r-e.width)/2,i=(r-e.height)/2,o={version:"2",deleted:!1,revision:0,document:{panels:[{name:"front",width:r+"mm",height:r+"mm",images:[{printUrl:e.printUrl,previewUrl:e.previewUrl,zIndex:5,position:{x:n+"mm",y:i+"mm",width:e.width+"mm",height:e.height+"mm"},horizontalAlignment:"left",verticalAlignment:"top",pageNumber:0}],shapes:[]}]},fontRepositoryUrl:"https://fonts.documents.cimpress.io/prod"},a=encodeURIComponent(JSON.stringify(o));return"https://rendering.documents.cimpress.io/v1/cse/preview?width=500&height=500&format=png&instructions_uri="+encodeURIComponent("https://instructions.documents.cimpress.io/v3/instructions:preview?documentUri="+a)+"&scene="+encodeURIComponent(t.sceneUrl)};var W=r("JJkS");const X=()=>{const{selectionsState:e,selectionsDispatch:t}=Object(M.c)(),[r,n]=i.useState(void 0);return i.useEffect(()=>{if("undefined"!=typeof window){const e=window.localStorage.getItem("homepage_onboarding");if(e){const r=JSON.parse(e);n(r),t({type:M.a.SetFromLocalStorage,payload:{selections:r}})}}},[]),i.useEffect(()=>{if(e.selections){const t=JSON.stringify(e.selections);window.localStorage.getItem("homepage_onboarding")!==t&&J(t)}},[r,e.selections]),{onboarding:r,setOnboarding:n}},J=e=>window.localStorage.setItem("homepage_onboarding",e);r("ZMCJ");const Z=()=>i.createElement("svg",{className:"spinner",viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"},i.createElement("circle",{className:"spinner-circle",cx:"50",cy:"50",r:"45"})),Q=()=>{const{onboardingUploadState:e}=Object(W.c)();return e.error?i.createElement(N.Typography,null,"Image upload failed. Please try again."):e.loading?i.createElement(Z,null):i.createElement(N.ResponsiveImage,{src:"https://cms.cloudinary.vpsvc.com/image/upload/c_scale,co_rgb:000000,dpr_auto,e_colorize:100,f_auto,w_auto/page_icons/UploadIcon"})};r("E9XD");function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var ee=r("2CXu"),te=r.n(ee),re={CASE_SENSITIVE_EQUAL:7,EQUAL:6,STARTS_WITH:5,WORD_STARTS_WITH:4,CONTAINS:3,ACRONYM:2,MATCHES:1,NO_MATCH:0};ie.rankings=re;var ne=function(e,t){return String(e.rankedValue).localeCompare(String(t.rankedValue))};function ie(e,t,r){void 0===r&&(r={});var n=r,i=n.keys,o=n.threshold,a=void 0===o?re.MATCHES:o,s=n.baseSort,u=void 0===s?ne:s,l=n.sorter;return(void 0===l?function(e){return e.sort((function(e,t){return function(e,t,r){var n=e.rank,i=e.keyIndex,o=t.rank,a=t.keyIndex;return n===o?i===a?r(e,t):i<a?-1:1:n>o?-1:1}(e,t,u)}))}:l)(e.reduce((function(e,n,o){var s=function(e,t,r,n){if(!t){return{rankedValue:e,rank:oe(e,r,n),keyIndex:-1,keyThreshold:n.threshold}}return function(e,t){for(var r=[],n=0,i=t.length;n<i;n++)for(var o=t[n],a=le(o),s=se(e,o),u=0,l=s.length;u<l;u++)r.push({itemValue:s[u],attributes:a});return r}(e,t).reduce((function(e,t,i){var o=e.rank,a=e.rankedValue,s=e.keyIndex,u=e.keyThreshold,l=t.itemValue,c=t.attributes,d=oe(l,r,n),p=a,f=c.minRanking,h=c.maxRanking,g=c.threshold;return d<f&&d>=re.MATCHES?d=f:d>h&&(d=h),d>o&&(o=d,s=i,u=g,p=l),{rankedValue:p,rank:o,keyIndex:s,keyThreshold:u}}),{rankedValue:e,rank:re.NO_MATCH,keyIndex:-1,keyThreshold:n.threshold})}(n,i,t,r),u=s.rank,l=s.keyThreshold;u>=(void 0===l?a:l)&&e.push($({},s,{item:n,index:o}));return e}),[])).map((function(e){return e.item}))}function oe(e,t,r){return e=ae(e,r),(t=ae(t,r)).length>e.length?re.NO_MATCH:e===t?re.CASE_SENSITIVE_EQUAL:(e=e.toLowerCase())===(t=t.toLowerCase())?re.EQUAL:e.startsWith(t)?re.STARTS_WITH:e.includes(" "+t)?re.WORD_STARTS_WITH:e.includes(t)?re.CONTAINS:1===t.length?re.NO_MATCH:(n=e,i="",n.split(" ").forEach((function(e){e.split("-").forEach((function(e){i+=e.substr(0,1)}))})),i).includes(t)?re.ACRONYM:function(e,t){var r=0,n=0;function i(e,t,n){for(var i=n,o=t.length;i<o;i++){if(t[i]===e)return r+=1,i+1}return-1}var o=i(t[0],e,0);if(o<0)return re.NO_MATCH;n=o;for(var a=1,s=t.length;a<s;a++){var u=t[a];if(!((n=i(u,e,n))>-1))return re.NO_MATCH}return function(e){var n=1/e,i=r/t.length;return re.MATCHES+i*n}(n-o)}(e,t);var n,i}function ae(e,t){return e=""+e,t.keepDiacritics||(e=te()(e)),e}function se(e,t){var r;if("object"==typeof t&&(t=t.key),"function"==typeof t)r=t(e);else if(null==e)r=null;else if(Object.hasOwnProperty.call(e,t))r=e[t];else{if(t.includes("."))return function(e,t){for(var r=e.split("."),n=[t],i=0,o=r.length;i<o;i++){for(var a=r[i],s=[],u=0,l=n.length;u<l;u++){var c=n[u];if(null!=c)if(Object.hasOwnProperty.call(c,a)){var d=c[a];null!=d&&s.push(d)}else"*"===a&&(s=s.concat(c))}n=s}if(Array.isArray(n[0])){var p=[];return p.concat.apply(p,n)}return n}(t,e);r=null}return null==r?[]:Array.isArray(r)?r:[String(r)]}var ue={maxRanking:1/0,minRanking:-1/0};function le(e){return"string"==typeof e?ue:$({},ue,e)}var ce,de=r("yqlo");!function(e){e.LEVEL1="level1_label",e.LEVEL2="level2_label",e.LEVEL3="level3_label"}(ce||(ce={}));const pe={minRanking:ie.rankings.EQUAL,key:ce.LEVEL3},fe={keys:[ce.LEVEL3,pe]},he=({options:e,term:t})=>{const[r]=i.useState(ie(e,t,fe)),n=((e="",t)=>{const[r,n]=i.useState([]),o=Object(de.useThrottle)(e,100);return i.useEffect(()=>{const e=ie(t||[],o,fe);n(e)},[t,o]),""===o.trim()?null:r})(t,r);return n&&n.length>0&&t.length>0?i.createElement(N.ComboboxPopover,null,i.createElement(N.ComboboxList,null,n.slice(0,10).map(e=>i.createElement(N.ComboboxOption,{key:e.level3_id,value:e.level3_label})))):null};r("SAlA");const ge=({options:e,term:t,placeholderText:r,selectedIndustry:n,onChange:o,onSelect:a})=>{const[s]=i.useState(e);return i.createElement(N.Combobox,{openOnFocus:!0,"aria-value":n,"aria-labelledby":n,placeholder:r,onSelect:a,className:"input-with-floating-label"},i.createElement(N.ComboboxInput,{value:n||t,onChange:o,placeholder:r}),i.createElement(he,{options:s,term:t}))};r("S6I8");function ve(e,t){const{method:r,headers:n,query:i,signal:o}=t,a={method:r,headers:n};if(o&&(a.signal=o),"POST"===r||"PATCH"===r){const{body:e}=t;"object"==typeof e&&(a.body=JSON.stringify(e),a.headers=Object.assign(Object.assign({},a.headers),{"Content-Type":"application/json"}))}const s=i?new URLSearchParams(i).toString():"";return fetch("".concat(e).concat(s?"?".concat(s):""),a).then(e=>function(e){if(!e.ok){const t={status:e.status,statusText:e.statusText};return Promise.reject(t)}try{return 204===e.status?Promise.resolve():e.json().then(e=>e)}catch(t){return Promise.resolve()}}(e))}var me=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};const Ee="https://uploads.design.vpsvc.com/api/v1/uploads";function ye({headers:e,process:t,url:r,owner:n,signal:i}){return me(this,void 0,void 0,(function*(){const o={};t&&(o.process=t),r&&(o.url=r),n&&(o.owner=n);return(yield ve("".concat(Ee,"/postUrl"),{method:"GET",headers:e,query:o,signal:i}).catch(e=>{throw new Error("Failed to get upload post url: ".concat(e.message))})).postUrl}))}var be;!function(e){e.Original="Original",e.Print="Print",e.WebPreview="WebPreview",e.Thumb="Thumb",e.BackgroundKnockout="BackgroundKnockout",e.Embroidery="Embroidery",e.Monochrome="Monochrome",e.Crispify="Crispify",e.Segmented="Segmented"}(be||(be={}));var Ie,_e=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};!function(e){e.Idle="Idle",e.Fetching="Fetching",e.Error="Error"}(Ie||(Ie={}));var Oe=r("aFzQ");Symbol();class we extends Error{constructor(e){super(e.statusText),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"statusText",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.setPrototypeOf(this,new.target.prototype),this.headers=e.headers,this.url=e.url,this.status=e.status,this.statusText=e.statusText,this.data=e.data}}var Te=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};function Ne(...e){let t={};const r=new Headers;return e.forEach(e=>{e&&(t=Object.assign(t,e),new Headers(e.headers).forEach((e,t)=>{null!=e&&r.set(t,e)}))}),Object.assign(Object.assign({},t),{headers:r})}function Re(e){var t;const{payload:r}=e,n=function(e,t){return t?e.replace(/\{([^}]+)\}/g,(e,r)=>encodeURIComponent(t[r])):e}(e.path,r.path),i=function(e){if(!e)return"";const t=new URLSearchParams(e).toString();return t.length?"?".concat(t):""}(r.queryParams),o=function(e,t){if(!t)return;const r=(e=>"post"===e||"put"===e||"patch"===e||"delete"===e)(e)?JSON.stringify(t):void 0;return"delete"!==e&&"post"!==e||"{}"!==r?r:void 0}(e.method,r.body),a=function(e,t={}){const r=new Headers(e);return!r.has("Content-Type")&&Object.keys(t).length&&r.append("Content-Type","application/json"),r.has("Accept")||r.append("Accept","application/json"),r}((null===(t=e.init)||void 0===t?void 0:t.headers)||{},o);return{url:e.baseUrl+n+i,init:Object.assign(Object.assign({},e.init),{method:e.method.toUpperCase(),headers:a,body:o})}}function Ae(e,t){return Te(this,void 0,void 0,(function*(){const r=yield fetch(e,t),n=yield function(e){return Te(this,void 0,void 0,(function*(){const t=yield e.text();try{return JSON.parse(t)}catch(r){return t}}))}(r),i={headers:r.headers,url:r.url,ok:r.ok,status:r.status,statusText:r.statusText,data:n};if(i.ok)return i;throw new we(i)}))}function Se(){const e={},t=Ae;return{path:r=>({method:n=>({create:({defaultInit:i}={})=>(o,a)=>{const s="function"==typeof i?i(a):i;return function(e){return Te(this,void 0,void 0,(function*(){const{url:t,init:r}=Re(e);return yield e.fetch(t,r)}))}({baseUrl:"https://api.sherbert.cimpress.io",path:r,method:n,payload:o,init:Ne(e,s,a),fetch:t})}})})}}function Ce(...e){const t=new Headers;return e.forEach(e=>{(e instanceof Headers?e:new Headers(e)).forEach((e,r)=>{t.set(r,e)})}),t}var De=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};const Le={accept:"application/json"};function Ue({url:e,headers:t,signal:r,pollingFrequencyMs:n=1e3}){return De(this,void 0,void 0,(function*(){const i=yield Ae(e,{headers:Ce(Le,t),signal:r});if(200===i.status)return i;const o=function(e){const t=e.headers.get("Location");if(!t)throw new Error("No Location header in response");return t}(i);var a;return yield(a=n,new Promise(e=>{setTimeout(e,a)})),Ue({url:o,headers:t,pollingFrequencyMs:n,signal:r})}))}var Pe=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};function xe(e){const t=new FormData;for(const[r,n]of Object.entries(e))n instanceof Blob||"string"==typeof n?t.append(r,n):n instanceof Date?t.append(r,n.toISOString()):t.append(r,JSON.stringify(n));return t}function ke(e){const{status:t,responseText:r,statusText:n,responseURL:i}=e,o=t>=200&&t<300;return{headers:function(e){const t=new Headers,r=e.split("\r\n");for(const n of r)if(n){const[e,r]=n.split(": ");t.append(e,r)}return t}(e.getAllResponseHeaders()),ok:o,status:t,statusText:n,url:i,data:r?JSON.parse(r):{}}}var Fe=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};const Me={headers:{prefer:"respond-async,wait=30"}},je=(()=>Se())(),Ve=e=>(...t)=>Fe(void 0,void 0,void 0,(function*(){const r=yield e(...t),{headers:n,signal:i}=t[1];if(!r.ok)throw new we(r);if(202===r.status){const e=r.headers.get("Location");if(!e)throw new Error("No Location header in response");return Ue({url:e,headers:n,signal:null!=i?i:void 0})}return r})),Be=je.path("/v2/assets").method("get").create(),Ge=(je.path("/v2/assets/{id}").method("get").create(),je.path("/v2/assets/{id}").method("patch").create(),je.path("/v2/assets/{id}").method("put").create(),je.path("/v2/assets/{id}:presign").method("post").create()),Ke=(je.path("/v2/assets/{id}/metadata").method("get").create(),je.path("/v2/assets/{id}/links").method("get").create(),je.path("/v2/assets/{id}/{variant}").method("get").create(),Ve(je.path("/v2/assets/{id}/{variant}/metadata").method("get").create({defaultInit:Me}))),ze=(je.path("/v2/links").method("get").create(),je.path("/v2/links").method("post").create(),je.path("/v2/links/{id}").method("get").create(),je.path("/v2/links/{id}").method("put").create(),je.path("/v2/links/{id}").method("delete").create(),je.path("/v2/assets/{id}").method("delete").create({defaultInit:e=>{const t=new Headers(e.headers);return t.set("content-type","text/plain"),t.has("If-Match")||t.has("If-None-Match")||t.set("If-Match","*"),Ne(e,{headers:t})}})),He=Ve(je.path("/v2/assets").method("post").create({defaultInit:Me})),qe=Ve(({body:e},{signal:t,onProgress:r,headers:n})=>Fe(void 0,void 0,void 0,(function*(){return function({method:e,url:t,headers:r,body:n,onProgress:i,signal:o}){return Pe(this,void 0,void 0,(function*(){return new Promise((a,s)=>{const u=new DOMException("Request aborted","AbortError");if(o&&o.aborted)return void s(u);const l=new XMLHttpRequest;if(l.open(e.toUpperCase(),t.toString(),!0),i&&"function"==typeof i){const e=e=>i(Math.round(100*e.loaded/e.total));"function"==typeof l.upload.addEventListener?l.upload.addEventListener("progress",e,{signal:null!=o?o:void 0}):l.upload.onprogress=e}o&&o.addEventListener("abort",(function(){l.abort()}),{once:!0}),r.forEach((e,t)=>l.setRequestHeader(t,e)),l.onload=()=>a(l),l.onabort=()=>s(u),l.onerror=()=>s(l.statusText),l.send(n)})}))}({body:xe(e),headers:Ce(Me.headers,n),signal:t,method:"POST",url:"".concat("https://api.sherbert.cimpress.io","/v2/assets"),onProgress:r}).then(e=>ke(e))})));class Ye{constructor(e){Object.defineProperty(this,"abortController",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abortController=new AbortController;const t=this;e.forEach(e=>{e&&(e.aborted&&t.abortController.abort(),e.addEventListener("abort",(function r(){e.removeEventListener("abort",r),t.abortController.abort()})))})}get signal(){return this.abortController.signal}}function We(e){var t;return"AbortError"===(null===(t=e)||void 0===t?void 0:t.name)}var Xe,Je;!function(e){e.Unprepared="Unprepared",e.Preparing="Preparing",e.Prepared="Prepared",e.Deleting="Deleting",e.Deleted="Deleted",e.Error="Error"}(Xe||(Xe={})),function(e){e.PresignFailed="Couldn't presign asset",e.PrepareDeletingAsset="Can't prepare asset when it's being deleted",e.PrepareDeletedAsset="Can't prepare an asset that has been deleted",e.EmptySignature="Signature is empty or does not exist",e.InvalidSourceData="Invalid asset source data",e.MissingAssetId="Missing asset ID"}(Je||(Je={}));var Ze=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Qe=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},$e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};class et{constructor(e){Object.defineProperty(this,"authProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"uploadOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"composeOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"prepareAbortController",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"preparePromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"variantCache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:{type:Xe.Unprepared}}),Object.defineProperty(this,"_data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object(Oe.c)(this),this.authProvider=e.authProvider,this.variantCache=new Map,!function(e){return"parentAsset"in e}(e)?!function(e){return"assetData"in e}(e)?this.uploadOptions=e:this.setAssetData(e.assetData):this.composeOptions=Object.assign({},e)}static fromFile(e){return new et(e)}static fromUri(e){return new et(e)}static fromData({assetData:e,authProvider:t}){const r=new et({assetData:e,authProvider:t});return r.setStatus({type:Xe.Prepared}),r}prepare(e={}){return Qe(this,void 0,void 0,(function*(){if(this.status.type===Xe.Deleting)throw new Error(Je.PrepareDeletingAsset);if(this.status.type===Xe.Deleted&&!this.isVariant)throw new Error(Je.PrepareDeletedAsset);return this.preparePromise&&this.status.type!==Xe.Unprepared&&this.status.type!==Xe.Error||(this.preparePromise=this._prepare(e)),this.preparePromise}))}_prepare({signal:e}={}){return Qe(this,void 0,void 0,(function*(){var t;if(this.status.type!==Xe.Prepared)try{this.prepareAbortController=new AbortController;const r=new Ye([e,this.prepareAbortController.signal]);this.setStatus({type:Xe.Preparing});const n=yield this.getAuthHeaders();if(this.isVariant){yield this.baseAsset.prepare({signal:r.signal});const e=yield Ke({path:{id:this.baseAsset.data.id,variant:this.composeOptions.processTypeUrlPath}},{signal:r.signal,headers:n});this.setAssetData(e.data)}else if((t=this.uploadOptions)&&"file"in t){const e=this.uploadOptions,{onProgress:t,authProvider:i}=e,o=$e(e,["onProgress","authProvider"]),a=e=>{this.setStatus({type:Xe.Preparing,uploadProgress:e}),null==t||t(e)},s=yield qe({body:Object.assign({},o)},{signal:r.signal,onProgress:a,headers:n});this.setAssetData(s.data)}else{if(!function(e){return!!e&&"uri"in e}(this.uploadOptions))throw new Error(Je.InvalidSourceData);{const e=this.uploadOptions,{authProvider:t}=e,i=$e(e,["authProvider"]),o=yield He({body:Object.assign({},i)},{signal:r.signal,headers:n});this.setAssetData(o.data)}}this.setStatus({type:Xe.Prepared})}catch(r){if(this.status.type===Xe.Deleted)return;if(We(r))return void this.setStatus({type:Xe.Unprepared});this.setErrorStatus(r)}}))}presign({signal:e}={}){return Qe(this,void 0,void 0,(function*(){if(!this.signature&&this.status.type!==Xe.Deleted&&this.status.type!==Xe.Deleting)if(this.isVariant)yield this.baseAsset.presign();else{if(this.hasAssetId()||(yield this.prepare()),!this.hasAssetId())throw new Error(Je.MissingAssetId);let r;try{const t=yield this.getAuthHeaders();r=yield Ge({path:{id:this.data.id}},{signal:e,headers:t})}catch(t){if(We(t))return;throw new Error(Je.PresignFailed)}if(200===(null==r?void 0:r.status)){const{signature:e}=r.data;if(this.setSignature(e),!e)throw new Error(Je.EmptySignature)}}}))}getUrl({includeSignature:e=!1}={}){let t;if(this.isVariant){const{parentAsset:e,processTypeUrlPath:r}=this.composeOptions,n=e.getUrl();t="".concat(n,"/").concat(r)}else{if(!this.hasAssetId())throw new Error(Je.MissingAssetId);t="".concat("https://api.sherbert.cimpress.io","/v2/assets/").concat(this.data.id)}const r=new URL(t);if(e){if(!this.signature)throw new Error(Je.EmptySignature);r.searchParams.set("signature",this.signature)}return r.toString()}getUrlAsync({includeSignature:e=!1}={}){return Qe(this,void 0,void 0,(function*(){return this._data||this.isVariant||(yield this.prepare()),e&&!this.signature&&(yield this.presign()),this.getUrl({includeSignature:e})}))}get data(){return this._data}getDataAsync(){return Qe(this,void 0,void 0,(function*(){return this._data||(yield this.prepare()),this._data}))}delete(){var e;return Qe(this,void 0,void 0,(function*(){if(this.status.type!==Xe.Deleting){if(this.status.type===Xe.Preparing&&(null===(e=this.prepareAbortController)||void 0===e||e.abort()),this.hasAssetId()&&this.status.type!==Xe.Deleted&&this.status.type!==Xe.Unprepared)try{this.setStatus({type:Xe.Deleting});const e=yield this.getAuthHeaders();yield ze({path:{id:this.data.id}},{headers:e}),this.isVariant&&(this.preparePromise=void 0)}catch(t){return void this.setErrorStatus(t)}this.setStatus({type:Xe.Deleted})}else yield Object(Oe.e)(()=>this.status.type!==Xe.Deleting)}))}get print(){return this.derive("print")}get webPreview(){return this.derive("webPreview")}get thumbnail(){return this.derive("thumb")}get embroidery(){return this.derive("embroidery")}get monochrome(){return this.derive("monochrome")}get sharpened(){return this.derive("sharpened")}get backgroundRemoved(){return this.derive("backgroundRemoved")}derive(e){let t=this.variantCache.get(e);return t||(t=new et({parentAsset:this,processTypeUrlPath:e,authProvider:this.authProvider}),this.variantCache.set(e,t)),t}get isVariant(){return!!this.composeOptions}get baseAsset(){return this.isVariant?this.composeOptions.parentAsset.baseAsset:this}get isPresigned(){return!!this.signature}get signature(){return this.baseAsset._signature}setAssetData(e){this._data=e}setStatus(e){this.status=e,e.type!==Xe.Deleting&&e.type!==Xe.Deleted||this.variantCache.forEach(t=>{t.setStatus(e)})}setErrorStatus(e){e instanceof Error?this.setStatus({type:Xe.Error,rawError:e}):"string"==typeof e?this.setStatus({type:Xe.Error,rawError:new Error(e)}):this.setStatus({type:Xe.Error,rawError:new Error("Unknown error")})}setSignature(e){this._signature=e}hasAssetId(){return!(!this.data||!this.data.id)}getAuthHeaders(){return Qe(this,void 0,void 0,(function*(){return new Headers(yield this.authProvider.getAuthHeaders())}))}}Ze([Oe.d],et.prototype,"status",void 0),Ze([Oe.d],et.prototype,"_data",void 0),Ze([Oe.d],et.prototype,"_signature",void 0),Ze([Oe.b],et.prototype,"data",null),Ze([Oe.b],et.prototype,"isVariant",null),Ze([Oe.b],et.prototype,"baseAsset",null),Ze([Oe.b],et.prototype,"isPresigned",null),Ze([Oe.b],et.prototype,"signature",null),Ze([Oe.a.bound],et.prototype,"setAssetData",null),Ze([Oe.a.bound],et.prototype,"setStatus",null),Ze([Oe.a.bound],et.prototype,"setErrorStatus",null),Ze([Oe.a.bound],et.prototype,"setSignature",null);const tt=(e,t)=>new CustomEvent(e,t),rt=class extends EventTarget{};var nt;!function(e){e.Start="assetUploadStart",e.Success="assetUploadSuccess",e.Error="assetUploadError"}(nt||(nt={}));var it=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},ot=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},at=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};class st extends rt{constructor({authProvider:e,tenant:t}){super(),Object.defineProperty(this,"authProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tenant",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"previousFetchParams",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_assets",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_fetchStatus",{enumerable:!0,configurable:!0,writable:!0,value:{type:Ie.Idle}}),Object.defineProperty(this,"fetchAssetsAbortController",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object(Oe.c)(this),this.tenant=t,this.authProvider=e}get assets(){return this._assets.filter(e=>e.status.type!==Xe.Deleted)}get fetchStatus(){return this._fetchStatus}fetchAssets(e={}){var t,{signal:r,limit:n=20}=e,i=at(e,["signal","limit"]);return ot(this,void 0,void 0,(function*(){null===(t=this.fetchAssetsAbortController)||void 0===t||t.abort(),this.setAssets([]);const e=yield this._fetchAssets(Object.assign({signal:r,limit:n},i));this.setAssets(e)}))}get canFetchMore(){var e;return!!(null===(e=this.previousFetchParams)||void 0===e?void 0:e.offset)}fetchMore({signal:e,limit:t}={}){var r;return ot(this,void 0,void 0,(function*(){if(this.canFetchMore){const n=null!=t?t:null===(r=this.previousFetchParams)||void 0===r?void 0:r.limit,i=yield this._fetchAssets(Object.assign(Object.assign({},this.previousFetchParams),{limit:n,signal:e}));this.appendAssets(...i)}}))}upload(e){var{signal:t}=e,r=at(e,["signal"]);return ot(this,void 0,void 0,(function*(){let e;return e=function(e){return"file"in e}(r)?et.fromFile(Object.assign(Object.assign({tenant:this.tenant},r),{authProvider:this.authProvider})):et.fromUri(Object.assign(Object.assign({tenant:this.tenant},r),{authProvider:this.authProvider})),this.prependAssets(e),this.dispatchEvent(tt(nt.Start,{detail:e})),yield e.prepare({signal:t}),e.status.type===Xe.Error?this.dispatchEvent(tt(nt.Error,{detail:e})):e.status.type===Xe.Prepared&&this.dispatchEvent(tt(nt.Success,{detail:e})),e}))}_fetchAssets(e={}){var t,r,n,{signal:i,limit:o=20}=e,a=at(e,["signal","limit"]);return ot(this,void 0,void 0,(function*(){const e=new AbortController;this.fetchAssetsAbortController=e;const s=new Ye([i,e.signal]);this.setFetchStatus({type:Ie.Fetching});try{const e=new Headers(yield this.authProvider.getAuthHeaders()),i=Object.assign(Object.assign({},"number"==typeof(u=o)&&!Number.isNaN(u)&&{limit:o}),a),{data:l}=yield Be({queryParams:Object.assign({tenant:this.tenant},i)},{signal:s.signal,headers:e});return this.setPreviousFetchParams(Object.assign(Object.assign({},i),{offset:l.offset})),this.setFetchStatus({type:Ie.Idle}),null!==(n=null===(r=null===(t=l._embedded)||void 0===t?void 0:t.item)||void 0===r?void 0:r.map(e=>et.fromData({assetData:e,authProvider:this.authProvider})))&&void 0!==n?n:[]}catch(l){We(l)?!(null==e?void 0:e.signal.aborted)&&(null==i?void 0:i.aborted)&&this.setFetchStatus({type:Ie.Idle}):this.setFetchStatus({type:Ie.Error,rawError:l})}var u;return[]}))}prependAssets(...e){this._assets.unshift(...e)}appendAssets(...e){this._assets.push(...e)}setAssets(e){this._assets=e}setFetchStatus(e){this._fetchStatus=e}setPreviousFetchParams(e){this.previousFetchParams=e}}it([Oe.d],st.prototype,"previousFetchParams",void 0),it([Oe.d],st.prototype,"_assets",void 0),it([Oe.d],st.prototype,"_fetchStatus",void 0),it([Oe.b],st.prototype,"assets",null),it([Oe.b],st.prototype,"fetchStatus",null),it([Oe.a.bound],st.prototype,"fetchAssets",null),it([Oe.b],st.prototype,"canFetchMore",null),it([Oe.a.bound],st.prototype,"fetchMore",null),it([Oe.a.bound],st.prototype,"prependAssets",null),it([Oe.a.bound],st.prototype,"appendAssets",null),it([Oe.a.bound],st.prototype,"setAssets",null),it([Oe.a.bound],st.prototype,"setFetchStatus",null),it([Oe.a.bound],st.prototype,"setPreviousFetchParams",null);var ut=r("7tGJ"),lt=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};var ct=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},dt=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};class pt{constructor(e,t,r,n){Object.defineProperty(this,"assetType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:{type:Xe.Unprepared}}),Object.defineProperty(this,"_signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"authProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.authProvider=r,this.assetType=t,this._data=e,this._signature=n,Object(Oe.c)(this)}get data(){return this._data}get print(){return new pt(this._data,be.Print,this.authProvider,this._signature)}get webPreview(){return new pt(this._data,be.WebPreview,this.authProvider,this._signature)}get thumb(){return new pt(this._data,be.Thumb,this.authProvider,this._signature)}get isPresigned(){return!this.isDamAsset()||void 0!==this.signature&&""!==this.signature}get signature(){return this._signature}setSignature(e){this._signature=e}setStatus(e){this.status=e}setErrorStatus(e){e instanceof Error?this.setStatus({type:Xe.Error,rawError:e}):"string"==typeof e?this.setStatus({type:Xe.Error,rawError:new Error(e)}):this.setStatus({type:Xe.Error,rawError:new Error("Unknown error")})}prepare(){return dt(this,void 0,void 0,(function*(){return this.setStatus({type:Xe.Prepared}),Promise.resolve()}))}presign(){return dt(this,void 0,void 0,(function*(){if(this.isDamAsset()||(this.setSignature("abc"),yield this.prepare()),this.signature||this.status.type===Xe.Deleted||this.status.type===Xe.Deleting)return Promise.resolve();let e;try{const t=yield this.authProvider.getAuthHeaders();e=yield function({headers:e,assetId:t,signal:r}){return lt(this,void 0,void 0,(function*(){return(yield ve("".concat("https://api.sherbert.cimpress.io/v2/assets","/").concat(t,":presign"),{method:"POST",headers:e,signal:r}).catch(e=>{throw new Error("Failed to presign asset: ".concat(e.message))})).signature}))}({assetId:this._data.id,headers:t}),this.setSignature(e),yield this.prepare()}catch(t){throw new Error(ut.AssetErrorMessage.PresignFailed)}if(!e)throw new Error(ut.AssetErrorMessage.EmptySignature)}))}delete({signal:e}={}){return dt(this,void 0,void 0,(function*(){if(this.status.type===Xe.Deleting)return;this.setStatus({type:Xe.Deleting});const t=yield this.authProvider.getAuthHeaders();try{this.isDamAsset()?yield function({headers:e,assetId:t,signal:r}){var n,i;return lt(this,void 0,void 0,(function*(){e["content-type"]="text/plain",e["If-Match"]||e["If-None-Match"]||(e["If-Match"]="*");const o=yield ve("".concat("https://api.sherbert.cimpress.io/v2/assets","/").concat(t),{method:"DELETE",headers:e,signal:r}).catch(e=>{throw new Error("Failed to delete asset: ".concat(e.message))});return null===(i=null===(n=null==o?void 0:o._links)||void 0===n?void 0:n.self)||void 0===i?void 0:i.href}))}({headers:t,assetId:this._data.id,signal:e}):yield function({headers:e,uploadId:t,signal:r}){return me(this,void 0,void 0,(function*(){yield ve("".concat(Ee,"/").concat(t),{method:"DELETE",headers:e,signal:r}).catch(e=>{throw new Error("Failed to delete upload: ".concat(e.message))})}))}({uploadId:this._data.id,headers:t,signal:e}),this.setStatus({type:Xe.Deleted})}catch(r){this.setErrorStatus(r)}}))}getUrl({includeSignature:e=!0}={}){const t=new URL(this.getUrlInternal());switch(this.isDamAsset()&&e&&t.searchParams.set("signature",this.signature?this.signature:""),this.assetType){case be.Original:break;case be.Print:t.pathname=this.isDamAsset()?"".concat(t.pathname,"/print"):t.pathname.replace("original","print");break;case be.WebPreview:t.pathname=this.isDamAsset()?"".concat(t.pathname,"/webPreview"):t.pathname.replace("original","preview").replace("print","preview");break;case be.Thumb:t.pathname=this.isDamAsset()?"".concat(t.pathname,"/thumb"):t.pathname.replace("original","thumb").replace("print","thumb");break;default:throw Error("Unknown asset type --\x3e ".concat(this.assetType))}return t.toString()}getUrlInternal(){var e,t,r,n,i,o;let a="";return(null===(t=null===(e=this._data)||void 0===e?void 0:e.properties)||void 0===t?void 0:t.url)?a=null===(r=this._data)||void 0===r?void 0:r.properties.url:void 0!==(null===(o=null===(i=null===(n=this._data)||void 0===n?void 0:n._links)||void 0===i?void 0:i.self)||void 0===o?void 0:o.href)&&(a=this._data._links.self.href),a}isDamAsset(){return"TNw5PcHBpEi5njASOq7WI"===this._data.tenant||"rtJeJiEgb29ba_Pz74DQP"===this._data.tenant}}ct([Oe.d],pt.prototype,"_data",void 0),ct([Oe.d],pt.prototype,"status",void 0),ct([Oe.d],pt.prototype,"_signature",void 0),ct([Oe.b],pt.prototype,"data",null),ct([Oe.b],pt.prototype,"print",null),ct([Oe.b],pt.prototype,"webPreview",null),ct([Oe.b],pt.prototype,"thumb",null),ct([Oe.b],pt.prototype,"isPresigned",null),ct([Oe.b],pt.prototype,"signature",null),ct([Oe.a.bound],pt.prototype,"setSignature",null),ct([Oe.a.bound],pt.prototype,"setStatus",null);var ft=r("7Cbv"),ht=function(){var e=window&&window.location&&window.location.hostname;if(!e||0===e.length)throw new Error("Hostname could not be determined for the current document.");return e},gt=function(){var e=window&&window.document;if(!e)throw new Error("DOM document could not be determined.");return e},vt=function(e,t,r,n){var i=r.toUTCString();gt().cookie=e+"="+t+";expires="+i+";path=/;domain="+n},mt=function(){var e,t,r,n=ht().split("."),i=new Date;i.setTime(i.getTime()+5e3);for(var o=n.length-1;o>=0;o-=1){var a=n.slice(o).join(".");if(vt("top_level_domain_resolution","1",i,a),gt().cookie.indexOf("top_level_domain_resolution")>-1)return e="top_level_domain_resolution",t=a,r=void 0,r=new Date(1970),vt(e,"",r,t),a}return null},Et=r("Baia");function yt(){return(yt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var bt=e=>{var t=JSON.stringify(e);return window.btoa(t)},It=()=>{var e=document.cookie.split(";").find(e=>e.trim().startsWith("ftContext"));if(e){var t=(e=>{if(e)try{return JSON.parse(window.atob(e))}catch(t){console.error("Error decoding context",t)}})(e=e.split("=")[1].trim());return t?t.attributes&&t.attributes.culture?e:(t.attributes=yt({},t.attributes,{culture:Object(Et.getCurrentCulture)()}),bt(t)):_t()}return _t()},_t=()=>{var e=bt({userId:Object(ft.a)(),attributes:{culture:Object(Et.getCurrentCulture)()}});return document.cookie="ftContext="+e+"; Path=/"+("localhost"===location.hostname?"":"; domain="+function(){var e=mt();if(e&&"localhost"!==e)return new RegExp(/^[0-9.]+$/).test(e)?e:"."+e}()),e},Ot=r("FPpc"),wt=r("X7RD");function Tt(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(l){return void r(l)}s.done?t(u):Promise.resolve(u).then(n,i)}function Nt(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Tt(o,n,i,a,s,"next",e)}function s(e){Tt(o,n,i,a,s,"throw",e)}a(void 0)}))}}var Rt=e=>{var t=e.getOptimizelyConfig();t&&t.sdkKey&&localStorage.setItem("optimizelyDataFile-"+t.sdkKey,JSON.stringify({timeStamp:(new Date).getTime(),dataFile:t.getDatafile()}))};class At{constructor(e,t){if(this.isFeatureEnabled=e=>{var t=this.getDecodedFeatureContext();return this.coreFeaturesClient.isFeatureEnabled(e,t)},this.getEnabledFeatures=()=>{var e=this.getDecodedFeatureContext();return this.coreFeaturesClient.getEnabledFeatures(e)},!e||!e.optimizelyClient)throw new Error("Invalid optimizely client given");this.coreFeaturesClient=e,this.logger=t}getDecodedFeatureContext(){try{return e=It(),JSON.parse(window.atob(e))}catch(t){return void this.logger.error("Could not get context from cookie. Generating a new one",t)}var e}}At.getFeaturesClient=function(){var e=Nt((function*(e,t){var r=Ot.b.getLogger("0.9.21","ft-reader-browser",e),n=((e,t)=>{try{var r=JSON.parse(localStorage.getItem("optimizelyDataFile-"+t)||"{}");if(r&&r.timeStamp&&(new Date).getTime()-r.timeStamp<3e5&&r.dataFile)return r.dataFile}catch(n){e.error("Error getting datafile from localStorage",n)}})(r,t),i=yield Ot.a.getFeaturesClient(r,t,n);return i.optimizelyClient.notificationCenter.addNotificationListener(wt.enums.NOTIFICATION_TYPES.OPTIMIZELY_CONFIG_UPDATE,()=>{Rt(i.optimizelyClient)}),n||Rt(i.optimizelyClient),new At(i,r)}));return function(t,r){return e.apply(this,arguments)}}();var St,Ct,Dt=At,Lt=function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},Ut=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},Pt=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}},xt=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};!function(e){e.VistaPrint="VistaPrint",e.VistaCreate="VistaCreate",e.Vista99D="99Designs"}(St||(St={})),function(e){e.Vista="TNw5PcHBpEi5njASOq7WI",e.VistaNonProd="rtJeJiEgb29ba_Pz74DQP"}(Ct||(Ct={}));class kt{constructor({authProvider:e,subBrand:t,experience:r,tenant:n}){Object.defineProperty(this,"authProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tenant",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useDamRead",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"useDamWrite",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"featureFlagChecked",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"assetStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"subBrand",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"experience",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"offset",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_assets",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_fetchStatus",{enumerable:!0,configurable:!0,writable:!0,value:{type:Ie.Idle}}),Object(Oe.c)(this),this.authProvider=e,this.subBrand=t,this.experience=r,this.tenant=n,this.assetStore=new st({authProvider:this.authProvider,tenant:this.tenant})}get assets(){return this._assets}get fetchStatus(){return this.useDamRead?this.assetStore.fetchStatus:this._fetchStatus}get canFetchMore(){return!!this.offset}setup(){return Ut(this,void 0,void 0,(function*(){this.featureFlagChecked||(yield Dt.getFeaturesClient("vista-assets-sdk").then(e=>{this.useDamRead=e.isFeatureEnabled("vista_assets_sdk_use_sherbert_read"),this.useDamWrite=e.isFeatureEnabled("vista_assets_sdk_use_sherbert_write"),this.featureFlagChecked=!0}))}))}fetchAssets(e={}){var t,r,n,i,o,a,{signal:s,limit:u=20,presign:l=!0}=e,c=xt(e,["signal","limit","presign"]);return Ut(this,void 0,void 0,(function*(){if(yield this.setup(),this.useDamRead){yield this.assetStore.fetchAssets({limit:u});const e=this.assetStore.assets.map(e=>new pt(e.data,be.Original,this.authProvider));if(this.setAssets(e),l)try{for(t=Pt(this.assets);!(r=yield t.next()).done;){const e=r.value;yield e.presign()}}catch(f){n={error:f}}finally{try{r&&!r.done&&(i=t.return)&&(yield i.call(t))}finally{if(n)throw n.error}}return e}this.setAssets([]),this.setFetchStatus({type:Ie.Fetching});const e=yield this._fetchAssets(Object.assign({signal:s,limit:u},c));if(l)try{for(var d,p=Pt(e);!(d=yield p.next()).done;){const e=d.value;yield e.presign()}}catch(h){o={error:h}}finally{try{d&&!d.done&&(a=p.return)&&(yield a.call(p))}finally{if(o)throw o.error}}return this.setAssets(e),e}))}setAssets(e){this._assets=e}setFetchStatus(e){this._fetchStatus=e}prependAssets(e){this._assets.unshift(e)}_fetchAssets(e={}){var{signal:t,limit:r=20}=e;xt(e,["signal","limit"]);return Ut(this,void 0,void 0,(function*(){try{const e=yield this.authProvider.getAuthHeaders(),r=yield function({headers:e,owner:t,tenant:r,includeHidden:n,signal:i}){return me(this,void 0,void 0,(function*(){const o={};t&&(o.owner=t),n&&(o.includeHidden="".concat(n)),o.tenant=r;return yield ve("https://uploads.design.vpsvc.com/api/v2/assets",{method:"GET",headers:e,query:o,signal:i}).catch(e=>{throw new Error("Failed to fetch uploads: ".concat(e.message))})}))}({headers:e,tenant:this.tenant,signal:t}),n=r._embedded.item.filter(e=>{var t,r,n,i;return/preview/i.test(e.properties.availableVariants)||((null===(r=null===(t=null==e?void 0:e._links)||void 0===t?void 0:t.links)||void 0===r?void 0:r._webPreview)?null===(i=null===(n=null==e?void 0:e._links)||void 0===n?void 0:n.links)||void 0===i?void 0:i._webPreview[0].href:void 0)}).map(e=>this.assetFromUpload(e));return this.offset=r.offset,this.setAssets(n),this.setFetchStatus({type:Ie.Idle}),n}catch(e){return"AbortError"===(null==e?void 0:e.name)&&this.setFetchStatus({type:Ie.Idle}),this.setFetchStatus({type:Ie.Error,rawError:e}),[]}}))}upload(e){return Ut(this,void 0,void 0,(function*(){let t;if(yield this.setup(),e.properties||(e.properties={}),e.properties.subBrand=this.subBrand,e.properties.experience=this.experience,"file"in e){if(this.useDamWrite)return yield this.assetStore.upload(e);t=yield this.assetFromFile(e)}if("uri"in e){if(this.useDamWrite)return yield this.assetStore.upload(e);t=yield this.assetFromUri(e)}if(t)return this.prependAssets(t),t;throw new Error("Something went wrong while uploading the asset. Please try again.")}))}assetFromFile(e){var{signal:t}=e,r=xt(e,["signal"]);return Ut(this,void 0,void 0,(function*(){const e=yield this.authProvider.getAuthHeaders(),n=yield ye({headers:e,process:r.type,signal:t}),i=new FormData;i.append("file",r.file);try{const o=yield function({method:e,url:t,headers:r,body:n,onProgress:i,signal:o}){return _e(this,void 0,void 0,(function*(){return new Promise((a,s)=>{if(o&&o.aborted)return void s(new Error("request aborted!"));const u=new XMLHttpRequest;u.open(e.toUpperCase(),t.toString(),!0),i&&"function"==typeof i&&u.upload.addEventListener("progress",e=>i(Math.round(100*e.loaded/e.total)),{signal:o}),o&&o.addEventListener("abort",(function(){u.abort()}),{once:!0}),Object.entries(r).forEach(([e,t])=>u.setRequestHeader(e,t)),u.onload=()=>a(u),u.onabort=()=>s(new Error("request aborted!")),u.onerror=()=>s(u.statusText),u.send(n)})}))}({method:"POST",url:n,headers:e,body:i,onProgress:r.onProgress,signal:t});if(o.status>=200&&o.status<300){const e=JSON.parse(o.responseText)[0];return this.mapLegacyUploadToSherbertFormat(e)}return Promise.reject(o.statusText)}catch(o){return Promise.reject(new Error("Failed to upload from File"))}}))}assetFromUri(e){var{signal:t}=e,r=xt(e,["signal"]);return Ut(this,void 0,void 0,(function*(){const e=yield this.authProvider.getAuthHeaders(),n=yield ye({headers:e,process:r.type,url:r.uri,signal:t}),i=(yield ve(n,{method:"POST",headers:e,signal:t}).catch(e=>{throw new Error("Failed to create asset from Uri: ".concat(e.message))}))[0];return this.mapLegacyUploadToSherbertFormat(i)}))}assetFromUpload(e){var t,r,n,i,o,a,s,u;return new pt({id:e.id,type:e.type,account:e.account,tenant:e.tenant,createdMs:e.createdMs,createdBy:"",modifiedMs:0,modifiedBy:"",hash:e.hash,expiresOn:e.expiresOn,properties:e.properties,info:{asset:{sourceUri:e.sourceUri,folder:e.folder,expires:e.expires,folderId:e.folderId},storage:{location:null===(t=null==e?void 0:e.info)||void 0===t?void 0:t.storage.location,fileName:null===(r=null==e?void 0:e.info)||void 0===r?void 0:r.storage.fileName,fileSizeBytes:null===(n=null==e?void 0:e.info)||void 0===n?void 0:n.storage.fileSizeBytes,contentType:null===(i=null==e?void 0:e.info)||void 0===i?void 0:i.storage.contentType,contentEncoding:null===(o=null==e?void 0:e.info)||void 0===o?void 0:o.storage.contentEncoding,contentDisposition:null===(a=null==e?void 0:e.info)||void 0===a?void 0:a.storage.contentDisposition,provider:null===(s=null==e?void 0:e.info)||void 0===s?void 0:s.storage.provider},image:null===(u=null==e?void 0:e.info)||void 0===u?void 0:u.image},tags:e.tags,_links:e._links},be.Original,this.authProvider)}mapLegacyUploadToSherbertFormat(e){var t,r;const n=e.UploadId||e.uploadId,i=new pt({id:n,type:"image",account:e.tenant,tenant:e.tenant,createdBy:e.owner,modifiedBy:e.owner,createdMs:new Date(e.processingTimeStart).getTime(),modifiedMs:new Date(e.lastModifiedTime).getTime(),hash:"",expiresOn:"never"===e.deleteAfterDays?"never":new Date(e.lastModifiedTime)+e.deleteAfterDays,version:1,info:{storage:{location:n.split("~")[1],fileName:e.uploadedFileName,fileSizeBytes:e.originalFileSize,contentType:e.originalFileContentType,contentEncoding:"",contentDisposition:"",provider:{type:"AWS"}},image:{format:e.originalFileContentType.split("/")[1]}},properties:Object.assign(Object.assign({},e),{subBrand:"VistaPrint"}),tags:[""],_links:{self:{href:"https://uploads.documents.cimpress.io/v1/uploads/".concat(n,"/original?tenant=designtechprod")},links:{_thumb:[{href:"https://uploads.documents.cimpress.io/v1/uploads/".concat(n,"/thumb?tenant=designtechprod")}],_webPreview:[{href:e.previewUrl||null}],_print:[{href:"https://uploads.documents.cimpress.io/v1/uploads/".concat(n,"/print?tenant=designtechprod")}]}}},be.Original,this.authProvider),o=e.originalFileContentType.split("/")[1];return(null===(r=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.info)||void 0===r?void 0:r.image)&&(i.data.info.image[o]={width:e.originalFileWidth,height:e.originalFileHeight}),i}}Lt([Oe.d],kt.prototype,"_assets",void 0),Lt([Oe.d],kt.prototype,"_fetchStatus",void 0),Lt([Oe.b],kt.prototype,"assets",null),Lt([Oe.b],kt.prototype,"fetchStatus",null),Lt([Oe.b],kt.prototype,"canFetchMore",null),Lt([Oe.a.bound],kt.prototype,"fetchAssets",null),Lt([Oe.a.bound],kt.prototype,"setAssets",null),Lt([Oe.a.bound],kt.prototype,"setFetchStatus",null),Lt([Oe.a.bound],kt.prototype,"prependAssets",null);r("EM67");const Ft=({contentId:e,trackingStep:t})=>{var r,n,o,a;const[s,u]=i.useState(""),l=i.useRef(null),{state:c,dispatch:d}=Object(F.c)(),{onboarding:p}=X(),{selectionsState:f,selectionsDispatch:h}=Object(M.c)(),{onboardingUploadState:g,onboardingUploadDispatch:v}=Object(W.c)(),{identity:m}=Object(j.a)(),[E,y]=i.useState(null==p||null===(r=p[e])||void 0===r?void 0:r.selectedIndustry),[b,I]=i.useState(null==p||null===(n=p[e])||void 0===n?void 0:n.selectedBusinessName),[_,O]=i.useState(null==p||null===(o=p[e])||void 0===o?void 0:o.uploadedLogo),[w,T]=i.useState(),R=Object(L.a)({locale:c.locale,contentId:e});i.useEffect(()=>{var t;d({type:F.a.SetStepCompleted,payload:{step:c.activeStep,completed:(t=[null==E?void 0:E.level3_id,b],t.every(e=>!!e&&""!==e.trim()))}}),f.selections&&h({type:M.a.SetBusinessSelections,payload:{contentId:e,selectedIndustry:E,selectedBusinessName:b,uploadedLogo:_}});T(_?"Image Uploaded":void 0)},[E,b,_]),i.useEffect(()=>{if(!E&&!b&&f.selections&&f.selections[e]){const t=f.selections[e];y(t.selectedIndustry),I(t.selectedBusinessName),t.uploadedLogo&&O(t.uploadedLogo)}},[f.selections]);return i.createElement(i.Fragment,null,i.createElement(N.FlexBox,{justifyContent:"space-between"},i.createElement(N.GridContainer,null,i.createElement(N.Row,null,i.createElement(N.Column,{span:12,spanSm:6,spanMd:6,spanLg:6},i.createElement(N.FlexBox,{flexDirection:"column",className:"business-attributes-column"},i.createElement(N.ModalDialogHeader,null,i.createElement(N.ModalDialogTitle,null,i.createElement(N.Typography,{as:"h3"},R.title)),i.createElement(N.Typography,{className:"header-subtitle"},R.subTitle)),i.createElement(N.ModalDialogBody,null,i.createElement(N.StandardForm,null,i.createElement(N.FormField,{mt:7},i.createElement(N.FormLabel,{className:"onboarding-form-label onboarding-form-label--hug-input"},R.copies.industry),i.createElement(N.FormInputGroup,null,i.createElement(ge,{options:null==c||null===(a=c.taxonomyIndustry)||void 0===a?void 0:a.industries,placeholderText:"Search for an industry",selectedIndustry:null==E?void 0:E.level3_label,onChange:e=>{const t=e.target.value,r=k.a.sanitize(t),n=c.taxonomyIndustry.industries.find(e=>e.level3_id.toLowerCase()===r.toLowerCase());y(n),u(r)},onSelect:e=>{const t=k.a.sanitize(e.toLowerCase()),r=c.taxonomyIndustry.industries.find(e=>e.level3_label.toLowerCase()===t);y(r)},term:s}))),i.createElement(N.FormField,{mt:7},i.createElement(N.FormLabel,{className:"onboarding-form-label onboarding-form-label--hug-input"},R.copies.businessName),i.createElement(N.FormInputGroup,null,i.createElement(N.TextInputWithFloatingLabel,null,i.createElement(N.TextInput,{value:b,onChange:e=>{const t=k.a.sanitize(e.target.value);I(t)}})))),i.createElement(N.FormField,{mt:7},i.createElement(N.FormLabel,{className:"onboarding-form-label"},R.copies.logo),i.createElement(N.FormInputGroup,null,_?i.createElement(N.Card,{bordered:!0,backgroundColor:"light-grey",className:"business-attributes-modal-card-container business-attributes-modal-card-container--with-logo"},i.createElement(N.FlexBox,{justifyContent:"center",alignItems:"flex-end",flexWrap:"wrap",flexDirection:"column",className:"business-attributes-modal-card-container--inner"},i.createElement(N.TextButton,{className:"business-attributes-modal-close-button",buttonShape:"round",sizeVariant:"mini",backgroundColor:"black",onClick:()=>{v({type:W.a.SetLoading,payload:!1}),O(void 0)}},i.createElement(N.ControlIcon,{iconType:"close",skin:"white"}))),i.createElement(N.FlexBox,{className:"logo-container",justifyContent:"center",alignItems:"center",flexWrap:"wrap",flexDirection:"column"},i.createElement(N.ResponsiveImage,{width:200,src:_.previewUrl,className:"logo"}))):i.createElement(N.Card,{bordered:!0,backgroundColor:"light-grey",onClick:()=>{var e;return null===(e=l.current)||void 0===e?void 0:e.click()},className:"business-attributes-modal-card-container--upload-logo",component:N.FlexBox},i.createElement(N.FlexBox,{className:"logo",justifyContent:"center",alignItems:"center",flexWrap:"wrap",flexDirection:"column"},i.createElement(Q,null),i.createElement(N.Typography,null,R.copies.logoUpload),i.createElement("input",{type:"file",ref:l,className:"upload-input",onChange:async e=>{var t,r;v({type:W.a.SetLoading,payload:!0});const n=e.target;if(null===(t=n.files)||void 0===t||!t.length)return O(void 0),void v({type:W.a.SetError});const i=n.files[0],o=await async function({authToken:e,file:t}){const r=new kt({authProvider:{getAuthHeaders:async()=>({Authorization:"Bearer "+e})},subBrand:St.VistaPrint,experience:"Home Page",tenant:Ct.Vista});return await r.upload({file:t})}({authToken:m.accessToken,file:i});let a;o.data&&(a={uploadId:o.data.id,printUrl:o.print.getUrl(),previewUrl:o.webPreview.getUrl(),originalSourceUrl:o.getUrl(),width:parseInt(o.data.properties.originalPixelWidth),height:parseInt(o.data.properties.originalPixelHeight)}),null!==(r=a)&&void 0!==r&&r.uploadId?(O(a),v({type:W.a.SetLoading,payload:!1})):(O(void 0),v({type:W.a.SetError}))},multiple:!1,accept:".png,.jpg,.jpeg",disabled:!!g.loading}))))))))),i.createElement(N.Column,{span:12,spanSm:6,spanMd:6,spanLg:6},i.createElement(H,{scenes:R.scenes,logo:_}))))),i.createElement(z,{completedSteps:c.completedSteps,activeStep:c.activeStep,tracking:{step:t,eventDetail:w}}))};const Mt=({contentId:e,trackingStep:t})=>{const{state:r,dispatch:n}=Object(F.c)(),{onboarding:o}=X(),{selectionsState:a,selectionsDispatch:s}=Object(M.c)(),[u,l]=i.useState(null==o?void 0:o[e]),[c,d]=i.useState(),p=Object(L.a)({locale:r.locale,contentId:e}),f=e=>Boolean(e)&&Object.values(e).some(e=>1==e),h=e=>Boolean(e[V.b.business]);return i.useEffect(()=>{if(u){n({type:F.a.SetStepCompleted,payload:{step:r.activeStep,completed:f(u)}}),e===V.h&&n({type:F.a.SetBusinessFlow,payload:{businessFlow:h(u)}}),s({type:M.a.SetSelections,payload:{contentId:e,selectedValues:u}});const t=Object.keys(u).filter(e=>u[e]).join(";");d(t)}},[u]),i.useEffect(()=>{!u&&a.selections&&a.selections[e]&&l(a.selections[e])},[e,u,a,a.selections]),i.createElement(N.FlexBox,{className:"flex-dialog",flexDirection:"column"},i.createElement(N.ModalDialogHeader,null,i.createElement(N.ModalDialogTitle,{align:"center",marginTop:8},i.createElement(N.Typography,{as:"h3"},p.title)),i.createElement(N.Typography,{align:"center",className:"header-subtitle"},p.subTitle)),i.createElement(N.ModalDialogBody,{style:{minHeight:200}},i.createElement(N.Box,null,i.createElement(N.SelectionSet,{skin:"tiles-vertical",variant:"multi-select",selectedValues:u,onSelectedValuesChange:e=>l(e)},i.createElement(N.FlexBox,{justifyContent:"center",alignItems:"center",flexWrap:"wrap"},null==p?void 0:p.cards.map(e=>i.createElement(N.SelectionSetInput,{value:e.key,key:e.key},i.createElement(N.SelectionSetLabel,null,i.createElement(N.StandardTile,null,i.createElement(N.StandardTileImage,null,i.createElement(N.BasicResponsiveImage,{aspectRatio:1,src:e.image,alt:"placeholder"})),i.createElement(N.StandardTileContents,null,i.createElement(N.StandardTileName,null,e.heading),i.createElement(N.StandardTileDescription,null,e.description)))))))))),i.createElement(z,{completedSteps:r.completedSteps,activeStep:r.activeStep,tracking:{step:t,eventDetail:c}}))},jt=({steps:e,activeStep:t})=>{const{state:r,dispatch:n}=Object(F.c)();return i.useEffect(()=>{n({type:F.a.SetSteps,payload:e})},[n,e]),i.useEffect(()=>{if(r.quizOpen){const r=e[t].trackingStep,n=Object(R.o)({step:r});Object(S.b)(n)}},[t,e,r.quizOpen]),i.createElement(i.Fragment,null,e[t].component)};r("PrxY");const Vt=({contentId:e})=>{const{state:t}=Object(F.c)(),r=Object(L.a)({locale:t.locale,contentId:e});return i.createElement(N.FlexBox,{className:"flex-dialog",flexDirection:"column"},i.createElement(N.ModalDialogHeader,null,i.createElement(N.ModalDialogTitle,{align:"center",marginTop:8},i.createElement(N.Typography,{as:"h3"},r.title))),i.createElement(N.ModalDialogBody,{style:{minHeight:200}},i.createElement(N.Box,null,i.createElement(N.BasicPreloader,{visuallyHiddenLabel:"Loading...",sizeVariant:"standard",centered:!0}))))},Bt=[{component:i.createElement(Mt,{contentId:V.h,key:V.h,trackingStep:C.e.Step1}),trackingStep:C.e.Step1},{component:i.createElement(Ft,{contentId:V.a,trackingStep:C.e.Step2}),isBusinessFlow:!0,trackingStep:C.e.Step2},{component:i.createElement(Mt,{contentId:V.c,key:V.c,trackingStep:C.e.Step3}),trackingStep:C.e.Step3}],Gt=Bt.filter(e=>!e.isBusinessFlow),Kt=({isQuizOpen:e,handleToggleQuiz:t})=>{const{state:r,dispatch:n}=Object(F.c)(),{isLoading:o,error:a}=r,s=Object(i.useRef)();Object(i.useEffect)(()=>{s.current&&(s.current.scrollTop=0)},[s,r.activeStep]);return i.createElement(i.Fragment,null,i.createElement(N.ModalDialog,{isOpen:e,onRequestDismiss:()=>{const e=(r.businessFlow?Bt:Gt)[r.activeStep].trackingStep,n=Object(R.n)({step:e});Object(S.b)(n),t()},className:"onboarding-modal-dialog"},i.createElement(N.ModalDialogContent,{ref:s,className:"onboarding-modal-dialog-content"},i.createElement(N.ModalDialogNav,null,i.createElement(N.ModalDialogCloseButton,{visuallyHiddenLabel:Object(L.a)({locale:r.locale,contentId:"closeButtonCopy"})})),a&&i.createElement(N.AlertBox,{skin:"error",onRequestDismiss:()=>{n({type:F.a.SetError,payload:void 0})}},a,i.createElement(N.AlertBoxDismissButton,{visuallyHiddenLabel:Object(L.a)({locale:r.locale,contentId:"dismissErrorCopy"})})),!o&&i.createElement(jt,{activeStep:r.activeStep,steps:r.businessFlow?Bt:Gt}),o&&i.createElement(Vt,{contentId:V.d}))))};var zt=r("314J"),Ht=r("KQm4");async function qt({brandProfileLibrary:e,onboarding:t}){var r,n,i;const o=(null==t?void 0:t[V.a])||{},a=o.selectedBusinessName,s=await e.getBrands(),u=a.replace(/\s{2,}/," ").toLowerCase(),l=s.find(e=>{var t;return u===(null===(t=e.displayName)||void 0===t?void 0:t.toLowerCase())});if(!(Object.keys(o).length>0))return;const c=o.selectedIndustry,d=o.uploadedLogo,p=d&&function(e){const{printUrl:t,previewUrl:r,originalSourceUrl:n}=e;if(!t||!r||!n)throw Error("Missing uploaded logo URLs");return{uds:{printUrl:t,previewUrl:r,originalSourceUrl:n}}}(d),f=null!==(r=null==l||null===(n=l.facts)||void 0===n||null===(i=n.designIdentity)||void 0===i?void 0:i.logos)&&void 0!==r?r:[],h=Object.assign({},Boolean(l)&&l,!l&&{displayName:a},{facts:Object.assign({profile:Object.assign({},!l&&{companyName:a},{industryId:{industryL1Id:c.level1_id,industryL2Id:c.level2_id,industryL3Id:c.level3_id}})},p&&{designIdentity:{logos:[p].concat(Object(Ht.a)(f))}})});try{const{brandId:t}=l?await e.updateBrand(h.brandId,h):await e.createBrand(h);await e.setActiveBrandId(t)}catch(g){throw console.error("Error updating brand data",g),g}}const Yt=()=>{X();const{state:e,dispatch:t}=Object(F.c)(),r=()=>t({type:F.a.ToggleQuiz}),a=Object(zt.a)(),{selectionsState:s}=Object(M.c)(),{isIdentityInitialized:u,identity:l,isCustomer:c}=Object(j.a)(),d=Object(i.useCallback)(async e=>{const t=function(e){const t=null==e?void 0:e[V.h];if(!t)throw Error("Segmentation is not selected. The value should be either "+V.b.business+" or "+V.b.consumer);return t}(e),r=null==(i=e)||null===(o=i[V.a])||void 0===o?void 0:o.selectedIndustry;var i,o;const a=function(e){var t;const r=Object.entries(null!==(t=null==e?void 0:e[V.c])&&void 0!==t?t:{});if(!r.length)throw Error("Error creating "+V.b.consumer+" trait. No interests selected.");return r.reduce((e,[t,r])=>r?[].concat(Object(Ht.a)(e),[{name:t}]):e,[])}(e),s=Boolean(t[V.b.business]),u=Boolean(t[V.b.consumer]);let c=V.b.consumer;s&&u?c=V.b.hybrid:s&&(c=V.b.business);const d=Object.assign({},r&&{industry_l1_id:r.level1_id,industry_l2_id:r.level2_id},{master_segment:c,product_interest:a}),{accessToken:p}=l,f=new n.default(p),h=[];h.push(w({accessToken:p,traits:d,requestor:V.g})),s&&e&&h.push(qt({brandProfileLibrary:f,onboarding:e}));if((await Promise.allSettled(h)).some(e=>"rejected"===e.status))throw"Unable to store customer profile";window.localStorage.setItem(V.f,"true"),window.localStorage.removeItem(V.e)},[l]);return Object(i.useEffect)(()=>{if(e.error)return;if(!Wt(u,l,c))return;if(void 0===(null==s?void 0:s.selections))return;const{selections:r}=s,n=Object(zt.b)(),i=Object(zt.a)();n&&t({type:F.a.ShowQuiz}),(n||!i&&e.completed)&&(t({type:F.a.SetLoading,payload:!0}),d(r).then(()=>{setTimeout(()=>{window.location.assign("/gs")},100)},()=>{t({type:F.a.SetLoading,payload:!1}),setTimeout(()=>{t({type:F.a.SetError,payload:Object(L.a)({locale:e.locale,contentId:"errorCopy"})})},100)}))},[u,l,c,e.completed,e.error]),o.a.createElement(o.a.Fragment,null,o.a.createElement(U,{locale:e.locale,onClick:r,quizCompleted:a}),o.a.createElement(Kt,{isQuizOpen:e.quizOpen,handleToggleQuiz:r}))},Wt=(e,t,r)=>e&&t&&t.isSignedIn&&r},WmZe:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LogTierV1EventProcessor=void 0;var a=r("NR54"),s=r("czZh"),u=o(r("LdbH")),l=r("2dzi"),c=r("VGhT"),d=a.getLogger("LogTierV1EventProcessor"),p=function(){function e(e){var t=e.dispatcher,r=e.flushInterval,n=void 0===r?s.DEFAULT_FLUSH_INTERVAL:r,i=e.batchSize,o=void 0===i?s.DEFAULT_BATCH_SIZE:i,a=e.notificationCenter;this.dispatcher=t,this.notificationCenter=a,this.requestTracker=new u.default,n=s.validateAndGetFlushInterval(n),o=s.validateAndGetBatchSize(o),this.queue=s.getQueue(o,n,this.drainQueue.bind(this),l.areEventContextsEqual)}return e.prototype.drainQueue=function(e){var t=this,r=new Promise((function(r){if(d.debug("draining queue with %s events",e.length),0!==e.length){var n=c.formatEvents(e);t.dispatcher.dispatchEvent(n,(function(){r()})),s.sendEventNotification(t.notificationCenter,n)}else r()}));return this.requestTracker.trackRequest(r),r},e.prototype.process=function(e){this.queue.enqueue(e)},e.prototype.stop=function(){try{return this.queue.stop(),this.requestTracker.onRequestsComplete()}catch(e){d.error('Error stopping EventProcessor: "%s"',e.message,e)}return Promise.resolve()},e.prototype.start=function(){return n(this,void 0,void 0,(function(){return i(this,(function(e){return this.queue.start(),[2]}))}))},e}();t.LogTierV1EventProcessor=p},Wqm3:function(e,t,r){const n=r("2n8Z");e.exports={getAttribute:function(){let e=n.getTrackingData();if(e&&void 0!==e.timestamp||(n.initChannelTracking(),e=n.getTrackingData()),e&&e.utm_id)return e.utm_id}}},"X/4o":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.listeners={},this.listenerId=1}return e.prototype.on=function(e,t){var r=this;this.listeners[e]||(this.listeners[e]={});var n=String(this.listenerId);return this.listenerId++,this.listeners[e][n]=t,function(){r.listeners[e]&&delete r.listeners[e][n]}},e.prototype.emit=function(e,t){var r=this.listeners[e];r&&Object.keys(r).forEach((function(e){(0,r[e])(t)}))},e.prototype.removeAllListeners=function(){this.listeners={}},e}();t.default=n},X7RD:function(e,t,r){"use strict";r("E9XD"),Object.defineProperty(t,"__esModule",{value:!0});var n,i=r("NR54"),o=r("syoB"),a=r("VPC1"),s=(n=r("ohnt"))&&"object"==typeof n&&"default"in n?n.default:n,u=r("2bR2"),l=function(){return(l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function c(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}var d={NOTSET:0,DEBUG:1,INFO:2,WARNING:3,ERROR:4},p={CONDITION_EVALUATOR_ERROR:"%s: Error evaluating audience condition of type %s: %s",DATAFILE_AND_SDK_KEY_MISSING:"%s: You must provide at least one of sdkKey or datafile. Cannot start Optimizely",EXPERIMENT_KEY_NOT_IN_DATAFILE:"%s: Experiment key %s is not in datafile.",FEATURE_NOT_IN_DATAFILE:"%s: Feature key %s is not in datafile.",IMPROPERLY_FORMATTED_EXPERIMENT:"%s: Experiment key %s is improperly formatted.",INVALID_ATTRIBUTES:"%s: Provided attributes are in an invalid format.",INVALID_BUCKETING_ID:"%s: Unable to generate hash for bucketing ID %s: %s",INVALID_DATAFILE:"%s: Datafile is invalid - property %s: %s",INVALID_DATAFILE_MALFORMED:"%s: Datafile is invalid because it is malformed.",INVALID_CONFIG:"%s: Provided Optimizely config is in an invalid format.",INVALID_JSON:"%s: JSON object is not valid.",INVALID_ERROR_HANDLER:'%s: Provided "errorHandler" is in an invalid format.',INVALID_EVENT_DISPATCHER:'%s: Provided "eventDispatcher" is in an invalid format.',INVALID_EVENT_TAGS:"%s: Provided event tags are in an invalid format.",INVALID_EXPERIMENT_KEY:"%s: Experiment key %s is not in datafile. It is either invalid, paused, or archived.",INVALID_EXPERIMENT_ID:"%s: Experiment ID %s is not in datafile.",INVALID_GROUP_ID:"%s: Group ID %s is not in datafile.",INVALID_LOGGER:'%s: Provided "logger" is in an invalid format.',INVALID_ROLLOUT_ID:"%s: Invalid rollout ID %s attached to feature %s",INVALID_USER_ID:"%s: Provided user ID is in an invalid format.",INVALID_USER_PROFILE_SERVICE:"%s: Provided user profile service instance is in an invalid format: %s.",NO_DATAFILE_SPECIFIED:"%s: No datafile specified. Cannot start optimizely.",NO_JSON_PROVIDED:"%s: No JSON object to validate against schema.",NO_VARIATION_FOR_EXPERIMENT_KEY:"%s: No variation key %s defined in datafile for experiment %s.",UNDEFINED_ATTRIBUTE:"%s: Provided attribute: %s has an undefined value.",UNRECOGNIZED_ATTRIBUTE:"%s: Unrecognized attribute %s provided. Pruning before sending event to Optimizely.",UNABLE_TO_CAST_VALUE:"%s: Unable to cast value %s to type %s, returning null.",USER_NOT_IN_FORCED_VARIATION:"%s: User %s is not in the forced variation map. Cannot remove their forced variation.",USER_PROFILE_LOOKUP_ERROR:'%s: Error while looking up user profile for user ID "%s": %s.',USER_PROFILE_SAVE_ERROR:'%s: Error while saving user profile for user ID "%s": %s.',VARIABLE_KEY_NOT_IN_DATAFILE:'%s: Variable with key "%s" associated with feature with key "%s" is not in datafile.',VARIATION_ID_NOT_IN_DATAFILE:"%s: No variation ID %s defined in datafile for experiment %s.",VARIATION_ID_NOT_IN_DATAFILE_NO_EXPERIMENT:"%s: Variation ID %s is not in the datafile.",INVALID_INPUT_FORMAT:"%s: Provided %s is in an invalid format.",INVALID_DATAFILE_VERSION:"%s: This version of the JavaScript SDK does not support the given datafile version: %s",INVALID_VARIATION_KEY:"%s: Provided variation key is in an invalid format."},f={ACTIVATE_USER:"%s: Activating user %s in experiment %s.",DISPATCH_CONVERSION_EVENT:"%s: Dispatching conversion event to URL %s with params %s.",DISPATCH_IMPRESSION_EVENT:"%s: Dispatching impression event to URL %s with params %s.",DEPRECATED_EVENT_VALUE:"%s: Event value is deprecated in %s call.",EVENT_KEY_NOT_FOUND:"%s: Event key %s is not in datafile.",EXPERIMENT_NOT_RUNNING:"%s: Experiment %s is not running.",FEATURE_ENABLED_FOR_USER:"%s: Feature %s is enabled for user %s.",FEATURE_NOT_ENABLED_FOR_USER:"%s: Feature %s is not enabled for user %s.",FEATURE_HAS_NO_EXPERIMENTS:"%s: Feature %s is not attached to any experiments.",FAILED_TO_PARSE_VALUE:'%s: Failed to parse event value "%s" from event tags.',FAILED_TO_PARSE_REVENUE:'%s: Failed to parse revenue value "%s" from event tags.',FORCED_BUCKETING_FAILED:"%s: Variation key %s is not in datafile. Not activating user %s.",INVALID_OBJECT:"%s: Optimizely object is not valid. Failing %s.",INVALID_CLIENT_ENGINE:"%s: Invalid client engine passed: %s. Defaulting to node-sdk.",INVALID_DEFAULT_DECIDE_OPTIONS:"%s: Provided default decide options is not an array.",INVALID_DECIDE_OPTIONS:"%s: Provided decide options is not an array. Using default decide options.",INVALID_VARIATION_ID:"%s: Bucketed into an invalid variation ID. Returning null.",NOTIFICATION_LISTENER_EXCEPTION:"%s: Notification listener for (%s) threw exception: %s",NO_ROLLOUT_EXISTS:"%s: There is no rollout of feature %s.",NOT_ACTIVATING_USER:"%s: Not activating user %s for experiment %s.",NOT_TRACKING_USER:"%s: Not tracking user %s.",PARSED_REVENUE_VALUE:'%s: Parsed revenue value "%s" from event tags.',PARSED_NUMERIC_VALUE:'%s: Parsed event value "%s" from event tags.',RETURNING_STORED_VARIATION:'%s: Returning previously activated variation "%s" of experiment "%s" for user "%s" from user profile.',ROLLOUT_HAS_NO_EXPERIMENTS:"%s: Rollout of feature %s has no experiments",SAVED_VARIATION:'%s: Saved variation "%s" of experiment "%s" for user "%s".',SAVED_VARIATION_NOT_FOUND:"%s: User %s was previously bucketed into variation with ID %s for experiment %s, but no matching variation was found.",SHOULD_NOT_DISPATCH_ACTIVATE:'%s: Experiment %s is not in "Running" state. Not activating user.',SKIPPING_JSON_VALIDATION:"%s: Skipping JSON schema validation.",TRACK_EVENT:"%s: Tracking event %s for user %s.",UNRECOGNIZED_DECIDE_OPTION:"%s: Unrecognized decide option %s provided.",USER_ASSIGNED_TO_EXPERIMENT_BUCKET:"%s: Assigned bucket %s to user with bucketing ID %s.",USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP:"%s: User %s is in experiment %s of group %s.",USER_BUCKETED_INTO_TARGETING_RULE:"%s: User %s bucketed into targeting rule %s.",USER_IN_FEATURE_EXPERIMENT:"%s: User %s is in variation %s of experiment %s on the feature %s.",USER_IN_ROLLOUT:"%s: User %s is in rollout of feature %s.",USER_NOT_BUCKETED_INTO_EVERYONE_TARGETING_RULE:"%s: User %s not bucketed into everyone targeting rule due to traffic allocation.",USER_NOT_BUCKETED_INTO_EXPERIMENT_IN_GROUP:"%s: User %s is not in experiment %s of group %s.",USER_NOT_BUCKETED_INTO_ANY_EXPERIMENT_IN_GROUP:"%s: User %s is not in any experiment of group %s.",USER_NOT_BUCKETED_INTO_TARGETING_RULE:"%s User %s not bucketed into targeting rule %s due to traffic allocation. Trying everyone rule.",USER_NOT_IN_FEATURE_EXPERIMENT:"%s: User %s is not in any experiment on the feature %s.",USER_NOT_IN_ROLLOUT:"%s: User %s is not in rollout of feature %s.",USER_FORCED_IN_VARIATION:"%s: User %s is forced in variation %s.",USER_MAPPED_TO_FORCED_VARIATION:"%s: Set variation %s for experiment %s and user %s in the forced variation map.",USER_DOESNT_MEET_CONDITIONS_FOR_TARGETING_RULE:"%s: User %s does not meet conditions for targeting rule %s.",USER_MEETS_CONDITIONS_FOR_TARGETING_RULE:"%s: User %s meets conditions for targeting rule %s.",USER_HAS_VARIATION:"%s: User %s is in variation %s of experiment %s.",USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED:"Variation (%s) is mapped to flag (%s), rule (%s) and user (%s) in the forced decision map.",USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED:"Variation (%s) is mapped to flag (%s) and user (%s) in the forced decision map.",USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED_BUT_INVALID:"Invalid variation is mapped to flag (%s), rule (%s) and user (%s) in the forced decision map.",USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED_BUT_INVALID:"Invalid variation is mapped to flag (%s) and user (%s) in the forced decision map.",USER_HAS_FORCED_VARIATION:"%s: Variation %s is mapped to experiment %s and user %s in the forced variation map.",USER_HAS_NO_VARIATION:"%s: User %s is in no variation of experiment %s.",USER_HAS_NO_FORCED_VARIATION:"%s: User %s is not in the forced variation map.",USER_HAS_NO_FORCED_VARIATION_FOR_EXPERIMENT:"%s: No experiment %s mapped to user %s in the forced variation map.",USER_NOT_IN_ANY_EXPERIMENT:"%s: User %s is not in any experiment of group %s.",USER_NOT_IN_EXPERIMENT:"%s: User %s does not meet conditions to be in experiment %s.",USER_RECEIVED_DEFAULT_VARIABLE_VALUE:'%s: User "%s" is not in any variation or rollout rule. Returning default value for variable "%s" of feature flag "%s".',FEATURE_NOT_ENABLED_RETURN_DEFAULT_VARIABLE_VALUE:'%s: Feature "%s" is not enabled for user %s. Returning the default variable value "%s".',VARIABLE_NOT_USED_RETURN_DEFAULT_VARIABLE_VALUE:'%s: Variable "%s" is not used in variation "%s". Returning default value.',USER_RECEIVED_VARIABLE_VALUE:'%s: Got variable value "%s" for variable "%s" of feature flag "%s"',VALID_DATAFILE:"%s: Datafile is valid.",VALID_USER_PROFILE_SERVICE:"%s: Valid user profile service provided.",VARIATION_REMOVED_FOR_USER:"%s: Variation mapped to experiment %s has been removed for user %s.",VARIABLE_REQUESTED_WITH_WRONG_TYPE:'%s: Requested variable type "%s", but variable is of type "%s". Use correct API to retrieve value. Returning None.',VALID_BUCKETING_ID:'%s: BucketingId is valid: "%s"',BUCKETING_ID_NOT_STRING:"%s: BucketingID attribute is not a string. Defaulted to userId",EVALUATING_AUDIENCE:'%s: Starting to evaluate audience "%s" with conditions: %s.',EVALUATING_AUDIENCES_COMBINED:'%s: Evaluating audiences for %s "%s": %s.',AUDIENCE_EVALUATION_RESULT:'%s: Audience "%s" evaluated to %s.',AUDIENCE_EVALUATION_RESULT_COMBINED:"%s: Audiences for %s %s collectively evaluated to %s.",MISSING_ATTRIBUTE_VALUE:'%s: Audience condition %s evaluated to UNKNOWN because no value was passed for user attribute "%s".',UNEXPECTED_CONDITION_VALUE:"%s: Audience condition %s evaluated to UNKNOWN because the condition value is not supported.",UNEXPECTED_TYPE:'%s: Audience condition %s evaluated to UNKNOWN because a value of type "%s" was passed for user attribute "%s".',UNEXPECTED_TYPE_NULL:'%s: Audience condition %s evaluated to UNKNOWN because a null value was passed for user attribute "%s".',UNKNOWN_CONDITION_TYPE:"%s: Audience condition %s has an unknown condition type. You may need to upgrade to a newer release of the Optimizely SDK.",UNKNOWN_MATCH_TYPE:"%s: Audience condition %s uses an unknown match type. You may need to upgrade to a newer release of the Optimizely SDK.",UPDATED_OPTIMIZELY_CONFIG:"%s: Updated Optimizely config to revision %s (project id %s)",OUT_OF_BOUNDS:'%s: Audience condition %s evaluated to UNKNOWN because the number value for user attribute "%s" is not in the range [-2^53, +2^53].',UNABLE_TO_ATTACH_UNLOAD:'%s: unable to bind optimizely.close() to page unload event: "%s"'},h={BOT_FILTERING:"$opt_bot_filtering",BUCKETING_ID:"$opt_bucketing_id",STICKY_BUCKETING_KEY:"$opt_experiment_bucket_map",USER_AGENT:"$opt_user_agent",FORCED_DECISION_NULL_RULE_KEY:"$opt_null_rule_key"},g=a.NOTIFICATION_TYPES,v={AB_TEST:"ab-test",FEATURE:"feature",FEATURE_TEST:"feature-test",FEATURE_VARIABLE:"feature-variable",ALL_FEATURE_VARIABLES:"all-feature-variables",FLAG:"flag"},m={FEATURE_TEST:"feature-test",ROLLOUT:"rollout",EXPERIMENT:"experiment"},E={RULE:"rule",EXPERIMENT:"experiment"},y={BOOLEAN:"boolean",DOUBLE:"double",INTEGER:"integer",STRING:"string",JSON:"json"},b={V2:"2",V3:"3",V4:"4"},I={SDK_NOT_READY:"Optimizely SDK not configured properly yet.",FLAG_KEY_INVALID:'No flag was found for key "%s".',VARIABLE_VALUE_INVALID:'Variable value for key "%s" is invalid or wrong type.'},_=Object.freeze({__proto__:null,LOG_LEVEL:d,ERROR_MESSAGES:p,LOG_MESSAGES:f,CONTROL_ATTRIBUTES:h,JAVASCRIPT_CLIENT_ENGINE:"javascript-sdk",NODE_CLIENT_ENGINE:"node-sdk",REACT_CLIENT_ENGINE:"react-sdk",REACT_NATIVE_CLIENT_ENGINE:"react-native-sdk",REACT_NATIVE_JS_CLIENT_ENGINE:"react-native-js-sdk",NODE_CLIENT_VERSION:"4.9.1",NOTIFICATION_TYPES:g,DECISION_NOTIFICATION_TYPES:v,DECISION_SOURCES:m,AUDIENCE_EVALUATION_TYPES:E,FEATURE_VARIABLE_TYPES:y,DATAFILE_VERSIONS:b,DECISION_MESSAGES:I}),O="CONFIG_VALIDATOR",w=[b.V2,b.V3,b.V4],T=function(e){if("object"==typeof e&&null!==e){var t=e,r=t.errorHandler,n=t.eventDispatcher,i=t.logger;if(r&&"function"!=typeof r.handleError)throw new Error(a.sprintf(p.INVALID_ERROR_HANDLER,O));if(n&&"function"!=typeof n.dispatchEvent)throw new Error(a.sprintf(p.INVALID_EVENT_DISPATCHER,O));if(i&&"function"!=typeof i.log)throw new Error(a.sprintf(p.INVALID_LOGGER,O));return!0}throw new Error(a.sprintf(p.INVALID_CONFIG,O))},N={handleError:function(){}},R={dispatchEvent:function(e,t){var r,n=e.params,i=e.url;"POST"===e.httpVerb?((r=new XMLHttpRequest).open("POST",i,!0),r.setRequestHeader("Content-Type","application/json"),r.onreadystatechange=function(){if(4===r.readyState&&t&&"function"==typeof t)try{t({statusCode:r.status})}catch(e){}},r.send(JSON.stringify(n))):(i+="?wxhr=true",n&&(i+="&"+function(e){return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")}(n)),(r=new XMLHttpRequest).open("GET",i,!0),r.onreadystatechange=function(){if(4===r.readyState&&t&&"function"==typeof t)try{t({statusCode:r.status})}catch(e){}},r.send())}},A=function(){function e(){}return e.prototype.log=function(){},e}();function S(e){return new i.ConsoleLogHandler(e)}var C,D,L=Object.freeze({__proto__:null,NoOpLogger:A,createLogger:S,createNoOpLogger:function(){return new A}});function U(e,t,r){return{variationKey:null,enabled:!1,variables:{},ruleKey:null,flagKey:e,userContext:t,reasons:r}}!function(e){e.BOOLEAN="boolean",e.DOUBLE="double",e.INTEGER="integer",e.STRING="string",e.JSON="json"}(C||(C={})),(D=t.OptimizelyDecideOption||(t.OptimizelyDecideOption={})).DISABLE_DECISION_EVENT="DISABLE_DECISION_EVENT",D.ENABLED_FLAGS_ONLY="ENABLED_FLAGS_ONLY",D.IGNORE_USER_PROFILE_SERVICE="IGNORE_USER_PROFILE_SERVICE",D.INCLUDE_REASONS="INCLUDE_REASONS",D.EXCLUDE_VARIABLES="EXCLUDE_VARIABLES";var P=function(){function e(e){var t,r=e.optimizely,n=e.userId,i=e.attributes;this.optimizely=r,this.userId=n,this.attributes=null!==(t=l({},i))&&void 0!==t?t:{},this.forcedDecisionsMap={}}return e.prototype.setAttribute=function(e,t){this.attributes[e]=t},e.prototype.getUserId=function(){return this.userId},e.prototype.getAttributes=function(){return l({},this.attributes)},e.prototype.getOptimizely=function(){return this.optimizely},e.prototype.decide=function(e,t){return void 0===t&&(t=[]),this.optimizely.decide(this.cloneUserContext(),e,t)},e.prototype.decideForKeys=function(e,t){return void 0===t&&(t=[]),this.optimizely.decideForKeys(this.cloneUserContext(),e,t)},e.prototype.decideAll=function(e){return void 0===e&&(e=[]),this.optimizely.decideAll(this.cloneUserContext(),e)},e.prototype.trackEvent=function(e,t){this.optimizely.track(e,this.userId,this.attributes,t)},e.prototype.setForcedDecision=function(e,t){var r,n=e.flagKey,i=null!==(r=e.ruleKey)&&void 0!==r?r:h.FORCED_DECISION_NULL_RULE_KEY,o={variationKey:t.variationKey};return this.forcedDecisionsMap[n]||(this.forcedDecisionsMap[n]={}),this.forcedDecisionsMap[n][i]=o,!0},e.prototype.getForcedDecision=function(e){return this.findForcedDecision(e)},e.prototype.removeForcedDecision=function(e){var t,r=null!==(t=e.ruleKey)&&void 0!==t?t:h.FORCED_DECISION_NULL_RULE_KEY,n=e.flagKey,i=!1;return this.forcedDecisionsMap.hasOwnProperty(n)&&(this.forcedDecisionsMap[n].hasOwnProperty(r)&&(delete this.forcedDecisionsMap[n][r],i=!0),0===Object.keys(this.forcedDecisionsMap[n]).length&&delete this.forcedDecisionsMap[n]),i},e.prototype.removeAllForcedDecisions=function(){return this.forcedDecisionsMap={},!0},e.prototype.findForcedDecision=function(e){var t,r=null!==(t=e.ruleKey)&&void 0!==t?t:h.FORCED_DECISION_NULL_RULE_KEY,n=e.flagKey;if(this.forcedDecisionsMap.hasOwnProperty(e.flagKey)){var i=this.forcedDecisionsMap[n];if(i.hasOwnProperty(r))return{variationKey:i[r].variationKey}}return null},e.prototype.cloneUserContext=function(){var t=new e({optimizely:this.getOptimizely(),userId:this.getUserId(),attributes:this.getAttributes()});return Object.keys(this.forcedDecisionsMap).length>0&&(t.forcedDecisionsMap=l({},this.forcedDecisionsMap)),t},e}(),x=["and","or","not"];function k(e,t){if(Array.isArray(e)){var r=e[0],n=e.slice(1);switch("string"==typeof r&&-1===x.indexOf(r)&&(r="or",n=e),r){case"and":return function(e,t){var r=!1;if(Array.isArray(e)){for(var n=0;n<e.length;n++){var i=k(e[n],t);if(!1===i)return!1;null===i&&(r=!0)}return!r||null}return null}(n,t);case"not":return function(e,t){if(Array.isArray(e)&&e.length>0){var r=k(e[0],t);return null===r?null:!r}return null}(n,t);default:return function(e,t){var r=!1;if(Array.isArray(e)){for(var n=0;n<e.length;n++){var i=k(e[n],t);if(!0===i)return!0;null===i&&(r=!0)}return!!r&&null}return null}(n,t)}}return t(e)}var F=function(){function e(t,r){var n,i;this.sdkKey=null!==(n=t.sdkKey)&&void 0!==n?n:"",this.environmentKey=null!==(i=t.environmentKey)&&void 0!==i?i:"",this.attributes=t.attributes,this.audiences=e.getAudiences(t),this.events=t.events,this.revision=t.revision;var o=(t.featureFlags||[]).reduce((function(e,t){return e[t.id]=t.variables,e}),{}),a=e.getExperimentsMapById(t,o);this.experimentsMap=e.getExperimentsKeyMap(a),this.featuresMap=e.getFeaturesMap(t,o,a),this.datafile=r}return e.prototype.getDatafile=function(){return this.datafile},e.getAudiences=function(e){var t=[],r=[];return(e.typedAudiences||[]).forEach((function(e){t.push({id:e.id,conditions:JSON.stringify(e.conditions),name:e.name}),r.push(e.id)})),(e.audiences||[]).forEach((function(e){-1===r.indexOf(e.id)&&"$opt_dummy_audience"!=e.id&&t.push({id:e.id,conditions:JSON.stringify(e.conditions),name:e.name})})),t},e.getSerializedAudiences=function(t,r){var n="";if(t){var i="";t.forEach((function(t){var o="";if(t instanceof Array)o="("+(o=e.getSerializedAudiences(t,r))+")";else if(x.indexOf(t)>-1)i=t.toUpperCase();else{var a=r[t]?r[t].name:t;n||"NOT"===i?(i=""===i?"OR":i,n=""===n?i+' "'+r[t].name+'"':n.concat(" "+i+' "'+a+'"')):n='"'+a+'"'}""!==o&&(""!==n||"NOT"===i?(i=""===i?"OR":i,n=""===n?i+" "+o:n.concat(" "+i+" "+o)):n=n.concat(o))}))}return n},e.getExperimentAudiences=function(t,r){return t.audienceConditions?e.getSerializedAudiences(t.audienceConditions,r.audiencesById):""},e.mergeFeatureVariables=function(e,t,r,n,i){var o=(e[r]||[]).reduce((function(e,t){return e[t.key]={id:t.id,key:t.key,type:t.type,value:t.defaultValue},e}),{});return(n||[]).forEach((function(e){var r=t[e.id],n={id:e.id,key:r.key,type:r.type,value:i?e.value:r.defaultValue};o[r.key]=n})),o},e.getVariationsMap=function(t,r,n,i){return t.reduce((function(t,o){var a=e.mergeFeatureVariables(r,n,i,o.variables,o.featureEnabled);return t[o.key]={id:o.id,key:o.key,featureEnabled:o.featureEnabled,variablesMap:a},t}),{})},e.getVariableIdMap=function(e){return(e.featureFlags||[]).reduce((function(e,t){return t.variables.forEach((function(t){e[t.id]=t})),e}),{})},e.getDeliveryRules=function(t,r,n,i){var o=e.getVariableIdMap(t);return i.map((function(i){return{id:i.id,key:i.key,audiences:e.getExperimentAudiences(i,t),variationsMap:e.getVariationsMap(i.variations,r,o,n)}}))},e.getRolloutExperimentIds=function(e){var t=[];return(e||[]).forEach((function(e){e.experiments.forEach((function(e){t.push(e.id)}))})),t},e.getExperimentsMapById=function(t,r){var n=e.getVariableIdMap(t),i=this.getRolloutExperimentIds(t.rollouts);return(t.experiments||[]).reduce((function(o,a){if(-1===i.indexOf(a.id)){var s=t.experimentFeatureMap[a.id],u="";s&&s.length>0&&(u=s[0]);var l=e.getVariationsMap(a.variations,r,n,u.toString());o[a.id]={id:a.id,key:a.key,audiences:e.getExperimentAudiences(a,t),variationsMap:l}}return o}),{})},e.getExperimentsKeyMap=function(e){var t={};for(var r in e){var n=e[r];t[n.key]=n}return t},e.getFeaturesMap=function(t,r,n){var i={};return t.featureFlags.forEach((function(o){var a={},s=[];o.experimentIds.forEach((function(e){var t=n[e];t&&(a[t.key]=t),s.push(n[e])}));var u=(o.variables||[]).reduce((function(e,t){return e[t.key]={id:t.id,key:t.key,type:t.type,value:t.defaultValue},e}),{}),l=[],c=t.rolloutIdMap[o.rolloutId];c&&(l=e.getDeliveryRules(t,r,o.id,c.experiments)),i[o.key]={id:o.id,key:o.key,experimentRules:s,deliveryRules:l,experimentsMap:a,variablesMap:u}})),i},e}(),M=Math.pow(2,53),j={assign:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!e)return{};if("function"==typeof Object.assign)return Object.assign.apply(Object,c([e],t));for(var n=Object(e),i=0;i<t.length;i++){var o=t[i];if(null!=o)for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(n[a]=o[a])}return n},currentTimestamp:function(){return Math.round((new Date).getTime())},isSafeInteger:function(e){return"number"==typeof e&&Math.abs(e)<=M},keyBy:function(e,t){return e?a.keyBy(e,(function(e){return e[t]})):{}},uuid:a.generateUUID,isNumber:function(e){return"number"==typeof e}},V="PROJECT_CONFIG",B=function(e,t){void 0===t&&(t=null);var r,n,i,o,s=(r=e,(o=j.assign({},r)).audiences=(r.audiences||[]).map((function(e){return j.assign({},e)})),o.experiments=(r.experiments||[]).map((function(e){return j.assign({},e)})),o.featureFlags=(r.featureFlags||[]).map((function(e){return j.assign({},e)})),o.groups=(r.groups||[]).map((function(e){var t=j.assign({},e);return t.experiments=(e.experiments||[]).map((function(e){return j.assign({},e)})),t})),o.rollouts=(r.rollouts||[]).map((function(e){var t=j.assign({},e);return t.experiments=(e.experiments||[]).map((function(e){return j.assign({},e)})),t})),o.environmentKey=null!==(n=r.environmentKey)&&void 0!==n?n:"",o.sdkKey=null!==(i=r.sdkKey)&&void 0!==i?i:"",o);return s.__datafileStr=null===t?JSON.stringify(e):t,(s.audiences||[]).forEach((function(e){e.conditions=JSON.parse(e.conditions)})),s.audiencesById=j.keyBy(s.audiences,"id"),j.assign(s.audiencesById,j.keyBy(s.typedAudiences,"id")),s.attributeKeyMap=j.keyBy(s.attributes,"key"),s.eventKeyMap=j.keyBy(s.events,"key"),s.groupIdMap=j.keyBy(s.groups,"id"),Object.keys(s.groupIdMap||{}).forEach((function(e){(s.groupIdMap[e].experiments||[]).forEach((function(t){s.experiments.push(j.assign(t,{groupId:e}))}))})),s.rolloutIdMap=j.keyBy(s.rollouts||[],"id"),a.objectValues(s.rolloutIdMap||{}).forEach((function(e){(e.experiments||[]).forEach((function(e){s.experiments.push(e),e.variationKeyMap=j.keyBy(e.variations,"key")}))})),s.experimentKeyMap=j.keyBy(s.experiments,"key"),s.experimentIdMap=j.keyBy(s.experiments,"id"),s.variationIdMap={},s.variationVariableUsageMap={},(s.experiments||[]).forEach((function(e){e.variationKeyMap=j.keyBy(e.variations,"key"),j.assign(s.variationIdMap,j.keyBy(e.variations,"id")),a.objectValues(e.variationKeyMap||{}).forEach((function(e){e.variables&&(s.variationVariableUsageMap[e.id]=j.keyBy(e.variables,"id"))}))})),s.experimentFeatureMap={},s.featureKeyMap=j.keyBy(s.featureFlags||[],"key"),a.objectValues(s.featureKeyMap||{}).forEach((function(e){e.variables.forEach((function(e){e.type===y.STRING&&e.subType===y.JSON&&(e.type=y.JSON,delete e.subType)})),e.variableKeyMap=j.keyBy(e.variables,"key"),(e.experimentIds||[]).forEach((function(t){s.experimentFeatureMap[t]?s.experimentFeatureMap[t].push(e.id):s.experimentFeatureMap[t]=[e.id]}))})),s.flagRulesMap={},(s.featureFlags||[]).forEach((function(e){var t=[];e.experimentIds.forEach((function(e){var r=s.experimentIdMap[e];r&&t.push(r)}));var r=s.rolloutIdMap[e.rolloutId];r&&t.push.apply(t,r.experiments),s.flagRulesMap[e.key]=t})),s.flagVariationsMap={},a.objectEntries(s.flagRulesMap||{}).forEach((function(e){var t=e[0],r=e[1],n=[];r.forEach((function(e){e.variations.forEach((function(e){a.find(n,(function(t){return t.id===e.id}))||n.push(e)}))})),s.flagVariationsMap[t]=n})),s},G=function(e,t){var r=e.experimentIdMap[t];if(!r)throw new Error(a.sprintf(p.INVALID_EXPERIMENT_ID,V,t));return r.layerId},K=function(e,t,r){var n=e.attributeKeyMap[t],i=0===t.indexOf("$opt_");return n?(i&&r.log(d.WARNING,"Attribute %s unexpectedly has reserved prefix %s; using attribute ID instead of reserved attribute name.",t,"$opt_"),n.id):i?t:(r.log(d.DEBUG,p.UNRECOGNIZED_ATTRIBUTE,V,t),null)},z=function(e,t){var r=e.eventKeyMap[t];return r?r.id:null},H=function(e,t){var r=e.experimentKeyMap[t];if(!r)throw new Error(a.sprintf(p.INVALID_EXPERIMENT_KEY,V,t));return r.status},q=function(e,t){return e.variationIdMap.hasOwnProperty(t)?e.variationIdMap[t].key:null},Y=function(e,t){if(e.experimentKeyMap.hasOwnProperty(t)){var r=e.experimentKeyMap[t];if(r)return r}throw new Error(a.sprintf(p.EXPERIMENT_KEY_NOT_IN_DATAFILE,V,t))},W=function(e,t){var r=e.experimentIdMap[t];if(!r)throw new Error(a.sprintf(p.INVALID_EXPERIMENT_ID,V,t));return r.trafficAllocation},X=function(e,t,r){if(e.experimentIdMap.hasOwnProperty(t)){var n=e.experimentIdMap[t];if(n)return n}return r.log(d.ERROR,p.INVALID_EXPERIMENT_ID,V,t),null},J=function(e,t,r){if(!e)return null;var n=e.flagVariationsMap[t];return a.find(n,(function(e){return e.key===r}))||null},Z=function(e,t,r){if(e.featureKeyMap.hasOwnProperty(t)){var n=e.featureKeyMap[t];if(n)return n}return r.log(d.ERROR,p.FEATURE_NOT_IN_DATAFILE,V,t),null},Q=function(e){return e.__datafileStr},$=function(e){var t;try{t=function(e){if(!e)throw new Error(a.sprintf(p.NO_DATAFILE_SPECIFIED,O));if("string"==typeof e)try{e=JSON.parse(e)}catch(e){throw new Error(a.sprintf(p.INVALID_DATAFILE_MALFORMED,O))}if("object"==typeof e&&!Array.isArray(e)&&null!==e&&-1===w.indexOf(e.version))throw new Error(a.sprintf(p.INVALID_DATAFILE_VERSION,O,e.version));return e}(e.datafile)}catch(e){return{configObj:null,error:e}}if(e.jsonSchemaValidator)try{e.jsonSchemaValidator.validate(t),e.logger.log(d.INFO,f.VALID_DATAFILE,V)}catch(e){return{configObj:null,error:e}}else e.logger.log(d.INFO,f.SKIPPING_JSON_VALIDATION,V);var r=[t];return"string"==typeof e.datafile&&r.push(e.datafile),{configObj:B.apply(void 0,r),error:null}},ee=function(e){return!!e.sendFlagDecisions},te=i.getLogger();function re(e,t){return e instanceof Error?e.message:t||"Unknown error"}var ne=function(){function e(e){this.updateListeners=[],this.configObj=null,this.optimizelyConfigObj=null,this.datafileManager=null;try{if(this.jsonSchemaValidator=e.jsonSchemaValidator,!e.datafile&&!e.sdkKey){var t=new Error(a.sprintf(p.DATAFILE_AND_SDK_KEY_MISSING,"PROJECT_CONFIG_MANAGER"));return this.readyPromise=Promise.resolve({success:!1,reason:re(t)}),void te.error(t)}var r=null;e.datafile&&(r=this.handleNewDatafile(e.datafile)),e.sdkKey&&e.datafileManager?(this.datafileManager=e.datafileManager,this.datafileManager.start(),this.readyPromise=this.datafileManager.onReady().then(this.onDatafileManagerReadyFulfill.bind(this),this.onDatafileManagerReadyReject.bind(this)),this.datafileManager.on("update",this.onDatafileManagerUpdate.bind(this))):this.configObj?this.readyPromise=Promise.resolve({success:!0}):this.readyPromise=Promise.resolve({success:!1,reason:re(r,"Invalid datafile")})}catch(e){te.error(e),this.readyPromise=Promise.resolve({success:!1,reason:re(e,"Error in initialize")})}}return e.prototype.onDatafileManagerReadyFulfill=function(){if(this.datafileManager){var e=this.handleNewDatafile(this.datafileManager.get());return e?{success:!1,reason:re(e)}:{success:!0}}return{success:!1,reason:re(null,"Datafile manager is not provided")}},e.prototype.onDatafileManagerReadyReject=function(e){return{success:!1,reason:re(e,"Failed to become ready")}},e.prototype.onDatafileManagerUpdate=function(){this.datafileManager&&this.handleNewDatafile(this.datafileManager.get())},e.prototype.handleNewDatafile=function(e){var t=$({datafile:e,jsonSchemaValidator:this.jsonSchemaValidator,logger:te}),r=t.configObj,n=t.error;if(n)te.error(n);else{var i=this.configObj?this.configObj.revision:"null";r&&i!==r.revision&&(this.configObj=r,this.optimizelyConfigObj=null,this.updateListeners.forEach((function(e){return e(r)})))}return n},e.prototype.getConfig=function(){return this.configObj},e.prototype.getOptimizelyConfig=function(){var e,t;return!this.optimizelyConfigObj&&this.configObj&&(this.optimizelyConfigObj=(e=this.configObj,t=Q(this.configObj),new F(e,t))),this.optimizelyConfigObj},e.prototype.onReady=function(){return this.readyPromise},e.prototype.onUpdate=function(e){var t=this;return this.updateListeners.push(e),function(){var r=t.updateListeners.indexOf(e);r>-1&&t.updateListeners.splice(r,1)}},e.prototype.stop=function(){this.datafileManager&&this.datafileManager.stop(),this.updateListeners=[]},e}(),ie=Math.pow(2,32),oe=function(e){var t=[],r=e.experimentIdMap[e.experimentId].groupId;if(r){var n=e.groupIdMap[r];if(!n)throw new Error(a.sprintf(p.INVALID_GROUP_ID,"BUCKETER",r));if("random"===n.policy){var i=ae(n,e.bucketingId,e.userId,e.logger);if(null===i)return e.logger.log(d.INFO,f.USER_NOT_IN_ANY_EXPERIMENT,"BUCKETER",e.userId,r),t.push([f.USER_NOT_IN_ANY_EXPERIMENT,"BUCKETER",e.userId,r]),{result:null,reasons:t};if(i!==e.experimentId)return e.logger.log(d.INFO,f.USER_NOT_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",e.userId,e.experimentKey,r),t.push([f.USER_NOT_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",e.userId,e.experimentKey,r]),{result:null,reasons:t};e.logger.log(d.INFO,f.USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",e.userId,e.experimentKey,r),t.push([f.USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",e.userId,e.experimentKey,r])}}var o=""+e.bucketingId+e.experimentId,s=ue(o);e.logger.log(d.DEBUG,f.USER_ASSIGNED_TO_EXPERIMENT_BUCKET,"BUCKETER",s,e.userId),t.push([f.USER_ASSIGNED_TO_EXPERIMENT_BUCKET,"BUCKETER",s,e.userId]);var u=se(s,e.trafficAllocationConfig);return null===u||e.variationIdMap[u]?{result:u,reasons:t}:(u&&(e.logger.log(d.WARNING,f.INVALID_VARIATION_ID,"BUCKETER"),t.push([f.INVALID_VARIATION_ID,"BUCKETER"])),{result:null,reasons:t})},ae=function(e,t,r,n){var i=""+t+e.id,o=ue(i);n.log(d.DEBUG,f.USER_ASSIGNED_TO_EXPERIMENT_BUCKET,"BUCKETER",o,r);var a=e.trafficAllocation;return se(o,a)},se=function(e,t){for(var r=0;r<t.length;r++)if(e<t[r].endOfRange)return t[r].entityId;return null},ue=function(e){try{var t=s.v3(e,1)/ie;return Math.floor(1e4*t)}catch(t){throw new Error(a.sprintf(p.INVALID_BUCKETING_ID,"BUCKETER",e,t.message))}},le=i.getLogger();function ce(e){return/^\d+$/.test(e)}function de(e){var t=e.indexOf("-"),r=e.indexOf("+");return!(t<0)&&(r<0||t<r)}function pe(e){var t=e.indexOf("-"),r=e.indexOf("+");return!(r<0)&&(t<0||r<t)}function fe(e){var t=e,r="";if(function(e){return/\s/.test(e)}(e))return le.warn(f.UNKNOWN_MATCH_TYPE,"SEMANTIC VERSION",e),null;if(de(e)?(t=e.substring(0,e.indexOf("-")),r=e.substring(e.indexOf("-")+1)):pe(e)&&(t=e.substring(0,e.indexOf("+")),r=e.substring(e.indexOf("+")+1)),"string"!=typeof t||"string"!=typeof r)return null;var n=t.split(".").length-1;if(n>2)return le.warn(f.UNKNOWN_MATCH_TYPE,"SEMANTIC VERSION",e),null;var i=t.split(".");if(i.length!=n+1)return le.warn(f.UNKNOWN_MATCH_TYPE,"SEMANTIC VERSION",e),null;for(var o=0,a=i;o<a.length;o++)if(!ce(a[o]))return le.warn(f.UNKNOWN_MATCH_TYPE,"SEMANTIC VERSION",e),null;return r&&i.push(r),i}var he="CUSTOM_ATTRIBUTE_CONDITION_EVALUATOR",ge=i.getLogger(),ve=["exact","exists","gt","ge","lt","le","substring","semver_eq","semver_lt","semver_le","semver_gt","semver_ge"],me={};function Ee(e){return"string"==typeof e||"boolean"==typeof e||j.isNumber(e)}function ye(e,t){var r=e.value,n=typeof r,i=e.name,o=t[i],a=typeof o;return!Ee(r)||j.isNumber(r)&&!j.isSafeInteger(r)?(ge.warn(f.UNEXPECTED_CONDITION_VALUE,he,JSON.stringify(e)),null):null===o?(ge.debug(f.UNEXPECTED_TYPE_NULL,he,JSON.stringify(e),i),null):Ee(o)&&n===a?j.isNumber(o)&&!j.isSafeInteger(o)?(ge.warn(f.OUT_OF_BOUNDS,he,JSON.stringify(e),i),null):r===o:(ge.warn(f.UNEXPECTED_TYPE,he,JSON.stringify(e),a,i),null)}function be(e,t){var r=e.name,n=t[r],i=typeof n,o=e.value;return null!==o&&j.isSafeInteger(o)?null===n?(ge.debug(f.UNEXPECTED_TYPE_NULL,he,JSON.stringify(e),r),!1):j.isNumber(n)?!!j.isSafeInteger(n)||(ge.warn(f.OUT_OF_BOUNDS,he,JSON.stringify(e),r),!1):(ge.warn(f.UNEXPECTED_TYPE,he,JSON.stringify(e),i,r),!1):(ge.warn(f.UNEXPECTED_CONDITION_VALUE,he,JSON.stringify(e)),!1)}function Ie(e,t){var r=e.name,n=t[r],i=typeof n,o=e.value;return"string"!=typeof o?(ge.warn(f.UNEXPECTED_CONDITION_VALUE,he,JSON.stringify(e)),null):null===n?(ge.debug(f.UNEXPECTED_TYPE_NULL,he,JSON.stringify(e),r),null):"string"!=typeof n?(ge.warn(f.UNEXPECTED_TYPE,he,JSON.stringify(e),i,r),null):function(e,t){var r=fe(t),n=fe(e);if(!r||!n)return null;for(var i=r.length,o=0;o<n.length;o++){if(i<=o)return de(e)||pe(e)?1:-1;if(ce(r[o])){var a=parseInt(r[o]),s=parseInt(n[o]);if(a>s)return 1;if(a<s)return-1}else{if(r[o]<n[o])return de(e)&&!de(t)?1:-1;if(r[o]>n[o])return!de(e)&&de(t)?-1:1}}return de(t)&&!de(e)?-1:0}(o,n)}me.exact=ye,me.exists=function(e,t){return null!=t[e.name]},me.gt=function(e,t){var r=t[e.name],n=e.value;return be(e,t)&&null!==n?r>n:null},me.ge=function(e,t){var r=t[e.name],n=e.value;return be(e,t)&&null!==n?r>=n:null},me.lt=function(e,t){var r=t[e.name],n=e.value;return be(e,t)&&null!==n?r<n:null},me.le=function(e,t){var r=t[e.name],n=e.value;return be(e,t)&&null!==n?r<=n:null},me.substring=function(e,t){var r=e.name,n=t[e.name],i=typeof n,o=e.value;return"string"!=typeof o?(ge.warn(f.UNEXPECTED_CONDITION_VALUE,he,JSON.stringify(e)),null):null===n?(ge.debug(f.UNEXPECTED_TYPE_NULL,he,JSON.stringify(e),r),null):"string"!=typeof n?(ge.warn(f.UNEXPECTED_TYPE,he,JSON.stringify(e),i,r),null):-1!==n.indexOf(o)},me.semver_eq=function(e,t){var r=Ie(e,t);return null===r?null:0===r},me.semver_gt=function(e,t){var r=Ie(e,t);return null===r?null:r>0},me.semver_ge=function(e,t){var r=Ie(e,t);return null===r?null:r>=0},me.semver_lt=function(e,t){var r=Ie(e,t);return null===r?null:r<0},me.semver_le=function(e,t){var r=Ie(e,t);return null===r?null:r<=0};var _e=Object.freeze({__proto__:null,evaluate:function(e,t){var r=e.match;if(void 0!==r&&-1===ve.indexOf(r))return ge.warn(f.UNKNOWN_MATCH_TYPE,he,JSON.stringify(e)),null;var n=e.name;return t.hasOwnProperty(n)||"exists"==r?(r&&me[r]||ye)(e,t):(ge.debug(f.MISSING_ATTRIBUTE_VALUE,he,JSON.stringify(e),n),null)}}),Oe=i.getLogger(),we=function(){function e(e){this.typeToEvaluatorMap=j.assign({},e,{custom_attribute:_e})}return e.prototype.evaluate=function(e,t,r){var n=this;return void 0===r&&(r={}),!e||0===e.length||!!k(e,(function(e){var i=t[e];if(i){Oe.log(d.DEBUG,f.EVALUATING_AUDIENCE,"AUDIENCE_EVALUATOR",e,JSON.stringify(i.conditions));var o=k(i.conditions,n.evaluateConditionWithUserAttributes.bind(n,r)),a=null===o?"UNKNOWN":o.toString().toUpperCase();return Oe.log(d.DEBUG,f.AUDIENCE_EVALUATION_RESULT,"AUDIENCE_EVALUATOR",e,a),o}return null}))},e.prototype.evaluateConditionWithUserAttributes=function(e,t){var r=this.typeToEvaluatorMap[t.type];if(!r)return Oe.log(d.WARNING,f.UNKNOWN_CONDITION_TYPE,"AUDIENCE_EVALUATOR",JSON.stringify(t)),null;try{return r.evaluate(t,e)}catch(e){Oe.log(d.ERROR,p.CONDITION_EVALUATOR_ERROR,"AUDIENCE_EVALUATOR",t.type,e.message)}return null},e}();function Te(e){return"string"==typeof e&&""!==e}var Ne="DECISION_SERVICE",Re=function(){function e(e){var t;this.audienceEvaluator=(t=e.UNSTABLE_conditionEvaluators,new we(t)),this.forcedVariationMap={},this.logger=e.logger,this.userProfileService=e.userProfileService||null}return e.prototype.getVariation=function(e,r,n,i){void 0===i&&(i={});var o=n.getUserId(),a=n.getAttributes(),s=this.getBucketingId(o,a),u=[],l=r.key;if(!this.checkIfExperimentIsActive(e,l))return this.logger.log(d.INFO,f.EXPERIMENT_NOT_RUNNING,Ne,l),u.push([f.EXPERIMENT_NOT_RUNNING,Ne,l]),{result:null,reasons:u};var c=this.getForcedVariation(e,l,o);u.push.apply(u,c.reasons);var p=c.result;if(p)return{result:p,reasons:u};var h=this.getWhitelistedVariation(r,o);u.push.apply(u,h.reasons);var g=h.result;if(g)return{result:g.key,reasons:u};var v=i[t.OptimizelyDecideOption.IGNORE_USER_PROFILE_SERVICE],m=this.resolveExperimentBucketMap(o,a);if(!v&&(g=this.getStoredVariation(e,r,o,m)))return this.logger.log(d.INFO,f.RETURNING_STORED_VARIATION,Ne,g.key,l,o),u.push([f.RETURNING_STORED_VARIATION,Ne,g.key,l,o]),{result:g.key,reasons:u};var y=this.checkIfUserIsInAudience(e,r,E.EXPERIMENT,a,"");if(u.push.apply(u,y.reasons),!y.result)return this.logger.log(d.INFO,f.USER_NOT_IN_EXPERIMENT,Ne,o,l),u.push([f.USER_NOT_IN_EXPERIMENT,Ne,o,l]),{result:null,reasons:u};var b=this.buildBucketerParams(e,r,s,o),I=oe(b);u.push.apply(u,I.reasons);var _=I.result;return _&&(g=e.variationIdMap[_]),g?(this.logger.log(d.INFO,f.USER_HAS_VARIATION,Ne,o,g.key,l),u.push([f.USER_HAS_VARIATION,Ne,o,g.key,l]),v||this.saveUserProfile(r,g,o,m),{result:g.key,reasons:u}):(this.logger.log(d.DEBUG,f.USER_HAS_NO_VARIATION,Ne,o,l),u.push([f.USER_HAS_NO_VARIATION,Ne,o,l]),{result:null,reasons:u})},e.prototype.resolveExperimentBucketMap=function(e,t){t=t||{};var r=this.getUserProfile(e)||{},n=t[h.STICKY_BUCKETING_KEY];return j.assign({},r.experiment_bucket_map,n)},e.prototype.checkIfExperimentIsActive=function(e,t){return function(e,t){return"Running"===H(e,t)}(e,t)},e.prototype.getWhitelistedVariation=function(e,t){var r=[];if(e.forcedVariations&&e.forcedVariations.hasOwnProperty(t)){var n=e.forcedVariations[t];return e.variationKeyMap.hasOwnProperty(n)?(this.logger.log(d.INFO,f.USER_FORCED_IN_VARIATION,Ne,t,n),r.push([f.USER_FORCED_IN_VARIATION,Ne,t,n]),{result:e.variationKeyMap[n],reasons:r}):(this.logger.log(d.ERROR,f.FORCED_BUCKETING_FAILED,Ne,n,t),r.push([f.FORCED_BUCKETING_FAILED,Ne,n,t]),{result:null,reasons:r})}return{result:null,reasons:r}},e.prototype.checkIfUserIsInAudience=function(e,t,r,n,i){var o=[],s=function(e,t){var r=e.experimentIdMap[t];if(!r)throw new Error(a.sprintf(p.INVALID_EXPERIMENT_ID,V,t));return r.audienceConditions||r.audienceIds}(e,t.id),u=e.audiencesById;this.logger.log(d.DEBUG,f.EVALUATING_AUDIENCES_COMBINED,Ne,r,i||t.key,JSON.stringify(s)),o.push([f.EVALUATING_AUDIENCES_COMBINED,Ne,r,i||t.key,JSON.stringify(s)]);var l=this.audienceEvaluator.evaluate(s,u,n);return this.logger.log(d.INFO,f.AUDIENCE_EVALUATION_RESULT_COMBINED,Ne,r,i||t.key,l.toString().toUpperCase()),o.push([f.AUDIENCE_EVALUATION_RESULT_COMBINED,Ne,r,i||t.key,l.toString().toUpperCase()]),{result:l,reasons:o}},e.prototype.buildBucketerParams=function(e,t,r,n){return{bucketingId:r,experimentId:t.id,experimentKey:t.key,experimentIdMap:e.experimentIdMap,experimentKeyMap:e.experimentKeyMap,groupIdMap:e.groupIdMap,logger:this.logger,trafficAllocationConfig:W(e,t.id),userId:n,variationIdMap:e.variationIdMap}},e.prototype.getStoredVariation=function(e,t,r,n){if(n.hasOwnProperty(t.id)){var i=n[t.id],o=i.variation_id;if(e.variationIdMap.hasOwnProperty(o))return e.variationIdMap[i.variation_id];this.logger.log(d.INFO,f.SAVED_VARIATION_NOT_FOUND,Ne,r,o,t.key)}return null},e.prototype.getUserProfile=function(e){var t={user_id:e,experiment_bucket_map:{}};if(!this.userProfileService)return t;try{return this.userProfileService.lookup(e)}catch(t){this.logger.log(d.ERROR,p.USER_PROFILE_LOOKUP_ERROR,Ne,e,t.message)}return null},e.prototype.saveUserProfile=function(e,t,r,n){if(this.userProfileService)try{n[e.id]={variation_id:t.id},this.userProfileService.save({user_id:r,experiment_bucket_map:n}),this.logger.log(d.INFO,f.SAVED_VARIATION,Ne,t.key,e.key,r)}catch(e){this.logger.log(d.ERROR,p.USER_PROFILE_SAVE_ERROR,Ne,r,e.message)}},e.prototype.getVariationForFeature=function(e,t,r,n){void 0===n&&(n={});var i=[],o=this.getVariationForFeatureExperiment(e,t,r,n);i.push.apply(i,o.reasons);var a=o.result;if(null!==a.variation)return{result:a,reasons:i};var s=this.getVariationForRollout(e,t,r);i.push.apply(i,s.reasons);var u=s.result,l=r.getUserId();return u.variation?(this.logger.log(d.DEBUG,f.USER_IN_ROLLOUT,Ne,l,t.key),i.push([f.USER_IN_ROLLOUT,Ne,l,t.key]),{result:u,reasons:i}):(this.logger.log(d.DEBUG,f.USER_NOT_IN_ROLLOUT,Ne,l,t.key),i.push([f.USER_NOT_IN_ROLLOUT,Ne,l,t.key]),{result:u,reasons:i})},e.prototype.getVariationForFeatureExperiment=function(e,t,r,n){void 0===n&&(n={});var i,o,a=[],s=null;if(t.experimentIds.length>0)for(o=0;o<t.experimentIds.length;o++){var u=X(e,t.experimentIds[o],this.logger);if(u&&(i=this.getVariationFromExperimentRule(e,t.key,u,r,n),a.push.apply(a,i.reasons),s=i.result)){var l=null;return(l=u.variationKeyMap[s])||(l=J(e,t.key,s)),{result:{experiment:u,variation:l,decisionSource:m.FEATURE_TEST},reasons:a}}}else this.logger.log(d.DEBUG,f.FEATURE_HAS_NO_EXPERIMENTS,Ne,t.key),a.push([f.FEATURE_HAS_NO_EXPERIMENTS,Ne,t.key]);return{result:{experiment:null,variation:null,decisionSource:m.FEATURE_TEST},reasons:a}},e.prototype.getVariationForRollout=function(e,t,r){var n=[];if(!t.rolloutId)return this.logger.log(d.DEBUG,f.NO_ROLLOUT_EXISTS,Ne,t.key),n.push([f.NO_ROLLOUT_EXISTS,Ne,t.key]),{result:{experiment:null,variation:null,decisionSource:m.ROLLOUT},reasons:n};var i=e.rolloutIdMap[t.rolloutId];if(!i)return this.logger.log(d.ERROR,p.INVALID_ROLLOUT_ID,Ne,t.rolloutId,t.key),n.push([p.INVALID_ROLLOUT_ID,Ne,t.rolloutId,t.key]),{result:{experiment:null,variation:null,decisionSource:m.ROLLOUT},reasons:n};var o,a,s,u=i.experiments;if(0===u.length)return this.logger.log(d.ERROR,f.ROLLOUT_HAS_NO_EXPERIMENTS,Ne,t.rolloutId),n.push([f.ROLLOUT_HAS_NO_EXPERIMENTS,Ne,t.rolloutId]),{result:{experiment:null,variation:null,decisionSource:m.ROLLOUT},reasons:n};for(var l=0;l<u.length;){if(o=this.getVariationFromDeliveryRule(e,t.key,u,l,r),n.push.apply(n,o.reasons),s=o.result,a=o.skipToEveryoneElse,s)return{result:{experiment:e.experimentIdMap[u[l].id],variation:s,decisionSource:m.ROLLOUT},reasons:n};l=a?u.length-1:l+1}return{result:{experiment:null,variation:null,decisionSource:m.ROLLOUT},reasons:n}},e.prototype.getBucketingId=function(e,t){var r=e;return null!=t&&"object"==typeof t&&t.hasOwnProperty(h.BUCKETING_ID)&&("string"==typeof t[h.BUCKETING_ID]?(r=t[h.BUCKETING_ID],this.logger.log(d.DEBUG,f.VALID_BUCKETING_ID,Ne,r)):this.logger.log(d.WARNING,f.BUCKETING_ID_NOT_STRING,Ne)),r},e.prototype.findValidatedForcedDecision=function(e,t,r,n){var i,o=[],a=t.getForcedDecision({flagKey:r,ruleKey:n}),s=null,u=t.getUserId();return e&&a&&(i=a.variationKey,(s=J(e,r,i))?n?(this.logger.log(d.INFO,f.USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED,i,r,n,u),o.push([f.USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED,i,r,n,u])):(this.logger.log(d.INFO,f.USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED,i,r,u),o.push([f.USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED,i,r,u])):n?(this.logger.log(d.INFO,f.USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED_BUT_INVALID,r,n,u),o.push([f.USER_HAS_FORCED_DECISION_WITH_RULE_SPECIFIED_BUT_INVALID,r,n,u])):(this.logger.log(d.INFO,f.USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED_BUT_INVALID,r,u),o.push([f.USER_HAS_FORCED_DECISION_WITH_NO_RULE_SPECIFIED_BUT_INVALID,r,u]))),{result:s,reasons:o}},e.prototype.removeForcedVariation=function(e,t,r){if(!e)throw new Error(a.sprintf(p.INVALID_USER_ID,Ne));if(!this.forcedVariationMap.hasOwnProperty(e))throw new Error(a.sprintf(p.USER_NOT_IN_FORCED_VARIATION,Ne,e));delete this.forcedVariationMap[e][t],this.logger.log(d.DEBUG,f.VARIATION_REMOVED_FOR_USER,Ne,r,e)},e.prototype.setInForcedVariationMap=function(e,t,r){this.forcedVariationMap.hasOwnProperty(e)||(this.forcedVariationMap[e]={}),this.forcedVariationMap[e][t]=r,this.logger.log(d.DEBUG,f.USER_MAPPED_TO_FORCED_VARIATION,Ne,r,t,e)},e.prototype.getForcedVariation=function(e,t,r){var n,i=[],o=this.forcedVariationMap[r];if(!o)return this.logger.log(d.DEBUG,f.USER_HAS_NO_FORCED_VARIATION,Ne,r),{result:null,reasons:i};try{var a=Y(e,t);if(!a.hasOwnProperty("id"))return this.logger.log(d.ERROR,p.IMPROPERLY_FORMATTED_EXPERIMENT,Ne,t),i.push([p.IMPROPERLY_FORMATTED_EXPERIMENT,Ne,t]),{result:null,reasons:i};n=a.id}catch(e){return this.logger.log(d.ERROR,e.message),i.push(e.message),{result:null,reasons:i}}var s=o[n];if(!s)return this.logger.log(d.DEBUG,f.USER_HAS_NO_FORCED_VARIATION_FOR_EXPERIMENT,Ne,t,r),{result:null,reasons:i};var u=q(e,s);return u?(this.logger.log(d.DEBUG,f.USER_HAS_FORCED_VARIATION,Ne,u,t,r),i.push([f.USER_HAS_FORCED_VARIATION,Ne,u,t,r])):this.logger.log(d.DEBUG,f.USER_HAS_NO_FORCED_VARIATION_FOR_EXPERIMENT,Ne,t,r),{result:u,reasons:i}},e.prototype.setForcedVariation=function(e,t,r,n){if(null!=n&&!Te(n))return this.logger.log(d.ERROR,p.INVALID_VARIATION_KEY,Ne),!1;var i;try{var o=Y(e,t);if(!o.hasOwnProperty("id"))return this.logger.log(d.ERROR,p.IMPROPERLY_FORMATTED_EXPERIMENT,Ne,t),!1;i=o.id}catch(e){return this.logger.log(d.ERROR,e.message),!1}if(null==n)try{return this.removeForcedVariation(r,i,t),!0}catch(e){return this.logger.log(d.ERROR,e.message),!1}var a=function(e,t,r){var n=e.experimentKeyMap[t];return n.variationKeyMap.hasOwnProperty(r)?n.variationKeyMap[r].id:null}(e,t,n);if(!a)return this.logger.log(d.ERROR,p.NO_VARIATION_FOR_EXPERIMENT_KEY,Ne,n,t),!1;try{return this.setInForcedVariationMap(r,i,a),!0}catch(e){return this.logger.log(d.ERROR,e.message),!1}},e.prototype.getVariationFromExperimentRule=function(e,t,r,n,i){void 0===i&&(i={});var o=[],a=this.findValidatedForcedDecision(e,n,t,r.key);o.push.apply(o,a.reasons);var s=a.result;if(s)return{result:s.key,reasons:o};var u=this.getVariation(e,r,n,i);return o.push.apply(o,u.reasons),{result:u.result,reasons:o}},e.prototype.getVariationFromDeliveryRule=function(e,t,r,n,i){var o=[],a=!1,s=r[n],u=this.findValidatedForcedDecision(e,i,t,s.key);o.push.apply(o,u.reasons);var l=u.result;if(l)return{result:l,reasons:o,skipToEveryoneElse:a};var c,p,h,g,v,m=i.getUserId(),y=i.getAttributes(),b=this.getBucketingId(m,y),I=n===r.length-1,_=I?"Everyone Else":n+1,O=null,w=this.checkIfUserIsInAudience(e,s,E.RULE,y,_);return o.push.apply(o,w.reasons),w.result?(this.logger.log(d.DEBUG,f.USER_MEETS_CONDITIONS_FOR_TARGETING_RULE,Ne,m,_),o.push([f.USER_MEETS_CONDITIONS_FOR_TARGETING_RULE,Ne,m,_]),p=this.buildBucketerParams(e,s,b,m),h=oe(p),o.push.apply(o,h.reasons),(c=h.result)&&(v=c,O=(g=e).variationIdMap.hasOwnProperty(v)?g.variationIdMap[v]:null),O?(this.logger.log(d.DEBUG,f.USER_BUCKETED_INTO_TARGETING_RULE,Ne,m,_),o.push([f.USER_BUCKETED_INTO_TARGETING_RULE,Ne,m,_])):I||(this.logger.log(d.DEBUG,f.USER_NOT_BUCKETED_INTO_TARGETING_RULE,Ne,m,_),o.push([f.USER_NOT_BUCKETED_INTO_TARGETING_RULE,Ne,m,_]),a=!0)):(this.logger.log(d.DEBUG,f.USER_DOESNT_MEET_CONDITIONS_FOR_TARGETING_RULE,Ne,m,_),o.push([f.USER_DOESNT_MEET_CONDITIONS_FOR_TARGETING_RULE,Ne,m,_])),{result:O,reasons:o,skipToEveryoneElse:a}},e}();function Ae(e,t){if(e.hasOwnProperty("revenue")){var r=e.revenue,n=void 0;return"string"==typeof r?(n=parseInt(r),isNaN(n)?(t.log(d.INFO,f.FAILED_TO_PARSE_REVENUE,"EVENT_TAG_UTILS",r),null):(t.log(d.INFO,f.PARSED_REVENUE_VALUE,"EVENT_TAG_UTILS",n),n)):"number"==typeof r?(n=r,t.log(d.INFO,f.PARSED_REVENUE_VALUE,"EVENT_TAG_UTILS",n),n):null}return null}function Se(e,t){if(e.hasOwnProperty("value")){var r=e.value,n=void 0;return"string"==typeof r?(n=parseFloat(r),isNaN(n)?(t.log(d.INFO,f.FAILED_TO_PARSE_VALUE,"EVENT_TAG_UTILS",r),null):(t.log(d.INFO,f.PARSED_NUMERIC_VALUE,"EVENT_TAG_UTILS",n),n)):"number"==typeof r?(n=r,t.log(d.INFO,f.PARSED_NUMERIC_VALUE,"EVENT_TAG_UTILS",n),n):null}return null}function Ce(e,t){return"string"==typeof e&&("string"==typeof t||"boolean"==typeof t||j.isNumber(t)&&j.isSafeInteger(t))}var De="https://logx.optimizely.com/v1/events";function Le(e){var t=e.attributes,r=e.userId,n=e.clientEngine,i=e.clientVersion,o=e.configObj,a=e.logger,s=!!o.anonymizeIP&&o.anonymizeIP,u=o.botFiltering,l={snapshots:[],visitor_id:r,attributes:[]},c={account_id:o.accountId,project_id:o.projectId,visitors:[l],revision:o.revision,client_name:n,client_version:i,anonymize_ip:s,enrich_decisions:!0};return t&&Object.keys(t||{}).forEach((function(e){if(Ce(e,t[e])){var r=K(o,e,a);r&&c.visitors[0].attributes.push({entity_id:r,key:e,type:"custom",value:t[e]})}})),"boolean"==typeof u&&c.visitors[0].attributes.push({entity_id:h.BOT_FILTERING,key:h.BOT_FILTERING,type:"custom",value:u}),c}function Ue(e){var t,r;return null!==(r=null===(t=e.experiment)||void 0===t?void 0:t.key)&&void 0!==r?r:""}function Pe(e){var t,r;return null!==(r=null===(t=e.variation)||void 0===t?void 0:t.key)&&void 0!==r?r:""}function xe(e){var t,r;return null!==(r=null===(t=e.variation)||void 0===t?void 0:t.featureEnabled)&&void 0!==r&&r}function ke(e){var t,r;return null!==(r=null===(t=e.experiment)||void 0===t?void 0:t.id)&&void 0!==r?r:null}function Fe(e){var t,r;return null!==(r=null===(t=e.variation)||void 0===t?void 0:t.id)&&void 0!==r?r:null}var Me=i.getLogger("EVENT_BUILDER");function je(e,t){var r=[];return t&&Object.keys(t||{}).forEach((function(n){if(Ce(n,t[n])){var i=K(e,n,Me);i&&r.push({entityId:i,key:n,value:t[n]})}})),r}var Ve="USER_PROFILE_SERVICE_VALIDATOR",Be=function(){function e(e){var r,n=this,i=e.clientEngine;i||(e.logger.log(d.INFO,f.INVALID_CLIENT_ENGINE,"OPTIMIZELY",i),i="node-sdk"),this.clientEngine=i,this.clientVersion=e.clientVersion||"4.9.1",this.errorHandler=e.errorHandler,this.isOptimizelyConfigValid=e.isValidInstance,this.logger=e.logger;var o=null!==(r=e.defaultDecideOptions)&&void 0!==r?r:[];Array.isArray(o)||(this.logger.log(d.DEBUG,f.INVALID_DEFAULT_DECIDE_OPTIONS,"OPTIMIZELY"),o=[]);var s={};o.forEach((function(e){t.OptimizelyDecideOption[e]?s[e]=!0:n.logger.log(d.WARNING,f.UNRECOGNIZED_DECIDE_OPTION,"OPTIMIZELY",e)})),this.defaultDecideOptions=s,this.projectConfigManager=function(e){return new ne(e)}({datafile:e.datafile,jsonSchemaValidator:e.jsonSchemaValidator,sdkKey:e.sdkKey,datafileManager:e.datafileManager}),this.disposeOnUpdate=this.projectConfigManager.onUpdate((function(e){n.logger.log(d.INFO,f.UPDATED_OPTIMIZELY_CONFIG,"OPTIMIZELY",e.revision,e.projectId),n.notificationCenter.sendNotifications(g.OPTIMIZELY_CONFIG_UPDATE)}));var u,l=this.projectConfigManager.onReady(),c=null;if(e.userProfileService)try{(function(e){if("object"==typeof e&&null!==e){if("function"!=typeof e.lookup)throw new Error(a.sprintf(p.INVALID_USER_PROFILE_SERVICE,Ve,"Missing function 'lookup'"));if("function"!=typeof e.save)throw new Error(a.sprintf(p.INVALID_USER_PROFILE_SERVICE,Ve,"Missing function 'save'"));return!0}throw new Error(a.sprintf(p.INVALID_USER_PROFILE_SERVICE,Ve))})(e.userProfileService)&&(c=e.userProfileService,this.logger.log(d.INFO,f.VALID_USER_PROFILE_SERVICE,"OPTIMIZELY"))}catch(e){this.logger.log(d.WARNING,e.message)}this.decisionService=(u={userProfileService:c,logger:this.logger,UNSTABLE_conditionEvaluators:e.UNSTABLE_conditionEvaluators},new Re(u)),this.notificationCenter=e.notificationCenter,this.eventProcessor=e.eventProcessor;var h=this.eventProcessor.start();this.readyPromise=Promise.all([l,h]).then((function(e){return e[0]})),this.readyTimeouts={},this.nextReadyTimeoutId=0}return e.prototype.isValidInstance=function(){return this.isOptimizelyConfigValid&&!!this.projectConfigManager.getConfig()},e.prototype.activate=function(e,t,r){try{if(!this.isValidInstance())return this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","activate"),null;if(!this.validateInputs({experiment_key:e,user_id:t},r))return this.notActivatingExperiment(e,t);var n=this.projectConfigManager.getConfig();if(!n)return null;try{var i=this.getVariation(e,t,r);if(null===i)return this.notActivatingExperiment(e,t);if(!function(e,t){return"Running"===H(e,t)}(n,e))return this.logger.log(d.DEBUG,f.SHOULD_NOT_DISPATCH_ACTIVATE,"OPTIMIZELY",e),i;var o=Y(n,e),a={experiment:o,variation:o.variationKeyMap[i],decisionSource:m.EXPERIMENT};return this.sendImpressionEvent(a,"",t,!0,r),i}catch(r){return this.logger.log(d.ERROR,r.message),this.logger.log(d.INFO,f.NOT_ACTIVATING_USER,"OPTIMIZELY",t,e),this.errorHandler.handleError(r),null}}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.sendImpressionEvent=function(e,t,r,n,i){var o=this.projectConfigManager.getConfig();if(o){var a=function(e){var t=e.configObj,r=e.decisionObj,n=e.userId,i=e.flagKey,o=e.enabled,a=e.userAttributes,s=e.clientEngine,u=e.clientVersion,l=r.decisionSource,c=Ue(r),d=ke(r),p=Pe(r),f=Fe(r),h=null!==d?G(t,d):null;return{type:"impression",timestamp:j.currentTimestamp(),uuid:j.uuid(),user:{id:n,attributes:je(t,a)},context:{accountId:t.accountId,projectId:t.projectId,revision:t.revision,clientName:s,clientVersion:u,anonymizeIP:t.anonymizeIP||!1,botFiltering:t.botFiltering},layer:{id:h},experiment:{id:d,key:c},variation:{id:f,key:p},ruleKey:c,flagKey:i,ruleType:l,enabled:o}}({decisionObj:e,flagKey:t,enabled:n,userId:r,userAttributes:i,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:o});this.eventProcessor.process(a),this.emitNotificationCenterActivate(e,t,r,n,i)}},e.prototype.emitNotificationCenterActivate=function(e,t,r,n,i){var o=this.projectConfigManager.getConfig();if(o){var a,s=e.decisionSource,u=Ue(e),l=ke(e),c=Pe(e),d=Fe(e);null!==l&&""!==c&&(a=o.experimentIdMap[l]);var p,f=function(e){var t,r,n,i,o,a,s,u,l=Le(e),c=(t=e.configObj,r=e.experimentId,n=e.variationId,i=e.ruleKey,o=e.ruleType,a=e.flagKey,s=e.enabled,{decisions:[{campaign_id:u=r?G(t,r):null,experiment_id:r,variation_id:n,metadata:{flag_key:a,rule_key:i,rule_type:o,variation_key:(n?q(t,n):null)||"",enabled:s}}],events:[{entity_id:u,timestamp:j.currentTimestamp(),key:"campaign_activated",uuid:j.uuid()}]});return l.visitors[0].snapshots.push(c),{httpVerb:"POST",url:De,params:l}}({attributes:i,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:o,experimentId:l,ruleKey:u,flagKey:t,ruleType:s,userId:r,enabled:n,variationId:d,logger:this.logger});a&&a.variationKeyMap&&""!==c&&(p=a.variationKeyMap[c]),this.notificationCenter.sendNotifications(g.ACTIVATE,{experiment:a,userId:r,attributes:i,variation:p,logEvent:f})}},e.prototype.track=function(e,t,r,n){try{if(!this.isValidInstance())return void this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","track");if(!this.validateInputs({user_id:t,event_key:e},r,n))return;var i=this.projectConfigManager.getConfig();if(!i)return;if(!function(e,t){return e.eventKeyMap.hasOwnProperty(t)}(i,e))return this.logger.log(d.WARNING,f.EVENT_KEY_NOT_FOUND,"OPTIMIZELY",e),void this.logger.log(d.WARNING,f.NOT_TRACKING_USER,"OPTIMIZELY",t);var o=function(e){var t=e.configObj,r=e.userId,n=e.userAttributes,i=e.clientEngine,o=e.clientVersion,a=e.eventKey,s=e.eventTags,u=z(t,a),l=s?Ae(s,Me):null,c=s?Se(s,Me):null;return{type:"conversion",timestamp:j.currentTimestamp(),uuid:j.uuid(),user:{id:r,attributes:je(t,n)},context:{accountId:t.accountId,projectId:t.projectId,revision:t.revision,clientName:i,clientVersion:o,anonymizeIP:t.anonymizeIP||!1,botFiltering:t.botFiltering},event:{id:u,key:a},revenue:l,value:c,tags:s}}({eventKey:e,eventTags:n=this.filterEmptyValues(n),userId:t,userAttributes:r,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:i});this.logger.log(d.INFO,f.TRACK_EVENT,"OPTIMIZELY",e,t),this.eventProcessor.process(o),this.emitNotificationCenterTrack(e,t,r,n)}catch(e){this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),this.logger.log(d.ERROR,f.NOT_TRACKING_USER,"OPTIMIZELY",t)}},e.prototype.emitNotificationCenterTrack=function(e,t,r,n){try{var i=this.projectConfigManager.getConfig();if(!i)return;var o=function(e){var t=Le(e),r=function(e,t,r,n){var i={events:[]},o={entity_id:z(e,t),timestamp:j.currentTimestamp(),uuid:j.uuid(),key:t};if(n){var a=Ae(n,r);null!==a&&(o.revenue=a);var s=Se(n,r);null!==s&&(o.value=s),o.tags=n}return i.events.push(o),i}(e.configObj,e.eventKey,e.logger,e.eventTags);return t.visitors[0].snapshots=[r],{httpVerb:"POST",url:De,params:t}}({attributes:r,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:i,eventKey:e,eventTags:n,logger:this.logger,userId:t});this.notificationCenter.sendNotifications(g.TRACK,{eventKey:e,userId:t,attributes:r,eventTags:n,logEvent:o})}catch(e){this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e)}},e.prototype.getVariation=function(e,t,r){try{if(!this.isValidInstance())return this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","getVariation"),null;try{if(!this.validateInputs({experiment_key:e,user_id:t},r))return null;var n=this.projectConfigManager.getConfig();if(!n)return null;var i=n.experimentKeyMap[e];if(!i)return this.logger.log(d.DEBUG,p.INVALID_EXPERIMENT_KEY,"OPTIMIZELY",e),null;var o=this.decisionService.getVariation(n,i,this.createUserContext(t,r)).result,a=(s=n,u=i.id,s.experimentFeatureMap.hasOwnProperty(u)?v.FEATURE_TEST:v.AB_TEST);return this.notificationCenter.sendNotifications(g.DECISION,{type:a,userId:t,attributes:r||{},decisionInfo:{experimentKey:e,variationKey:o}}),o}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}var s,u},e.prototype.setForcedVariation=function(e,t,r){if(!this.validateInputs({experiment_key:e,user_id:t}))return!1;var n=this.projectConfigManager.getConfig();if(!n)return!1;try{return this.decisionService.setForcedVariation(n,e,t,r)}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),!1}},e.prototype.getForcedVariation=function(e,t){if(!this.validateInputs({experiment_key:e,user_id:t}))return null;var r=this.projectConfigManager.getConfig();if(!r)return null;try{return this.decisionService.getForcedVariation(r,e,t).result}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.validateInputs=function(e,t,r){try{if(e.hasOwnProperty("user_id")){var n=e.user_id;if("string"!=typeof n||null===n||"undefined"===n)throw new Error(a.sprintf(p.INVALID_INPUT_FORMAT,"OPTIMIZELY","user_id"));delete e.user_id}return Object.keys(e).forEach((function(t){if(!Te(e[t]))throw new Error(a.sprintf(p.INVALID_INPUT_FORMAT,"OPTIMIZELY",t))})),t&&function(e){if("object"!=typeof e||Array.isArray(e)||null===e)throw new Error(a.sprintf(p.INVALID_ATTRIBUTES,"ATTRIBUTES_VALIDATOR"));Object.keys(e).forEach((function(t){if(void 0===e[t])throw new Error(a.sprintf(p.UNDEFINED_ATTRIBUTE,"ATTRIBUTES_VALIDATOR",t))}))}(t),r&&function(e){if("object"!=typeof e||Array.isArray(e)||null===e)throw new Error(a.sprintf(p.INVALID_EVENT_TAGS,"EVENT_TAGS_VALIDATOR"))}(r),!0}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),!1}},e.prototype.notActivatingExperiment=function(e,t){return this.logger.log(d.INFO,f.NOT_ACTIVATING_USER,"OPTIMIZELY",t,e),null},e.prototype.filterEmptyValues=function(e){for(var t in e)!e.hasOwnProperty(t)||null!==e[t]&&void 0!==e[t]||delete e[t];return e},e.prototype.isFeatureEnabled=function(e,t,r){try{if(!this.isValidInstance())return this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","isFeatureEnabled"),!1;if(!this.validateInputs({feature_key:e,user_id:t},r))return!1;var n=this.projectConfigManager.getConfig();if(!n)return!1;var i=Z(n,e,this.logger);if(!i)return!1;var o={},a=this.createUserContext(t,r),s=this.decisionService.getVariationForFeature(n,i,a).result,u=s.decisionSource,l=Ue(s),c=Pe(s),p=xe(s);u===m.FEATURE_TEST&&(o={experimentKey:l,variationKey:c}),(u===m.FEATURE_TEST||u===m.ROLLOUT&&ee(n))&&this.sendImpressionEvent(s,i.key,t,p,r),!0===p?this.logger.log(d.INFO,f.FEATURE_ENABLED_FOR_USER,"OPTIMIZELY",e,t):(this.logger.log(d.INFO,f.FEATURE_NOT_ENABLED_FOR_USER,"OPTIMIZELY",e,t),p=!1);var h={featureKey:e,featureEnabled:p,source:s.decisionSource,sourceInfo:o};return this.notificationCenter.sendNotifications(g.DECISION,{type:v.FEATURE,userId:t,attributes:r||{},decisionInfo:h}),p}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),!1}},e.prototype.getEnabledFeatures=function(e,t){var r=this;try{var n=[];if(!this.isValidInstance())return this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","getEnabledFeatures"),n;if(!this.validateInputs({user_id:e}))return n;var i=this.projectConfigManager.getConfig();return i?(a.objectValues(i.featureKeyMap).forEach((function(i){r.isFeatureEnabled(i.key,e,t)&&n.push(i.key)})),n):n}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),[]}},e.prototype.getFeatureVariable=function(e,t,r,n){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,null,r,n):(this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariable"),null)}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getFeatureVariableForType=function(e,t,r,n,i){if(!this.validateInputs({feature_key:e,variable_key:t,user_id:n},i))return null;var o=this.projectConfigManager.getConfig();if(!o)return null;var a=Z(o,e,this.logger);if(!a)return null;var s=function(e,t,r,n){var i=e.featureKeyMap[t];return i?i.variableKeyMap[r]||(n.log(d.ERROR,p.VARIABLE_KEY_NOT_IN_DATAFILE,V,r,t),null):(n.log(d.ERROR,p.FEATURE_NOT_IN_DATAFILE,V,t),null)}(o,e,t,this.logger);if(!s)return null;if(r&&s.type!==r)return this.logger.log(d.WARNING,f.VARIABLE_REQUESTED_WITH_WRONG_TYPE,"OPTIMIZELY",r,s.type),null;var u=this.createUserContext(n,i),l=this.decisionService.getVariationForFeature(o,a,u).result,c=xe(l),h=this.getFeatureVariableValueFromVariation(e,c,l.variation,s,n),E={};return l.decisionSource===m.FEATURE_TEST&&null!==l.experiment&&null!==l.variation&&(E={experimentKey:l.experiment.key,variationKey:l.variation.key}),this.notificationCenter.sendNotifications(g.DECISION,{type:v.FEATURE_VARIABLE,userId:n,attributes:i||{},decisionInfo:{featureKey:e,featureEnabled:c,source:l.decisionSource,variableKey:t,variableValue:h,variableType:s.type,sourceInfo:E}}),h},e.prototype.getFeatureVariableValueFromVariation=function(e,t,r,n,i){var o=this.projectConfigManager.getConfig();if(!o)return null;var a=n.defaultValue;if(null!==r){var s=function(e,t,r,n){if(!t||!r)return null;if(!e.variationVariableUsageMap.hasOwnProperty(r.id))return n.log(d.ERROR,p.VARIATION_ID_NOT_IN_DATAFILE_NO_EXPERIMENT,V,r.id),null;var i=e.variationVariableUsageMap[r.id][t.id];return i?i.value:null}(o,n,r,this.logger);null!==s?t?(a=s,this.logger.log(d.INFO,f.USER_RECEIVED_VARIABLE_VALUE,"OPTIMIZELY",a,n.key,e)):this.logger.log(d.INFO,f.FEATURE_NOT_ENABLED_RETURN_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",e,i,a):this.logger.log(d.INFO,f.VARIABLE_NOT_USED_RETURN_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",n.key,r.key)}else this.logger.log(d.INFO,f.USER_RECEIVED_DEFAULT_VARIABLE_VALUE,"OPTIMIZELY",i,n.key,e);return function(e,t,r){var n;switch(t){case y.BOOLEAN:"true"!==e&&"false"!==e?(r.log(d.ERROR,p.UNABLE_TO_CAST_VALUE,V,e,t),n=null):n="true"===e;break;case y.INTEGER:n=parseInt(e,10),isNaN(n)&&(r.log(d.ERROR,p.UNABLE_TO_CAST_VALUE,V,e,t),n=null);break;case y.DOUBLE:n=parseFloat(e),isNaN(n)&&(r.log(d.ERROR,p.UNABLE_TO_CAST_VALUE,V,e,t),n=null);break;case y.JSON:try{n=JSON.parse(e)}catch(i){r.log(d.ERROR,p.UNABLE_TO_CAST_VALUE,V,e,t),n=null}break;default:n=e}return n}(a,n.type,this.logger)},e.prototype.getFeatureVariableBoolean=function(e,t,r,n){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,y.BOOLEAN,r,n):(this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariableBoolean"),null)}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getFeatureVariableDouble=function(e,t,r,n){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,y.DOUBLE,r,n):(this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariableDouble"),null)}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getFeatureVariableInteger=function(e,t,r,n){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,y.INTEGER,r,n):(this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariableInteger"),null)}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getFeatureVariableString=function(e,t,r,n){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,y.STRING,r,n):(this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariableString"),null)}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getFeatureVariableJSON=function(e,t,r,n){try{return this.isValidInstance()?this.getFeatureVariableForType(e,t,y.JSON,r,n):(this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","getFeatureVariableJSON"),null)}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getAllFeatureVariables=function(e,t,r){var n=this;try{if(!this.isValidInstance())return this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","getAllFeatureVariables"),null;if(!this.validateInputs({feature_key:e,user_id:t},r))return null;var i=this.projectConfigManager.getConfig();if(!i)return null;var o=Z(i,e,this.logger);if(!o)return null;var a=this.createUserContext(t,r),s=this.decisionService.getVariationForFeature(i,o,a).result,u=xe(s),l={};o.variables.forEach((function(r){l[r.key]=n.getFeatureVariableValueFromVariation(e,u,s.variation,r,t)}));var c={};return s.decisionSource===m.FEATURE_TEST&&null!==s.experiment&&null!==s.variation&&(c={experimentKey:s.experiment.key,variationKey:s.variation.key}),this.notificationCenter.sendNotifications(g.DECISION,{type:v.ALL_FEATURE_VARIABLES,userId:t,attributes:r||{},decisionInfo:{featureKey:e,featureEnabled:u,source:s.decisionSource,variableValues:l,sourceInfo:c}}),l}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.getOptimizelyConfig=function(){try{return this.projectConfigManager.getConfig()?this.projectConfigManager.getOptimizelyConfig():null}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),null}},e.prototype.close=function(){var e=this;try{var t=this.eventProcessor.stop();return this.disposeOnUpdate&&(this.disposeOnUpdate(),this.disposeOnUpdate=null),this.projectConfigManager&&this.projectConfigManager.stop(),Object.keys(this.readyTimeouts).forEach((function(t){var r=e.readyTimeouts[t];clearTimeout(r.readyTimeout),r.onClose()})),this.readyTimeouts={},t.then((function(){return{success:!0}}),(function(e){return{success:!1,reason:String(e)}}))}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),Promise.resolve({success:!1,reason:String(e)})}},e.prototype.onReady=function(e){var t,r,n=this;"object"==typeof e&&null!==e&&void 0!==e.timeout&&(t=e.timeout),j.isSafeInteger(t)||(t=3e4);var i=new Promise((function(e){r=e})),o=this.nextReadyTimeoutId;this.nextReadyTimeoutId++;var s=setTimeout((function(){delete n.readyTimeouts[o],r({success:!1,reason:a.sprintf("onReady timeout expired after %s ms",t)})}),t);return this.readyTimeouts[o]={readyTimeout:s,onClose:function(){r({success:!1,reason:"Instance closed"})}},this.readyPromise.then((function(){clearTimeout(s),delete n.readyTimeouts[o],r({success:!0})})),Promise.race([this.readyPromise,i])},e.prototype.createUserContext=function(e,t){return this.validateInputs({user_id:e},t)?new P({optimizely:this,userId:e,attributes:t}):null},e.prototype.decide=function(e,r,n){var i,o,s,u,l=this;void 0===n&&(n=[]);var h,E=e.getUserId(),y=e.getAttributes(),b=this.projectConfigManager.getConfig(),_=[];if(!this.isValidInstance()||!b)return this.logger.log(d.INFO,f.INVALID_OBJECT,"OPTIMIZELY","decide"),U(r,e,[I.SDK_NOT_READY]);var O=b.featureKeyMap[r];if(!O)return this.logger.log(d.ERROR,p.FEATURE_NOT_IN_DATAFILE,"OPTIMIZELY",r),U(r,e,[a.sprintf(I.FLAG_KEY_INVALID,r)]);var w=this.getAllDecideOptions(n),T=this.decisionService.findValidatedForcedDecision(b,e,r);_.push.apply(_,T.reasons);var N=T.result;if(N)h={experiment:null,variation:N,decisionSource:m.FEATURE_TEST};else{var R=this.decisionService.getVariationForFeature(b,O,e,w);_.push.apply(_,R.reasons),h=R.result}var A=h.decisionSource,S=null!==(o=null===(i=h.experiment)||void 0===i?void 0:i.key)&&void 0!==o?o:null,C=null!==(u=null===(s=h.variation)||void 0===s?void 0:s.key)&&void 0!==u?u:null,D=xe(h);!0===D?this.logger.log(d.INFO,f.FEATURE_ENABLED_FOR_USER,"OPTIMIZELY",r,E):this.logger.log(d.INFO,f.FEATURE_NOT_ENABLED_FOR_USER,"OPTIMIZELY",r,E);var L={},P=!1;w[t.OptimizelyDecideOption.EXCLUDE_VARIABLES]||O.variables.forEach((function(e){L[e.key]=l.getFeatureVariableValueFromVariation(r,D,h.variation,e,E)})),!w[t.OptimizelyDecideOption.DISABLE_DECISION_EVENT]&&(A===m.FEATURE_TEST||A===m.ROLLOUT&&ee(b))&&(this.sendImpressionEvent(h,r,E,D,y),P=!0);var x=[];w[t.OptimizelyDecideOption.INCLUDE_REASONS]&&(x=_.map((function(e){return a.sprintf.apply(void 0,c([e[0]],e.slice(1)))})));var k={flagKey:r,enabled:D,variationKey:C,ruleKey:S,variables:L,reasons:x,decisionEventDispatched:P};return this.notificationCenter.sendNotifications(g.DECISION,{type:v.FLAG,userId:E,attributes:y,decisionInfo:k}),{variationKey:C,enabled:D,variables:L,ruleKey:S,flagKey:r,userContext:e,reasons:x}},e.prototype.getAllDecideOptions=function(e){var r=this,n=l({},this.defaultDecideOptions);return Array.isArray(e)?e.forEach((function(e){t.OptimizelyDecideOption[e]?n[e]=!0:r.logger.log(d.WARNING,f.UNRECOGNIZED_DECIDE_OPTION,"OPTIMIZELY",e)})):this.logger.log(d.DEBUG,f.INVALID_DECIDE_OPTIONS,"OPTIMIZELY"),n},e.prototype.decideForKeys=function(e,r,n){var i=this;void 0===n&&(n=[]);var o={};if(!this.isValidInstance())return this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","decideForKeys"),o;if(0===r.length)return o;var a=this.getAllDecideOptions(n);return r.forEach((function(r){var s=i.decide(e,r,n);a[t.OptimizelyDecideOption.ENABLED_FLAGS_ONLY]&&!s.enabled||(o[r]=s)})),o},e.prototype.decideAll=function(e,t){void 0===t&&(t=[]);var r=this.projectConfigManager.getConfig();if(!this.isValidInstance()||!r)return this.logger.log(d.ERROR,f.INVALID_OBJECT,"OPTIMIZELY","decideAll"),{};var n=Object.keys(r.featureKeyMap);return this.decideForKeys(e,n,t)},e}(),Ge=function(){function e(e){var t=this;this.logger=e.logger,this.errorHandler=e.errorHandler,this.notificationListeners={},a.objectValues(g).forEach((function(e){t.notificationListeners[e]=[]})),this.listenerId=1}return e.prototype.addNotificationListener=function(e,t){try{if(!(a.objectValues(g).indexOf(e)>-1))return-1;this.notificationListeners[e]||(this.notificationListeners[e]=[]);var r=!1;if((this.notificationListeners[e]||[]).forEach((function(e){e.callback!==t||(r=!0)})),r)return-1;this.notificationListeners[e].push({id:this.listenerId,callback:t});var n=this.listenerId;return this.listenerId+=1,n}catch(e){return this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e),-1}},e.prototype.removeNotificationListener=function(e){var t=this;try{var r,n;if(Object.keys(this.notificationListeners).some((function(i){return(t.notificationListeners[i]||[]).every((function(t,o){return t.id!==e||(r=o,n=i,!1)})),void 0!==r&&void 0!==n})),void 0!==r&&void 0!==n)return this.notificationListeners[n].splice(r,1),!0}catch(e){this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e)}return!1},e.prototype.clearAllNotificationListeners=function(){var e=this;try{a.objectValues(g).forEach((function(t){e.notificationListeners[t]=[]}))}catch(e){this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e)}},e.prototype.clearNotificationListeners=function(e){try{this.notificationListeners[e]=[]}catch(e){this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e)}},e.prototype.sendNotifications=function(e,t){var r=this;try{(this.notificationListeners[e]||[]).forEach((function(n){var i=n.callback;try{i(t)}catch(t){r.logger.log(d.ERROR,f.NOTIFICATION_LISTENER_EXCEPTION,"NOTIFICATION_CENTER",e,t.message)}}))}catch(e){this.logger.log(d.ERROR,e.message),this.errorHandler.handleError(e)}},e}(),Ke=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(o.LogTierV1EventProcessor.bind.apply(o.LogTierV1EventProcessor,c([void 0],e)))};o.LocalStoragePendingEventsDispatcher;function ze(e,t,r,n){var i={sdkKey:e};if((void 0===n||"object"==typeof n&&null!==n)&&j.assign(i,n),r){var o=$({datafile:r,jsonSchemaValidator:void 0,logger:t}),a=o.configObj,s=o.error;s&&t.error(s),a&&(i.datafile=Q(a))}return new u.HttpPollingDatafileManager(i)}var He=i.getLogger();i.setLogHandler(S()),i.setLogLevel(i.LogLevel.INFO);var qe=!1,Ye=function(e){try{e.errorHandler&&i.setErrorHandler(e.errorHandler),e.logger&&(i.setLogHandler(e.logger),i.setLogLevel(i.LogLevel.NOTSET)),void 0!==e.logLevel&&i.setLogLevel(e.logLevel);try{T(e),e.isValidInstance=!0}catch(i){He.error(i),e.isValidInstance=!1}var t=void 0;null==e.eventDispatcher?(t=new o.LocalStoragePendingEventsDispatcher({eventDispatcher:R}),qe||(t.sendPendingEvents(),qe=!0)):t=e.eventDispatcher;var r=e.eventBatchSize,n=e.eventFlushInterval;(function(e){return!("number"!=typeof e||!j.isSafeInteger(e))&&e>=1})(e.eventBatchSize)||(He.warn("Invalid eventBatchSize %s, defaulting to %s",e.eventBatchSize,10),r=10),function(e){return!("number"!=typeof e||!j.isSafeInteger(e))&&e>0}(e.eventFlushInterval)||(He.warn("Invalid eventFlushInterval %s, defaulting to %s",e.eventFlushInterval,1e3),n=1e3);var a=i.getErrorHandler(),s=new Ge({logger:He,errorHandler:a}),u={dispatcher:t,flushInterval:n,batchSize:r,maxQueueSize:e.eventMaxQueueSize||1e4,notificationCenter:s},c=l(l({clientEngine:"javascript-sdk"},e),{eventProcessor:Ke(u),logger:He,errorHandler:a,datafileManager:e.sdkKey?ze(e.sdkKey,He,e.datafile,e.datafileOptions):void 0,notificationCenter:s}),d=new Be(c);try{if("function"==typeof window.addEventListener){var p="onpagehide"in window?"pagehide":"unload";window.addEventListener(p,(function(){d.close()}),!1)}}catch(e){He.error(f.UNABLE_TO_ATTACH_UNLOAD,"INDEX_BROWSER",e.message)}return d}catch(e){return He.error(e),null}},We=function(){qe=!1},Xe={logging:L,errorHandler:N,eventDispatcher:R,enums:_,setLogger:i.setLogHandler,setLogLevel:i.setLogLevel,createInstance:Ye,__internalResetRetryState:We,OptimizelyDecideOption:t.OptimizelyDecideOption};Object.defineProperty(t,"setLogLevel",{enumerable:!0,get:function(){return i.setLogLevel}}),Object.defineProperty(t,"setLogger",{enumerable:!0,get:function(){return i.setLogHandler}}),t.__internalResetRetryState=We,t.createInstance=Ye,t.default=Xe,t.enums=_,t.errorHandler=N,t.eventDispatcher=R,t.logging=L},Z1Qi:function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},"ZM+o":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return l}));r("E9XD");var n=r("Nz9T");let i;!function(e){e.Completed="completed",e.CompletedAnonymous="completedAnonymous",e.ToggleQuiz="toggleQuiz",e.ShowQuiz="showQuiz",e.Increment="increment",e.Decrement="decrement",e.SetSteps="setSteps",e.SetStepCompleted="setStepCompleted",e.SetBusinessFlow="setBusinessFlow",e.SetLoading="SetLoading",e.SetError="SetError"}(i||(i={}));const o={completed:!1,isLoading:!1,completedAnonymous:!1,quizOpen:!1,activeStep:0,steps:[],maxNumberOfSteps:0,completedSteps:{0:!1},businessFlow:!1},a=n.createContext(void 0);function s(e,t){switch(t.type){case i.ToggleQuiz:return Object.assign({},e,{quizOpen:!e.quizOpen,activeStep:0,completedSteps:e.steps.reduce((e,t,r)=>Object.assign({},e,{[r]:!1}),{})});case i.ShowQuiz:return Object.assign({},e,{quizOpen:!0,activeStep:0,completedSteps:e.steps.reduce((e,t,r)=>Object.assign({},e,{[r]:!1}),{})});case i.Completed:return Object.assign({},e,{error:void 0,completed:!0});case i.CompletedAnonymous:return Object.assign({},e,{quizOpen:!0,completedAnonymous:!0});case i.SetBusinessFlow:return Object.assign({},e,{businessFlow:t.payload.businessFlow});case i.Increment:{const t=function(e){if(e.activeStep===e.maxNumberOfSteps-1)return e.activeStep;return e.activeStep+1}(e);return Object.assign({},e,{activeStep:t})}case i.Decrement:{const t=function(e){if(0===e.activeStep)return e.activeStep;return e.activeStep-1}(e);return Object.assign({},e,{activeStep:t})}case i.SetSteps:return Object.assign({},e,{steps:t.payload,maxNumberOfSteps:t.payload.length});case i.SetStepCompleted:return Object.assign({},e,{completedSteps:Object.assign({},e.completedSteps,{[t.payload.step]:t.payload.completed})});case i.SetError:{const r=e.steps.length?e.steps.length-1:void 0;return Object.assign({},e,{completed:!1,completedAnonymous:!1,error:t.payload,activeStep:r})}case i.SetLoading:return Object.assign({},e,{isLoading:t.payload});default:return console.warn("Unknown action: ",t),e}}function u({children:e,locale:t,taxonomyIndustry:r}){const[i,u]=n.useReducer(s,Object.assign({},o,{locale:t.toLowerCase(),taxonomyIndustry:r})),l={state:i,dispatch:u};return n.createElement(a.Provider,{value:l},e)}function l(){const e=n.useContext(a);if(void 0===e)throw new Error("useOnboarding must be used within a OnboardingProvider");return e}},ZMCJ:function(e,t,r){},ZlFy:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageStore=void 0;var n=r("VPC1"),i=r("NR54").getLogger("EventProcessor"),o=function(){function e(e){var t=e.key,r=e.maxValues,n=void 0===r?1e3:r;this.LS_KEY=t,this.maxValues=n}return e.prototype.get=function(e){return this.getMap()[e]||null},e.prototype.set=function(e,t){var r=this.getMap();r[e]=t,this.replace(r)},e.prototype.remove=function(e){var t=this.getMap();delete t[e],this.replace(t)},e.prototype.values=function(){return n.objectValues(this.getMap())},e.prototype.clear=function(){this.replace({})},e.prototype.replace=function(e){try{window.localStorage&&localStorage.setItem(this.LS_KEY,JSON.stringify(e)),this.clean()}catch(t){i.error(t)}},e.prototype.clean=function(){var e=this.getMap(),t=Object.keys(e),r=t.length-this.maxValues;if(!(r<1)){var n=t.map((function(t){return{key:t,value:e[t]}}));n.sort((function(e,t){return e.value.timestamp-t.value.timestamp}));for(var i=0;i<r;i++)delete e[n[i].key];this.replace(e)}},e.prototype.getMap=function(){try{var e=window.localStorage&&localStorage.getItem(this.LS_KEY);if(e)return JSON.parse(e)||{}}catch(t){i.error(t)}return{}},e}();t.LocalStorageStore=o},bXNa:function(e,t,r){"use strict";var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var i=r("Knbq"),o=r("VPC1"),a=r("mcjk"),s={NOTSET:0,DEBUG:1,INFO:2,WARNING:3,ERROR:4};function u(e){return"string"!=typeof e?e:("WARN"===(e=e.toUpperCase())&&(e="WARNING"),s[e]?s[e]:e)}var l=function(){function e(){this.defaultLoggerFacade=new f,this.loggers={}}return e.prototype.getLogger=function(e){return e?(this.loggers[e]||(this.loggers[e]=new f({messagePrefix:e})),this.loggers[e]):this.defaultLoggerFacade},e}(),c=function(){function e(e){void 0===e&&(e={}),this.logLevel=a.LogLevel.NOTSET,void 0!==e.logLevel&&o.isValidEnum(a.LogLevel,e.logLevel)&&this.setLogLevel(e.logLevel),this.logToConsole=void 0===e.logToConsole||!!e.logToConsole,this.prefix=void 0!==e.prefix?e.prefix:"[OPTIMIZELY]"}return e.prototype.log=function(e,t){if(this.shouldLog(e)&&this.logToConsole){var r=this.prefix+" - "+this.getLogLevelName(e)+" "+this.getTime()+" "+t;this.consoleLog(e,[r])}},e.prototype.setLogLevel=function(e){e=u(e),o.isValidEnum(a.LogLevel,e)&&void 0!==e?this.logLevel=e:this.logLevel=a.LogLevel.ERROR},e.prototype.getTime=function(){return(new Date).toISOString()},e.prototype.shouldLog=function(e){return e>=this.logLevel},e.prototype.getLogLevelName=function(e){switch(e){case a.LogLevel.DEBUG:return"DEBUG";case a.LogLevel.INFO:return"INFO ";case a.LogLevel.WARNING:return"WARN ";case a.LogLevel.ERROR:return"ERROR";default:return"NOTSET"}},e.prototype.consoleLog=function(e,t){switch(e){case a.LogLevel.DEBUG:console.log.apply(console,t);break;case a.LogLevel.INFO:console.info.apply(console,t);break;case a.LogLevel.WARNING:console.warn.apply(console,t);break;case a.LogLevel.ERROR:console.error.apply(console,t);break;default:console.log.apply(console,t)}},e}();t.ConsoleLogHandler=c;var d=a.LogLevel.NOTSET,p=null,f=function(){function e(e){void 0===e&&(e={}),this.messagePrefix="",e.messagePrefix&&(this.messagePrefix=e.messagePrefix)}return e.prototype.log=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];this.internalLog(u(e),{message:t,splat:r})},e.prototype.info=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.namedLog(a.LogLevel.INFO,e,t)},e.prototype.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.namedLog(a.LogLevel.DEBUG,e,t)},e.prototype.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.namedLog(a.LogLevel.WARNING,e,t)},e.prototype.error=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.namedLog(a.LogLevel.ERROR,e,t)},e.prototype.format=function(e){return(this.messagePrefix?this.messagePrefix+": ":"")+o.sprintf.apply(void 0,n([e.message],e.splat))},e.prototype.internalLog=function(e,t){p&&(e<d||(p.log(e,this.format(t)),t.error&&t.error instanceof Error&&i.getErrorHandler().handleError(t.error)))},e.prototype.namedLog=function(e,t,r){var n;if(t instanceof Error)return t=(n=t).message,void this.internalLog(e,{error:n,message:t,splat:r});if(0!==r.length){var i=r[r.length-1];i instanceof Error&&(n=i,r.splice(-1)),this.internalLog(e,{message:t,error:n,splat:r})}else this.internalLog(e,{message:t,splat:r})},e}(),h=new l;t.getLogger=function(e){return h.getLogger(e)},t.setLogHandler=function(e){p=e},t.setLogLevel=function(e){e=u(e),d=o.isValidEnum(a.LogLevel,e)&&void 0!==e?e:a.LogLevel.ERROR},t.getLogLevel=function(){return d},t.resetLogger=function(){h=new l,d=a.LogLevel.NOTSET}},bn5K:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"h",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"g",(function(){return u})),r.d(t,"f",(function(){return l})),r.d(t,"e",(function(){return c}));const n="businessAttributes",i="segmentationStep",o="interestsStep",a="loadingStep";let s;!function(e){e.business="Business",e.consumer="Consumer",e.hybrid="Hybrid"}(s||(s={}));const u="onboarding",l="onboardingQuizCompleted",c="onboardingQuizCompletedAnonymous"},czZh:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendEventNotification=t.getQueue=t.validateAndGetBatchSize=t.validateAndGetFlushInterval=t.DEFAULT_BATCH_SIZE=t.DEFAULT_FLUSH_INTERVAL=void 0;var n=r("rWnC"),i=r("NR54"),o=r("VPC1");t.DEFAULT_FLUSH_INTERVAL=3e4,t.DEFAULT_BATCH_SIZE=10;var a=i.getLogger("EventProcessor");t.validateAndGetFlushInterval=function(e){return e<=0&&(a.warn("Invalid flushInterval "+e+", defaulting to "+t.DEFAULT_FLUSH_INTERVAL),e=t.DEFAULT_FLUSH_INTERVAL),e},t.validateAndGetBatchSize=function(e){return(e=Math.floor(e))<1&&(a.warn("Invalid batchSize "+e+", defaulting to "+t.DEFAULT_BATCH_SIZE),e=t.DEFAULT_BATCH_SIZE),e=Math.max(1,e)},t.getQueue=function(e,t,r,i){return e>1?new n.DefaultEventQueue({flushInterval:t,maxQueueSize:e,sink:r,batchComparator:i}):new n.SingleEventQueue({sink:r})},t.sendEventNotification=function(e,t){e&&e.sendNotifications(o.NOTIFICATION_TYPES.LOG_EVENT,t)}},dGqc:function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty,i=r("RzLp"),o={};var a=e.exports={length:0,getItem:function(e){return n.call(o,e)?o[e]:null},setItem:function(e,t){o[e]=t,window.name=i.stringify(o,"§"),a.length++},removeItem:function(e){delete o[e],window.name=i.stringify(o,"§"),a.length--},clear:function(){o={},window.name="",a.length=0},supported:"object"==typeof window&&"string"==typeof window.name};!function(){if(a.supported){var e,t=window.name,r=0;for(e in o="§"===t.charAt(0)?i.parse(t.slice(1)):{})n.call(o,e)&&r++;a.length=r}}()},dUcA:function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStoragePendingEventsDispatcher=t.PendingEventsDispatcher=void 0;var o=r("NR54"),a=r("ZlFy"),s=r("VPC1"),u=o.getLogger("EventProcessor"),l=function(){function e(e){var t=e.eventDispatcher,r=e.store;this.dispatcher=t,this.store=r}return e.prototype.dispatchEvent=function(e,t){this.send({uuid:s.generateUUID(),timestamp:s.getTimestamp(),request:e},t)},e.prototype.sendPendingEvents=function(){var e=this,t=this.store.values();u.debug("Sending %s pending events from previous page",t.length),t.forEach((function(t){try{e.send(t,(function(){}))}catch(r){}}))},e.prototype.send=function(e,t){var r=this;this.store.set(e.uuid,e),this.dispatcher.dispatchEvent(e.request,(function(n){r.store.remove(e.uuid),t(n)}))},e}();t.PendingEventsDispatcher=l;var c=function(e){function t(t){var r=t.eventDispatcher;return e.call(this,{eventDispatcher:r,store:new a.LocalStorageStore({maxValues:100,key:"fs_optly_pending_events"})})||this}return i(t,e),t}(l);t.LocalStoragePendingEventsDispatcher=c},dqcc:function(e,t,r){const{getCurrentCulture:n}=r("wtQp");e.exports={getAttribute:function(){return n()}}},f650:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_UPDATE_INTERVAL=3e5,t.MIN_UPDATE_INTERVAL=1e3,t.DEFAULT_URL_TEMPLATE="https://cdn.optimizely.com/datafiles/%s.json",t.DEFAULT_AUTHENTICATED_URL_TEMPLATE="https://config.optimizely.com/datafiles/auth/%s.json",t.BACKOFF_BASE_WAIT_SECONDS_BY_ERROR_COUNT=[0,8,16,32,64,128,256,512],t.REQUEST_TIMEOUT_MS=6e4},gfhf:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("f650"),i=r("NR54").getLogger("DatafileManager");t.makeGetRequest=function(e,t){var r=new XMLHttpRequest;return{responsePromise:new Promise((function(o,a){r.open("GET",e,!0),function(e,t){Object.keys(e).forEach((function(r){var n=e[r];t.setRequestHeader(r,n)}))}(t,r),r.onreadystatechange=function(){if(4===r.readyState){if(0===r.status)return void a(new Error("Request error"));var e=function(e){var t=e.getAllResponseHeaders();if(null===t)return{};var r=t.split("\r\n"),n={};return r.forEach((function(e){var t=e.indexOf(": ");if(t>-1){var r=e.slice(0,t),i=e.slice(t+2);i.length>0&&(n[r]=i)}})),n}(r),t={statusCode:r.status,body:r.responseText,headers:e};o(t)}},r.timeout=n.REQUEST_TIMEOUT_MS,r.ontimeout=function(){i.error("Request timed out")},r.send()})),abort:function(){r.abort()}}}},jh0Y:function(e,t,r){const n=r("5YMW"),i=r("4USb"),o=r("9X7T"),a=new(r("xCxT"))(n.set,n.get,i.v4,o.getRootCookieDomain);e.exports={ensureUserTestId:()=>a.ensureUserTestId()}},kAe7:function(e,t){const r=e=>e&&Array.isArray(e)?e.join(",").toLowerCase():"";e.exports={decisionsCookieName:"sci-de",convertDecisions:r,writeDecisions:(e,t)=>{t("sci-de",r(e))}}},kK04:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},lN1A:function(e,t,r){},mcjk:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NOTSET=0]="NOTSET",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR"}(t.LogLevel||(t.LogLevel={}))},ohnt:function(e,t,r){!function(){function t(e,t){var r,n,i,o,a,s,u,l;for(r=3&e.length,n=e.length-r,i=t,a=3432918353,s=461845907,l=0;l<n;)u=255&e.charCodeAt(l)|(255&e.charCodeAt(++l))<<8|(255&e.charCodeAt(++l))<<16|(255&e.charCodeAt(++l))<<24,++l,i=27492+(65535&(o=5*(65535&(i=(i^=u=(65535&(u=(u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(u=0,r){case 3:u^=(255&e.charCodeAt(l+2))<<16;case 2:u^=(255&e.charCodeAt(l+1))<<8;case 1:i^=u=(65535&(u=(u=(65535&(u^=255&e.charCodeAt(l)))*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}var r=t;r.v2=function(e,t){for(var r,n=e.length,i=t^n,o=0;n>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++o;switch(n){case 3:i^=(255&e.charCodeAt(o+2))<<16;case 2:i^=(255&e.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0},r.v3=t,e.exports=r}()},p46w:function(e,t,r){var n,i;!function(o){if(void 0===(i="function"==typeof(n=o)?n.call(t,r,t,e):n)||(e.exports=i),!0,e.exports=o(),!!0){var a=window.Cookies,s=window.Cookies=o();s.noConflict=function(){return window.Cookies=a,s}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function r(n){function i(){}function o(t,r,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},i.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(r);/^[\{\[]/.test(a)&&(r=a)}catch(l){}r=n.write?n.write(r,t):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var u in o)o[u]&&(s+="; "+u,!0!==o[u]&&(s+="="+o[u].split(";")[0]));return document.cookie=t+"="+r+s}}function a(e,r){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),u=s.slice(1).join("=");r||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var l=t(s[0]);if(u=(n.read||n)(u,l)||t(u),r)try{u=JSON.parse(u)}catch(c){}if(i[l]=u,e===l)break}catch(c){}}return e?i[e]:i}}return i.set=o,i.get=function(e){return a(e,!1)},i.getJSON=function(e){return a(e,!0)},i.remove=function(t,r){o(t,"",e(r,{expires:-1}))},i.defaults={},i.withConverter=r,i}((function(){}))}))},pPUP:function(e,t,r){"use strict";var n,i=(n=function(e,t,r,n,i,o,a){return s=fetch("https://prod.puc.starbug.vpsvc.com/v1/get_context/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({ctc_sdk_keys:r,experimentation_sdk_keys:n,attributes:t,test_user_id:i,force_update:o,merge_canonical_id:a}),method:"post"}),u=function(e){if(e.ok)return e.json();throw Error("Getting getContext failed ".concat(e.status))},l?u?u(s):s:(s&&s.then||(s=Promise.resolve(s)),u?s.then(u):s);var s,u,l},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(r){return Promise.reject(r)}});e.exports.getPucContext=i},pkII:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r("NR54"),a=r("VPC1"),s=i(r("X/4o")),u=r("f650"),l=i(r("DgEJ")),c=o.getLogger("DatafileManager");function d(e){return e>=200&&e<400}var p={get:function(){return Promise.resolve("")},set:function(){return Promise.resolve()},contains:function(){return Promise.resolve(!1)},remove:function(){return Promise.resolve()}},f=function(){function e(e){var t=this,r=n(n({},this.getConfigDefaults()),e),i=r.datafile,o=r.autoUpdate,d=void 0!==o&&o,f=r.sdkKey,h=r.updateInterval,g=void 0===h?u.DEFAULT_UPDATE_INTERVAL:h,v=r.urlTemplate,m=void 0===v?u.DEFAULT_URL_TEMPLATE:v,E=r.cache,y=void 0===E?p:E;this.cache=y,this.cacheKey="opt-datafile-"+f,this.isReadyPromiseSettled=!1,this.readyPromiseResolver=function(){},this.readyPromiseRejecter=function(){},this.readyPromise=new Promise((function(e,r){t.readyPromiseResolver=e,t.readyPromiseRejecter=r})),i?(this.currentDatafile=i,f||this.resolveReadyPromise()):this.currentDatafile="",this.isStarted=!1,this.datafileUrl=a.sprintf(m,f),this.emitter=new s.default,this.autoUpdate=d,!function(e){return e>=u.MIN_UPDATE_INTERVAL}(g)?(c.warn("Invalid updateInterval %s, defaulting to %s",g,u.DEFAULT_UPDATE_INTERVAL),this.updateInterval=u.DEFAULT_UPDATE_INTERVAL):this.updateInterval=g,this.currentTimeout=null,this.currentRequest=null,this.backoffController=new l.default,this.syncOnCurrentRequestComplete=!1}return e.prototype.get=function(){return this.currentDatafile},e.prototype.start=function(){this.isStarted||(c.debug("Datafile manager started"),this.isStarted=!0,this.backoffController.reset(),this.setDatafileFromCacheIfAvailable(),this.syncDatafile())},e.prototype.stop=function(){return c.debug("Datafile manager stopped"),this.isStarted=!1,this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),this.emitter.removeAllListeners(),this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null),Promise.resolve()},e.prototype.onReady=function(){return this.readyPromise},e.prototype.on=function(e,t){return this.emitter.on(e,t)},e.prototype.onRequestRejected=function(e){this.isStarted&&(this.backoffController.countError(),e instanceof Error?c.error("Error fetching datafile: %s",e.message,e):"string"==typeof e?c.error("Error fetching datafile: %s",e):c.error("Error fetching datafile"))},e.prototype.onRequestResolved=function(e){if(this.isStarted){void 0!==e.statusCode&&d(e.statusCode)?this.backoffController.reset():this.backoffController.countError(),this.trySavingLastModified(e.headers);var t=this.getNextDatafileFromResponse(e);if(""!==t)if(c.info("Updating datafile from response"),this.currentDatafile=t,this.cache.set(this.cacheKey,t),this.isReadyPromiseSettled){var r={datafile:t};this.emitter.emit("update",r)}else this.resolveReadyPromise()}},e.prototype.onRequestComplete=function(){this.isStarted&&(this.currentRequest=null,this.isReadyPromiseSettled||this.autoUpdate||this.rejectReadyPromise(new Error("Failed to become ready")),this.autoUpdate&&this.syncOnCurrentRequestComplete&&this.syncDatafile(),this.syncOnCurrentRequestComplete=!1)},e.prototype.syncDatafile=function(){var e=this,t={};this.lastResponseLastModified&&(t["if-modified-since"]=this.lastResponseLastModified),c.debug("Making datafile request to url %s with headers: %s",this.datafileUrl,(function(){return JSON.stringify(t)})),this.currentRequest=this.makeGetRequest(this.datafileUrl,t);var r=function(){e.onRequestComplete()};this.currentRequest.responsePromise.then((function(t){e.onRequestResolved(t)}),(function(t){e.onRequestRejected(t)})).then(r,r),this.autoUpdate&&this.scheduleNextUpdate()},e.prototype.resolveReadyPromise=function(){this.readyPromiseResolver(),this.isReadyPromiseSettled=!0},e.prototype.rejectReadyPromise=function(e){this.readyPromiseRejecter(e),this.isReadyPromiseSettled=!0},e.prototype.scheduleNextUpdate=function(){var e=this,t=this.backoffController.getDelay(),r=Math.max(t,this.updateInterval);c.debug("Scheduling sync in %s ms",r),this.currentTimeout=setTimeout((function(){e.currentRequest?e.syncOnCurrentRequestComplete=!0:e.syncDatafile()}),r)},e.prototype.getNextDatafileFromResponse=function(e){return c.debug("Response status code: %s",e.statusCode),void 0===e.statusCode||304===e.statusCode?"":d(e.statusCode)?e.body:""},e.prototype.trySavingLastModified=function(e){var t=e["last-modified"]||e["Last-Modified"];void 0!==t&&(this.lastResponseLastModified=t,c.debug("Saved last modified header value from response: %s",this.lastResponseLastModified))},e.prototype.setDatafileFromCacheIfAvailable=function(){var e=this;this.cache.get(this.cacheKey).then((function(t){e.isStarted&&!e.isReadyPromiseSettled&&""!==t&&(c.debug("Using datafile from cache"),e.currentDatafile=t,e.resolveReadyPromise())}))},e}();t.default=f},rWnC:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultEventQueue=t.SingleEventQueue=void 0;var n=r("NR54").getLogger("EventProcessor"),i=function(){function e(e){var t=e.timeout,r=e.callback;this.timeout=Math.max(t,0),this.callback=r}return e.prototype.start=function(){this.timeoutId=setTimeout(this.callback,this.timeout)},e.prototype.refresh=function(){this.stop(),this.start()},e.prototype.stop=function(){this.timeoutId&&clearTimeout(this.timeoutId)},e}(),o=function(){function e(e){var t=e.sink;this.sink=t}return e.prototype.start=function(){},e.prototype.stop=function(){return Promise.resolve()},e.prototype.enqueue=function(e){this.sink([e])},e}();t.SingleEventQueue=o;var a=function(){function e(e){var t=e.flushInterval,r=e.maxQueueSize,n=e.sink,o=e.batchComparator;this.buffer=[],this.maxQueueSize=Math.max(r,1),this.sink=n,this.batchComparator=o,this.timer=new i({callback:this.flush.bind(this),timeout:t}),this.started=!1}return e.prototype.start=function(){this.started=!0},e.prototype.stop=function(){this.started=!1;var e=this.sink(this.buffer);return this.buffer=[],this.timer.stop(),e},e.prototype.enqueue=function(e){if(this.started){var t=this.buffer[0];t&&!this.batchComparator(t,e)&&this.flush(),0===this.buffer.length&&this.timer.refresh(),this.buffer.push(e),this.buffer.length>=this.maxQueueSize&&this.flush()}else n.warn("Queue is stopped, not accepting event")},e.prototype.flush=function(){this.sink(this.buffer),this.buffer=[],this.timer.stop()},e}();t.DefaultEventQueue=a},rb8V:function(e,t,r){"use strict";var n=r("B3dL"),i=n.setCookie,o=n.deleteCookie,a=r("ANje");e.exports.setUserProfile=function(e){var t=function(e){if(!e||!e.userProfile||0===Object.keys(e.userProfile).length)return;return Object.keys(e.userProfile).map((function(t){return"".concat(t,":").concat(e.userProfile[t])})).join(",")}(e);if(t)i("puc-up",t);else{var r=a.getRootCookieDomain();o("puc-up",{domain:r})}}},syoB:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r("2dzi"),t),i(r("czZh"),t),i(r("kK04"),t),i(r("2W80"),t),i(r("dUcA"),t),i(r("VGhT"),t),i(r("WmZe"),t)},uHXf:function(e,t,r){"use strict";var n,i=Object.prototype.hasOwnProperty,o=r("+Aml"),a=r("v2qT"),s={};function u(){if(l.supported){var e,t=n.getItem("koekje"),r=0;for(e in s=t&&"§"===t.charAt(0)?a.parse(t.slice(1)):{})i.call(s,e)&&r++;l.length=r}}n=o("undefined"!=typeof document?document:{});var l=e.exports={length:0,getItem:function(e){return i.call(s,e)?s[e]:null},setItem:function(e,t){s[e]=t,n.setItem("koekje",a.stringify(s,"§")),l.length++},removeItem:function(e){delete s[e],n.setItem("koekje",a.stringify(s,"§")),l.length--},clear:function(){s={},n.setItem("koekje","",{expires:new Date(0)}),l.length=0},supported:"object"==typeof navigator&&navigator.cookieEnabled,update:u};u()},uZ6B:function(e,t,r){"use strict";var n=r("B3dL").setCookie,i=r("2qub").inCloudFlareSupportedTenantCountry,o=r("1C4m").publish,a=r("KpVU").writeExperiments;e.exports.EXPERIMENTS_SDK_KEY="TL6bJ6aeorhsvy5X8LGMVX",e.exports.setExperiments=function(e){var t=function(e){if(e&&e.experiments&&e.experiments.TL6bJ6aeorhsvy5X8LGMVX){var t=e.experiments.TL6bJ6aeorhsvy5X8LGMVX;return Object.keys(t).filter((function(e){return null!==t[e]})).map((function(e){return{experimentKey:e,variationKey:t[e]}}))}}(e);if(t){var r=function(e){return e.map((function(e){return"".concat(e.experimentKey,":").concat(e.variationKey)})).join(",")}(t);n("puc-ab",r),i()||a(t,n),o("variationsResolved",t)}}},v2qT:function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty;function i(e){return decodeURIComponent(e.replace(/\+/g," "))}t.stringify=function(e,t){t=t||"";var r=[];for(var i in"string"!=typeof t&&(t="?"),e)n.call(e,i)&&r.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return r.length?t+r.join("&"):""},t.parse=function(e){for(var t,r=/([^=?&]+)=?([^&]*)/g,n={};t=r.exec(e);n[i(t[1])]=i(t[2]));return n}},vJXh:function(e,t,r){e.exports=function(){"use strict";try{if(sessionStorage.setItem("foo","bar"),"bar"!==sessionStorage.getItem("foo"))throw 1;sessionStorage.removeItem("foo")}catch(i){var e=r("UIIZ"),t=r("dGqc"),n=r("uHXf");return t.supported?t:n.supported?n:e}return sessionStorage}()},w7uu:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("AGgz");function i({locale:e,contentId:t}){return(o({locale:e})||{})[t]}function o({locale:e}){return(null==n?void 0:n[e])||{}}},wMS7:function(e,t,r){e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,r){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,r)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function n(e,i,o){return(n=r()?Reflect.construct:function(e,r,n){var i=[null];i.push.apply(i,r);var o=new(Function.bind.apply(e,i));return n&&t(o,n.prototype),o}).apply(null,arguments)}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a=Object.hasOwnProperty,s=Object.setPrototypeOf,u=Object.isFrozen,l=Object.getPrototypeOf,c=Object.getOwnPropertyDescriptor,d=Object.freeze,p=Object.seal,f=Object.create,h="undefined"!=typeof Reflect&&Reflect,g=h.apply,v=h.construct;g||(g=function(e,t,r){return e.apply(t,r)}),d||(d=function(e){return e}),p||(p=function(e){return e}),v||(v=function(e,t){return n(e,i(t))});var m,E=A(Array.prototype.forEach),y=A(Array.prototype.pop),b=A(Array.prototype.push),I=A(String.prototype.toLowerCase),_=A(String.prototype.match),O=A(String.prototype.replace),w=A(String.prototype.indexOf),T=A(String.prototype.trim),N=A(RegExp.prototype.test),R=(m=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return v(m,t)});function A(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return g(e,t,n)}}function S(e,t){s&&s(e,null);for(var r=t.length;r--;){var n=t[r];if("string"==typeof n){var i=I(n);i!==n&&(u(t)||(t[r]=i),n=i)}e[n]=!0}return e}function C(e){var t,r=f(null);for(t in e)g(a,e,[t])&&(r[t]=e[t]);return r}function D(e,t){for(;null!==e;){var r=c(e,t);if(r){if(r.get)return A(r.get);if("function"==typeof r.value)return A(r.value)}e=l(e)}return function(e){return console.warn("fallback value for",e),null}}var L=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),U=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),P=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),x=d(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),k=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),F=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),M=d(["#text"]),j=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),V=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),B=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),G=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),K=p(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=p(/<%[\w\W]*|[\w\W]*%>/gm),H=p(/^data-[\-\w.\u00B7-\uFFFF]/),q=p(/^aria-[\-\w]+$/),Y=p(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),W=p(/^(?:\w+script|data):/i),X=p(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),J=p(/^html$/i),Z=function(){return"undefined"==typeof window?null:window},Q=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var n=null;r.currentScript&&r.currentScript.hasAttribute("data-tt-policy-suffix")&&(n=r.currentScript.getAttribute("data-tt-policy-suffix"));var i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:function(e){return e}})}catch(o){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z(),n=function(e){return t(e)};if(n.version="2.3.8",n.removed=[],!r||!r.document||9!==r.document.nodeType)return n.isSupported=!1,n;var o=r.document,a=r.document,s=r.DocumentFragment,u=r.HTMLTemplateElement,l=r.Node,c=r.Element,p=r.NodeFilter,f=r.NamedNodeMap,h=void 0===f?r.NamedNodeMap||r.MozNamedAttrMap:f,g=r.HTMLFormElement,v=r.DOMParser,m=r.trustedTypes,A=c.prototype,$=D(A,"cloneNode"),ee=D(A,"nextSibling"),te=D(A,"childNodes"),re=D(A,"parentNode");if("function"==typeof u){var ne=a.createElement("template");ne.content&&ne.content.ownerDocument&&(a=ne.content.ownerDocument)}var ie=Q(m,o),oe=ie?ie.createHTML(""):"",ae=a,se=ae.implementation,ue=ae.createNodeIterator,le=ae.createDocumentFragment,ce=ae.getElementsByTagName,de=o.importNode,pe={};try{pe=C(a).documentMode?a.documentMode:{}}catch(Tt){}var fe={};n.isSupported="function"==typeof re&&se&&void 0!==se.createHTMLDocument&&9!==pe;var he,ge,ve=K,me=z,Ee=H,ye=q,be=W,Ie=X,_e=Y,Oe=null,we=S({},[].concat(i(L),i(U),i(P),i(k),i(M))),Te=null,Ne=S({},[].concat(i(j),i(V),i(B),i(G))),Re=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ae=null,Se=null,Ce=!0,De=!0,Le=!1,Ue=!1,Pe=!1,xe=!1,ke=!1,Fe=!1,Me=!1,je=!1,Ve=!0,Be=!0,Ge=!1,Ke={},ze=null,He=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),qe=null,Ye=S({},["audio","video","img","source","image","track"]),We=null,Xe=S({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Je="http://www.w3.org/1998/Math/MathML",Ze="http://www.w3.org/2000/svg",Qe="http://www.w3.org/1999/xhtml",$e=Qe,et=!1,tt=["application/xhtml+xml","text/html"],rt="text/html",nt=null,it=a.createElement("form"),ot=function(e){return e instanceof RegExp||e instanceof Function},at=function(t){nt&&nt===t||(t&&"object"===e(t)||(t={}),t=C(t),Oe="ALLOWED_TAGS"in t?S({},t.ALLOWED_TAGS):we,Te="ALLOWED_ATTR"in t?S({},t.ALLOWED_ATTR):Ne,We="ADD_URI_SAFE_ATTR"in t?S(C(Xe),t.ADD_URI_SAFE_ATTR):Xe,qe="ADD_DATA_URI_TAGS"in t?S(C(Ye),t.ADD_DATA_URI_TAGS):Ye,ze="FORBID_CONTENTS"in t?S({},t.FORBID_CONTENTS):He,Ae="FORBID_TAGS"in t?S({},t.FORBID_TAGS):{},Se="FORBID_ATTR"in t?S({},t.FORBID_ATTR):{},Ke="USE_PROFILES"in t&&t.USE_PROFILES,Ce=!1!==t.ALLOW_ARIA_ATTR,De=!1!==t.ALLOW_DATA_ATTR,Le=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Ue=t.SAFE_FOR_TEMPLATES||!1,Pe=t.WHOLE_DOCUMENT||!1,Fe=t.RETURN_DOM||!1,Me=t.RETURN_DOM_FRAGMENT||!1,je=t.RETURN_TRUSTED_TYPE||!1,ke=t.FORCE_BODY||!1,Ve=!1!==t.SANITIZE_DOM,Be=!1!==t.KEEP_CONTENT,Ge=t.IN_PLACE||!1,_e=t.ALLOWED_URI_REGEXP||_e,$e=t.NAMESPACE||Qe,t.CUSTOM_ELEMENT_HANDLING&&ot(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Re.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ot(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Re.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Re.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),he=he=-1===tt.indexOf(t.PARSER_MEDIA_TYPE)?rt:t.PARSER_MEDIA_TYPE,ge="application/xhtml+xml"===he?function(e){return e}:I,Ue&&(De=!1),Me&&(Fe=!0),Ke&&(Oe=S({},i(M)),Te=[],!0===Ke.html&&(S(Oe,L),S(Te,j)),!0===Ke.svg&&(S(Oe,U),S(Te,V),S(Te,G)),!0===Ke.svgFilters&&(S(Oe,P),S(Te,V),S(Te,G)),!0===Ke.mathMl&&(S(Oe,k),S(Te,B),S(Te,G))),t.ADD_TAGS&&(Oe===we&&(Oe=C(Oe)),S(Oe,t.ADD_TAGS)),t.ADD_ATTR&&(Te===Ne&&(Te=C(Te)),S(Te,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&S(We,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(ze===He&&(ze=C(ze)),S(ze,t.FORBID_CONTENTS)),Be&&(Oe["#text"]=!0),Pe&&S(Oe,["html","head","body"]),Oe.table&&(S(Oe,["tbody"]),delete Ae.tbody),d&&d(t),nt=t)},st=S({},["mi","mo","mn","ms","mtext"]),ut=S({},["foreignobject","desc","title","annotation-xml"]),lt=S({},["title","style","font","a","script"]),ct=S({},U);S(ct,P),S(ct,x);var dt=S({},k);S(dt,F);var pt=function(e){var t=re(e);t&&t.tagName||(t={namespaceURI:Qe,tagName:"template"});var r=I(e.tagName),n=I(t.tagName);return e.namespaceURI===Ze?t.namespaceURI===Qe?"svg"===r:t.namespaceURI===Je?"svg"===r&&("annotation-xml"===n||st[n]):Boolean(ct[r]):e.namespaceURI===Je?t.namespaceURI===Qe?"math"===r:t.namespaceURI===Ze?"math"===r&&ut[n]:Boolean(dt[r]):e.namespaceURI===Qe&&!(t.namespaceURI===Ze&&!ut[n])&&!(t.namespaceURI===Je&&!st[n])&&!dt[r]&&(lt[r]||!ct[r])},ft=function(e){b(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(Tt){try{e.outerHTML=oe}catch(Tt){e.remove()}}},ht=function(e,t){try{b(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(Tt){b(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Te[e])if(Fe||Me)try{ft(t)}catch(Tt){}else try{t.setAttribute(e,"")}catch(Tt){}},gt=function(e){var t,r;if(ke)e="<remove></remove>"+e;else{var n=_(e,/^[\r\n\t ]+/);r=n&&n[0]}"application/xhtml+xml"===he&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=ie?ie.createHTML(e):e;if($e===Qe)try{t=(new v).parseFromString(i,he)}catch(Tt){}if(!t||!t.documentElement){t=se.createDocument($e,"template",null);try{t.documentElement.innerHTML=et?"":i}catch(Tt){}}var o=t.body||t.documentElement;return e&&r&&o.insertBefore(a.createTextNode(r),o.childNodes[0]||null),$e===Qe?ce.call(t,Pe?"html":"body")[0]:Pe?t.documentElement:o},vt=function(e){return ue.call(e.ownerDocument||e,e,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT,null,!1)},mt=function(e){return e instanceof g&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof h)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},Et=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},yt=function(e,t,r){fe[e]&&E(fe[e],(function(e){e.call(n,t,r,nt)}))},bt=function(e){var t;if(yt("beforeSanitizeElements",e,null),mt(e))return ft(e),!0;if(N(/[\u0080-\uFFFF]/,e.nodeName))return ft(e),!0;var r=ge(e.nodeName);if(yt("uponSanitizeElement",e,{tagName:r,allowedTags:Oe}),e.hasChildNodes()&&!Et(e.firstElementChild)&&(!Et(e.content)||!Et(e.content.firstElementChild))&&N(/<[/\w]/g,e.innerHTML)&&N(/<[/\w]/g,e.textContent))return ft(e),!0;if("select"===r&&N(/<template/i,e.innerHTML))return ft(e),!0;if(!Oe[r]||Ae[r]){if(!Ae[r]&&_t(r)){if(Re.tagNameCheck instanceof RegExp&&N(Re.tagNameCheck,r))return!1;if(Re.tagNameCheck instanceof Function&&Re.tagNameCheck(r))return!1}if(Be&&!ze[r]){var i=re(e)||e.parentNode,o=te(e)||e.childNodes;if(o&&i)for(var a=o.length-1;a>=0;--a)i.insertBefore($(o[a],!0),ee(e))}return ft(e),!0}return e instanceof c&&!pt(e)?(ft(e),!0):"noscript"!==r&&"noembed"!==r||!N(/<\/no(script|embed)/i,e.innerHTML)?(Ue&&3===e.nodeType&&(t=e.textContent,t=O(t,ve," "),t=O(t,me," "),e.textContent!==t&&(b(n.removed,{element:e.cloneNode()}),e.textContent=t)),yt("afterSanitizeElements",e,null),!1):(ft(e),!0)},It=function(e,t,r){if(Ve&&("id"===t||"name"===t)&&(r in a||r in it))return!1;if(De&&!Se[t]&&N(Ee,t));else if(Ce&&N(ye,t));else if(!Te[t]||Se[t]){if(!(_t(e)&&(Re.tagNameCheck instanceof RegExp&&N(Re.tagNameCheck,e)||Re.tagNameCheck instanceof Function&&Re.tagNameCheck(e))&&(Re.attributeNameCheck instanceof RegExp&&N(Re.attributeNameCheck,t)||Re.attributeNameCheck instanceof Function&&Re.attributeNameCheck(t))||"is"===t&&Re.allowCustomizedBuiltInElements&&(Re.tagNameCheck instanceof RegExp&&N(Re.tagNameCheck,r)||Re.tagNameCheck instanceof Function&&Re.tagNameCheck(r))))return!1}else if(We[t]);else if(N(_e,O(r,Ie,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==w(r,"data:")||!qe[e])if(Le&&!N(be,O(r,Ie,"")));else if(r)return!1;return!0},_t=function(e){return e.indexOf("-")>0},Ot=function(e){var t,r,i,o;yt("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Te};for(o=a.length;o--;){var u=t=a[o],l=u.name,c=u.namespaceURI;if(r="value"===l?t.value:T(t.value),i=ge(l),s.attrName=i,s.attrValue=r,s.keepAttr=!0,s.forceKeepAttr=void 0,yt("uponSanitizeAttribute",e,s),r=s.attrValue,!s.forceKeepAttr&&(ht(l,e),s.keepAttr))if(N(/\/>/i,r))ht(l,e);else{Ue&&(r=O(r,ve," "),r=O(r,me," "));var d=ge(e.nodeName);if(It(d,i,r))try{c?e.setAttributeNS(c,l,r):e.setAttribute(l,r),y(n.removed)}catch(Tt){}}}yt("afterSanitizeAttributes",e,null)}},wt=function e(t){var r,n=vt(t);for(yt("beforeSanitizeShadowDOM",t,null);r=n.nextNode();)yt("uponSanitizeShadowNode",r,null),bt(r)||(r.content instanceof s&&e(r.content),Ot(r));yt("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(t,i){var a,u,c,d,p;if((et=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Et(t)){if("function"!=typeof t.toString)throw R("toString is not a function");if("string"!=typeof(t=t.toString()))throw R("dirty is not a string, aborting")}if(!n.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(Et(t))return r.toStaticHTML(t.outerHTML)}return t}if(xe||at(i),n.removed=[],"string"==typeof t&&(Ge=!1),Ge){if(t.nodeName){var f=ge(t.nodeName);if(!Oe[f]||Ae[f])throw R("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(u=(a=gt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===u.nodeName||"HTML"===u.nodeName?a=u:a.appendChild(u);else{if(!Fe&&!Ue&&!Pe&&-1===t.indexOf("<"))return ie&&je?ie.createHTML(t):t;if(!(a=gt(t)))return Fe?null:je?oe:""}a&&ke&&ft(a.firstChild);for(var h=vt(Ge?t:a);c=h.nextNode();)3===c.nodeType&&c===d||bt(c)||(c.content instanceof s&&wt(c.content),Ot(c),d=c);if(d=null,Ge)return t;if(Fe){if(Me)for(p=le.call(a.ownerDocument);a.firstChild;)p.appendChild(a.firstChild);else p=a;return Te.shadowroot&&(p=de.call(o,p,!0)),p}var g=Pe?a.outerHTML:a.innerHTML;return Pe&&Oe["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&N(J,a.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+g),Ue&&(g=O(g,ve," "),g=O(g,me," ")),ie&&je?ie.createHTML(g):g},n.setConfig=function(e){at(e),xe=!0},n.clearConfig=function(){nt=null,xe=!1},n.isValidAttribute=function(e,t,r){nt||at({});var n=ge(e),i=ge(t);return It(n,i,r)},n.addHook=function(e,t){"function"==typeof t&&(fe[e]=fe[e]||[],b(fe[e],t))},n.removeHook=function(e){if(fe[e])return y(fe[e])},n.removeHooks=function(e){fe[e]&&(fe[e]=[])},n.removeAllHooks=function(){fe={}},n}()}()},wXqe:function(e,t,r){"use strict";var n,i=(n=function(){return(new o).getAttributeValues()},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(r){return Promise.reject(r)}});var o=r("9IYi");t.resolveTraits=i},wtQp:function(e,t,r){"use strict";r.r(t),r.d(t,"getCurrentCulture",(function(){return a})),r.d(t,"getCurrentCountry",(function(){return s}));var n=function(){var e=("undefined"!=typeof window?window.location:void 0)&&window.location.hostname;if(!e||0===e.length)throw new Error("Hostname could not be determined for the current document.");return e},i=function(){var e=("undefined"!=typeof window?window.location:void 0)&&window.location.pathname;return e||"/"},o=function(e,t){switch(("localhost"===e?"IE":"vista.com"===e?"/"===t?"us":t.substr(1,2):function(e){if(!e||0===e.length)throw new Error("Domain must be specified");var t=e.split(".");if(t.length<2)throw new Error("Domain '"+e+"' does hot have the right format.");return t.pop()}(e)).toLowerCase()){case"pt":return"PT";case"ie":return"IE";case"es":return"ES";case"in":return"IN";case"jp":return"JP";case"com":case"us":return"US";case"fr":return"FR";case"it":return"IT";case"uk":return"GB";case"de":return"DE";case"nl":return"NL";case"dk":return"DK";case"se":return"SE";case"at":return"AT";case"no":return"NO";case"fi":return"FI";case"be":return"BE";case"sg":return"SG";case"nz":return"NZ";case"au":return"AU";case"ca":return"CA";case"ch":return"CH"}throw new Error("Unknown country for host "+e+" and path "+t)};var a=function(){return function(e,t){var r;switch(o(e,t).toUpperCase()){case"PT":return"pt-PT";case"IE":return"en-IE";case"ES":return"es-ES";case"IN":return"en-IN";case"US":return(r=t.toLowerCase()).startsWith("/es")||r.startsWith("/us/es")?"es-US":"en-US";case"GB":return"en-GB";case"FR":return"fr-FR";case"IT":return"it-IT";case"DE":return"de-DE";case"NL":return"nl-NL";case"DK":return"da-DK";case"SE":return"sv-SE";case"AT":return"de-AT";case"NO":return"nb-NO";case"FI":return"fi-FI";case"BE":return function(e){var t=e.toLowerCase();return t.startsWith("/fr")||t.startsWith("/fr-be")?"fr-BE":"nl-BE"}(t);case"SG":return"en-SG";case"JP":return"ja-JP";case"NZ":return"en-NZ";case"AU":return"en-AU";case"CA":return function(e){var t=e.toLowerCase();return t.startsWith("/fr")||t.startsWith("/ca/fr")?"fr-CA":"en-CA"}(t);case"CH":return function(e){var t=e.toLowerCase();return t.startsWith("/fr")?"fr-CH":t.startsWith("/it")?"it-CH":"de-CH"}(t)}throw new Error("Unknown culture for host "+e+" and path "+t)}(n(),i())},s=function(){var e=n(),t=i();return o(e,t)}},xCxT:function(e,t){function r(e,t,r,n){this.setCookie=e,this.getCookie=t,this.getUuid=r,this.getRootCookieDomain=n}r.prototype.ensureUserTestId=function(){var e=this.getCookie("optimizelyEndUserId");if(e)return e;e=this.getUuid();const t={domain:this.getRootCookieDomain(),expires:180};return this.setCookie("optimizelyEndUserId",e,t),e},e.exports=r},yUlY:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return l}));var n=r("Nz9T");let i;!function(e){e.SetSelections="setSelections",e.SetBusinessSelections="setBusinessSelections",e.SetFromLocalStorage="setFromLocaleStorage"}(i||(i={}));const o={selections:void 0},a=n.createContext(void 0);function s(e,t){switch(t.type){case i.SetSelections:return Object.assign({},e,{selections:Object.assign({},e.selections,{[t.payload.contentId]:t.payload.selectedValues})});case i.SetBusinessSelections:return Object.assign({},e,{selections:Object.assign({},e.selections,{[t.payload.contentId]:{selectedIndustry:t.payload.selectedIndustry,selectedBusinessName:t.payload.selectedBusinessName,uploadedLogo:t.payload.uploadedLogo}})});case i.SetFromLocalStorage:return Object.assign({},e,{selections:t.payload.selections});default:return console.warn("Unknown action: ",t),e}}function u({children:e}){const[t,r]=n.useReducer(s,o),i={selectionsState:t,selectionsDispatch:r};return n.createElement(a.Provider,{value:i},e)}function l(){const e=n.useContext(a);if(void 0===e)throw new Error("useUserSelections must be used within a UserSelectionsProvider");return e}},yqlo:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useThrottle=void 0;var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(u){i=!0,o=u}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=r("Nz9T");t.useThrottle=function(e,t){var r=(0,i.useState)(e),o=n(r,2),a=o[0],s=o[1],u=(0,i.useRef)(Date.now());return(0,i.useEffect)((function(){var r=setTimeout((function(){Date.now()-u.current>=t&&(s(e),u.current=Date.now())}),t-(Date.now()-u.current));return function(){clearTimeout(r)}}),[e,t]),a}}}]);
//# sourceMappingURL=b0016de6a4fc50aaca2db95d88add32af2620be5-291f04bfd7a12119195a.js.map